import{C as aa,D as oa,E as ia,B as gr,k as ou,F as iu,G as cu,H as uu}from"./ToggleDarkButton.vue_vue_type_script_setup_true_lang-BdetDtwM.js";import{H as lu,G as fu,y as hu,o as du,I as pu,d as _u,c as Fs,r as Ls,J as gu,b as Vs,e as Ps}from"./index-CDDXiIMs.js";const mu=n=>t=>t.map(n),vu=n=>n.length,wu=n=>Math.min(...n),yu=n=>wu(n.map(vu)),bu=n=>(...t)=>Array.from({length:yu(t)},(r,f)=>n(...t.map(_=>_[f]))),ku=bu,ca=ku,xu=ca(oa),Mu=ca(ia),Au=n=>(t,r)=>mu(f=>n(f,r))(t),Us=Au(aa);function Eu(n,t){return class extends n{constructor(...r){super(...r),t(this)}}}const Tu=Eu(Array,n=>n.fill(0));let lt=1e-6;function zu(n){function t(e=0,d=0){const a=new n(2);return e!==void 0&&(a[0]=e,d!==void 0&&(a[1]=d)),a}const r=t;function f(e,d,a){const c=a??new n(2);return c[0]=e,c[1]=d,c}function _(e,d){const a=d??new n(2);return a[0]=Math.ceil(e[0]),a[1]=Math.ceil(e[1]),a}function x(e,d){const a=d??new n(2);return a[0]=Math.floor(e[0]),a[1]=Math.floor(e[1]),a}function q(e,d){const a=d??new n(2);return a[0]=Math.round(e[0]),a[1]=Math.round(e[1]),a}function R(e,d=0,a=1,c){const m=c??new n(2);return m[0]=Math.min(a,Math.max(d,e[0])),m[1]=Math.min(a,Math.max(d,e[1])),m}function Y(e,d,a){const c=a??new n(2);return c[0]=e[0]+d[0],c[1]=e[1]+d[1],c}function W(e,d,a,c){const m=c??new n(2);return m[0]=e[0]+d[0]*a,m[1]=e[1]+d[1]*a,m}function Q(e,d){const a=e[0],c=e[1],m=d[0],T=d[1],P=Math.sqrt(a*a+c*c),p=Math.sqrt(m*m+T*T),v=P*p,E=v&&le(e,d)/v;return Math.acos(E)}function rt(e,d,a){const c=a??new n(2);return c[0]=e[0]-d[0],c[1]=e[1]-d[1],c}const it=rt;function Mt(e,d){return Math.abs(e[0]-d[0])<lt&&Math.abs(e[1]-d[1])<lt}function Tt(e,d){return e[0]===d[0]&&e[1]===d[1]}function O(e,d,a,c){const m=c??new n(2);return m[0]=e[0]+a*(d[0]-e[0]),m[1]=e[1]+a*(d[1]-e[1]),m}function et(e,d,a,c){const m=c??new n(2);return m[0]=e[0]+a[0]*(d[0]-e[0]),m[1]=e[1]+a[1]*(d[1]-e[1]),m}function wt(e,d,a){const c=a??new n(2);return c[0]=Math.max(e[0],d[0]),c[1]=Math.max(e[1],d[1]),c}function kt(e,d,a){const c=a??new n(2);return c[0]=Math.min(e[0],d[0]),c[1]=Math.min(e[1],d[1]),c}function At(e,d,a){const c=a??new n(2);return c[0]=e[0]*d,c[1]=e[1]*d,c}const It=At;function Ut(e,d,a){const c=a??new n(2);return c[0]=e[0]/d,c[1]=e[1]/d,c}function st(e,d){const a=d??new n(2);return a[0]=1/e[0],a[1]=1/e[1],a}const Gt=st;function gt(e,d,a){const c=a??new n(3),m=e[0]*d[1]-e[1]*d[0];return c[0]=0,c[1]=0,c[2]=m,c}function le(e,d){return e[0]*d[0]+e[1]*d[1]}function Ot(e){const d=e[0],a=e[1];return Math.sqrt(d*d+a*a)}const _e=Ot;function pt(e){const d=e[0],a=e[1];return d*d+a*a}const zt=pt;function ut(e,d){const a=e[0]-d[0],c=e[1]-d[1];return Math.sqrt(a*a+c*c)}const we=ut;function ee(e,d){const a=e[0]-d[0],c=e[1]-d[1];return a*a+c*c}const ge=ee;function Xt(e,d){const a=d??new n(2),c=e[0],m=e[1],T=Math.sqrt(c*c+m*m);return T>1e-5?(a[0]=c/T,a[1]=m/T):(a[0]=0,a[1]=0),a}function ye(e,d){const a=d??new n(2);return a[0]=-e[0],a[1]=-e[1],a}function qt(e,d){const a=d??new n(2);return a[0]=e[0],a[1]=e[1],a}const be=qt;function ce(e,d,a){const c=a??new n(2);return c[0]=e[0]*d[0],c[1]=e[1]*d[1],c}const ke=ce;function Wt(e,d,a){const c=a??new n(2);return c[0]=e[0]/d[0],c[1]=e[1]/d[1],c}const me=Wt;function fe(e=1,d){const a=d??new n(2),c=Math.random()*2*Math.PI;return a[0]=Math.cos(c)*e,a[1]=Math.sin(c)*e,a}function u(e){const d=e??new n(2);return d[0]=0,d[1]=0,d}function b(e,d,a){const c=a??new n(2),m=e[0],T=e[1];return c[0]=m*d[0]+T*d[4]+d[12],c[1]=m*d[1]+T*d[5]+d[13],c}function i(e,d,a){const c=a??new n(2),m=e[0],T=e[1];return c[0]=d[0]*m+d[4]*T+d[8],c[1]=d[1]*m+d[5]*T+d[9],c}function l(e,d,a,c){const m=c??new n(2),T=e[0]-d[0],P=e[1]-d[1],p=Math.sin(a),v=Math.cos(a);return m[0]=T*v-P*p+d[0],m[1]=T*p+P*v+d[1],m}function y(e,d,a){const c=a??new n(2);return Xt(e,c),At(c,d,c)}function k(e,d,a){const c=a??new n(2);return Ot(e)>d?y(e,d,c):qt(e,c)}function V(e,d,a){const c=a??new n(2);return O(e,d,.5,c)}return{create:t,fromValues:r,set:f,ceil:_,floor:x,round:q,clamp:R,add:Y,addScaled:W,angle:Q,subtract:rt,sub:it,equalsApproximately:Mt,equals:Tt,lerp:O,lerpV:et,max:wt,min:kt,mulScalar:At,scale:It,divScalar:Ut,inverse:st,invert:Gt,cross:gt,dot:le,length:Ot,len:_e,lengthSq:pt,lenSq:zt,distance:ut,dist:we,distanceSq:ee,distSq:ge,normalize:Xt,negate:ye,copy:qt,clone:be,multiply:ce,mul:ke,divide:Wt,div:me,random:fe,zero:u,transformMat4:b,transformMat3:i,rotate:l,setLength:y,truncate:k,midpoint:V}}const Os=new Map;function ua(n){let t=Os.get(n);return t||(t=zu(n),Os.set(n,t)),t}function Su(n){function t(p,v,E){const z=new n(3);return p!==void 0&&(z[0]=p,v!==void 0&&(z[1]=v,E!==void 0&&(z[2]=E))),z}const r=t;function f(p,v,E,z){const L=z??new n(3);return L[0]=p,L[1]=v,L[2]=E,L}function _(p,v){const E=v??new n(3);return E[0]=Math.ceil(p[0]),E[1]=Math.ceil(p[1]),E[2]=Math.ceil(p[2]),E}function x(p,v){const E=v??new n(3);return E[0]=Math.floor(p[0]),E[1]=Math.floor(p[1]),E[2]=Math.floor(p[2]),E}function q(p,v){const E=v??new n(3);return E[0]=Math.round(p[0]),E[1]=Math.round(p[1]),E[2]=Math.round(p[2]),E}function R(p,v=0,E=1,z){const L=z??new n(3);return L[0]=Math.min(E,Math.max(v,p[0])),L[1]=Math.min(E,Math.max(v,p[1])),L[2]=Math.min(E,Math.max(v,p[2])),L}function Y(p,v,E){const z=E??new n(3);return z[0]=p[0]+v[0],z[1]=p[1]+v[1],z[2]=p[2]+v[2],z}function W(p,v,E,z){const L=z??new n(3);return L[0]=p[0]+v[0]*E,L[1]=p[1]+v[1]*E,L[2]=p[2]+v[2]*E,L}function Q(p,v){const E=p[0],z=p[1],L=p[2],U=v[0],B=v[1],tt=v[2],ot=Math.sqrt(E*E+z*z+L*L),C=Math.sqrt(U*U+B*B+tt*tt),nt=ot*C,ct=nt&&le(p,v)/nt;return Math.acos(ct)}function rt(p,v,E){const z=E??new n(3);return z[0]=p[0]-v[0],z[1]=p[1]-v[1],z[2]=p[2]-v[2],z}const it=rt;function Mt(p,v){return Math.abs(p[0]-v[0])<lt&&Math.abs(p[1]-v[1])<lt&&Math.abs(p[2]-v[2])<lt}function Tt(p,v){return p[0]===v[0]&&p[1]===v[1]&&p[2]===v[2]}function O(p,v,E,z){const L=z??new n(3);return L[0]=p[0]+E*(v[0]-p[0]),L[1]=p[1]+E*(v[1]-p[1]),L[2]=p[2]+E*(v[2]-p[2]),L}function et(p,v,E,z){const L=z??new n(3);return L[0]=p[0]+E[0]*(v[0]-p[0]),L[1]=p[1]+E[1]*(v[1]-p[1]),L[2]=p[2]+E[2]*(v[2]-p[2]),L}function wt(p,v,E){const z=E??new n(3);return z[0]=Math.max(p[0],v[0]),z[1]=Math.max(p[1],v[1]),z[2]=Math.max(p[2],v[2]),z}function kt(p,v,E){const z=E??new n(3);return z[0]=Math.min(p[0],v[0]),z[1]=Math.min(p[1],v[1]),z[2]=Math.min(p[2],v[2]),z}function At(p,v,E){const z=E??new n(3);return z[0]=p[0]*v,z[1]=p[1]*v,z[2]=p[2]*v,z}const It=At;function Ut(p,v,E){const z=E??new n(3);return z[0]=p[0]/v,z[1]=p[1]/v,z[2]=p[2]/v,z}function st(p,v){const E=v??new n(3);return E[0]=1/p[0],E[1]=1/p[1],E[2]=1/p[2],E}const Gt=st;function gt(p,v,E){const z=E??new n(3),L=p[2]*v[0]-p[0]*v[2],U=p[0]*v[1]-p[1]*v[0];return z[0]=p[1]*v[2]-p[2]*v[1],z[1]=L,z[2]=U,z}function le(p,v){return p[0]*v[0]+p[1]*v[1]+p[2]*v[2]}function Ot(p){const v=p[0],E=p[1],z=p[2];return Math.sqrt(v*v+E*E+z*z)}const _e=Ot;function pt(p){const v=p[0],E=p[1],z=p[2];return v*v+E*E+z*z}const zt=pt;function ut(p,v){const E=p[0]-v[0],z=p[1]-v[1],L=p[2]-v[2];return Math.sqrt(E*E+z*z+L*L)}const we=ut;function ee(p,v){const E=p[0]-v[0],z=p[1]-v[1],L=p[2]-v[2];return E*E+z*z+L*L}const ge=ee;function Xt(p,v){const E=v??new n(3),z=p[0],L=p[1],U=p[2],B=Math.sqrt(z*z+L*L+U*U);return B>1e-5?(E[0]=z/B,E[1]=L/B,E[2]=U/B):(E[0]=0,E[1]=0,E[2]=0),E}function ye(p,v){const E=v??new n(3);return E[0]=-p[0],E[1]=-p[1],E[2]=-p[2],E}function qt(p,v){const E=v??new n(3);return E[0]=p[0],E[1]=p[1],E[2]=p[2],E}const be=qt;function ce(p,v,E){const z=E??new n(3);return z[0]=p[0]*v[0],z[1]=p[1]*v[1],z[2]=p[2]*v[2],z}const ke=ce;function Wt(p,v,E){const z=E??new n(3);return z[0]=p[0]/v[0],z[1]=p[1]/v[1],z[2]=p[2]/v[2],z}const me=Wt;function fe(p=1,v){const E=v??new n(3),z=Math.random()*2*Math.PI,L=Math.random()*2-1,U=Math.sqrt(1-L*L)*p;return E[0]=Math.cos(z)*U,E[1]=Math.sin(z)*U,E[2]=L*p,E}function u(p){const v=p??new n(3);return v[0]=0,v[1]=0,v[2]=0,v}function b(p,v,E){const z=E??new n(3),L=p[0],U=p[1],B=p[2],tt=v[3]*L+v[7]*U+v[11]*B+v[15]||1;return z[0]=(v[0]*L+v[4]*U+v[8]*B+v[12])/tt,z[1]=(v[1]*L+v[5]*U+v[9]*B+v[13])/tt,z[2]=(v[2]*L+v[6]*U+v[10]*B+v[14])/tt,z}function i(p,v,E){const z=E??new n(3),L=p[0],U=p[1],B=p[2];return z[0]=L*v[0*4+0]+U*v[1*4+0]+B*v[2*4+0],z[1]=L*v[0*4+1]+U*v[1*4+1]+B*v[2*4+1],z[2]=L*v[0*4+2]+U*v[1*4+2]+B*v[2*4+2],z}function l(p,v,E){const z=E??new n(3),L=p[0],U=p[1],B=p[2];return z[0]=L*v[0]+U*v[4]+B*v[8],z[1]=L*v[1]+U*v[5]+B*v[9],z[2]=L*v[2]+U*v[6]+B*v[10],z}function y(p,v,E){const z=E??new n(3),L=v[0],U=v[1],B=v[2],tt=v[3]*2,ot=p[0],C=p[1],nt=p[2],ct=U*nt-B*C,ft=B*ot-L*nt,Nt=L*C-U*ot;return z[0]=ot+ct*tt+(U*Nt-B*ft)*2,z[1]=C+ft*tt+(B*ct-L*Nt)*2,z[2]=nt+Nt*tt+(L*ft-U*ct)*2,z}function k(p,v){const E=v??new n(3);return E[0]=p[12],E[1]=p[13],E[2]=p[14],E}function V(p,v,E){const z=E??new n(3),L=v*4;return z[0]=p[L+0],z[1]=p[L+1],z[2]=p[L+2],z}function e(p,v){const E=v??new n(3),z=p[0],L=p[1],U=p[2],B=p[4],tt=p[5],ot=p[6],C=p[8],nt=p[9],ct=p[10];return E[0]=Math.sqrt(z*z+L*L+U*U),E[1]=Math.sqrt(B*B+tt*tt+ot*ot),E[2]=Math.sqrt(C*C+nt*nt+ct*ct),E}function d(p,v,E,z){const L=z??new n(3),U=[],B=[];return U[0]=p[0]-v[0],U[1]=p[1]-v[1],U[2]=p[2]-v[2],B[0]=U[0],B[1]=U[1]*Math.cos(E)-U[2]*Math.sin(E),B[2]=U[1]*Math.sin(E)+U[2]*Math.cos(E),L[0]=B[0]+v[0],L[1]=B[1]+v[1],L[2]=B[2]+v[2],L}function a(p,v,E,z){const L=z??new n(3),U=[],B=[];return U[0]=p[0]-v[0],U[1]=p[1]-v[1],U[2]=p[2]-v[2],B[0]=U[2]*Math.sin(E)+U[0]*Math.cos(E),B[1]=U[1],B[2]=U[2]*Math.cos(E)-U[0]*Math.sin(E),L[0]=B[0]+v[0],L[1]=B[1]+v[1],L[2]=B[2]+v[2],L}function c(p,v,E,z){const L=z??new n(3),U=[],B=[];return U[0]=p[0]-v[0],U[1]=p[1]-v[1],U[2]=p[2]-v[2],B[0]=U[0]*Math.cos(E)-U[1]*Math.sin(E),B[1]=U[0]*Math.sin(E)+U[1]*Math.cos(E),B[2]=U[2],L[0]=B[0]+v[0],L[1]=B[1]+v[1],L[2]=B[2]+v[2],L}function m(p,v,E){const z=E??new n(3);return Xt(p,z),At(z,v,z)}function T(p,v,E){const z=E??new n(3);return Ot(p)>v?m(p,v,z):qt(p,z)}function P(p,v,E){const z=E??new n(3);return O(p,v,.5,z)}return{create:t,fromValues:r,set:f,ceil:_,floor:x,round:q,clamp:R,add:Y,addScaled:W,angle:Q,subtract:rt,sub:it,equalsApproximately:Mt,equals:Tt,lerp:O,lerpV:et,max:wt,min:kt,mulScalar:At,scale:It,divScalar:Ut,inverse:st,invert:Gt,cross:gt,dot:le,length:Ot,len:_e,lengthSq:pt,lenSq:zt,distance:ut,dist:we,distanceSq:ee,distSq:ge,normalize:Xt,negate:ye,copy:qt,clone:be,multiply:ce,mul:ke,divide:Wt,div:me,random:fe,zero:u,transformMat4:b,transformMat4Upper3x3:i,transformMat3:l,transformQuat:y,getTranslation:k,getAxis:V,getScaling:e,rotateX:d,rotateY:a,rotateZ:c,setLength:m,truncate:T,midpoint:P}}const Bs=new Map;function Un(n){let t=Bs.get(n);return t||(t=Su(n),Bs.set(n,t)),t}function Du(n){const t=ua(n),r=Un(n);function f(u,b,i,l,y,k,V,e,d){const a=new n(12);return a[3]=0,a[7]=0,a[11]=0,u!==void 0&&(a[0]=u,b!==void 0&&(a[1]=b,i!==void 0&&(a[2]=i,l!==void 0&&(a[4]=l,y!==void 0&&(a[5]=y,k!==void 0&&(a[6]=k,V!==void 0&&(a[8]=V,e!==void 0&&(a[9]=e,d!==void 0&&(a[10]=d))))))))),a}function _(u,b,i,l,y,k,V,e,d,a){const c=a??new n(12);return c[0]=u,c[1]=b,c[2]=i,c[3]=0,c[4]=l,c[5]=y,c[6]=k,c[7]=0,c[8]=V,c[9]=e,c[10]=d,c[11]=0,c}function x(u,b){const i=b??new n(12);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i[3]=0,i[4]=u[4],i[5]=u[5],i[6]=u[6],i[7]=0,i[8]=u[8],i[9]=u[9],i[10]=u[10],i[11]=0,i}function q(u,b){const i=b??new n(12),l=u[0],y=u[1],k=u[2],V=u[3],e=l+l,d=y+y,a=k+k,c=l*e,m=y*e,T=y*d,P=k*e,p=k*d,v=k*a,E=V*e,z=V*d,L=V*a;return i[0]=1-T-v,i[1]=m+L,i[2]=P-z,i[3]=0,i[4]=m-L,i[5]=1-c-v,i[6]=p+E,i[7]=0,i[8]=P+z,i[9]=p-E,i[10]=1-c-T,i[11]=0,i}function R(u,b){const i=b??new n(12);return i[0]=-u[0],i[1]=-u[1],i[2]=-u[2],i[4]=-u[4],i[5]=-u[5],i[6]=-u[6],i[8]=-u[8],i[9]=-u[9],i[10]=-u[10],i}function Y(u,b){const i=b??new n(12);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i[4]=u[4],i[5]=u[5],i[6]=u[6],i[8]=u[8],i[9]=u[9],i[10]=u[10],i}const W=Y;function Q(u,b){return Math.abs(u[0]-b[0])<lt&&Math.abs(u[1]-b[1])<lt&&Math.abs(u[2]-b[2])<lt&&Math.abs(u[4]-b[4])<lt&&Math.abs(u[5]-b[5])<lt&&Math.abs(u[6]-b[6])<lt&&Math.abs(u[8]-b[8])<lt&&Math.abs(u[9]-b[9])<lt&&Math.abs(u[10]-b[10])<lt}function rt(u,b){return u[0]===b[0]&&u[1]===b[1]&&u[2]===b[2]&&u[4]===b[4]&&u[5]===b[5]&&u[6]===b[6]&&u[8]===b[8]&&u[9]===b[9]&&u[10]===b[10]}function it(u){const b=u??new n(12);return b[0]=1,b[1]=0,b[2]=0,b[4]=0,b[5]=1,b[6]=0,b[8]=0,b[9]=0,b[10]=1,b}function Mt(u,b){const i=b??new n(12);if(i===u){let T;return T=u[1],u[1]=u[4],u[4]=T,T=u[2],u[2]=u[8],u[8]=T,T=u[6],u[6]=u[9],u[9]=T,i}const l=u[0*4+0],y=u[0*4+1],k=u[0*4+2],V=u[1*4+0],e=u[1*4+1],d=u[1*4+2],a=u[2*4+0],c=u[2*4+1],m=u[2*4+2];return i[0]=l,i[1]=V,i[2]=a,i[4]=y,i[5]=e,i[6]=c,i[8]=k,i[9]=d,i[10]=m,i}function Tt(u,b){const i=b??new n(12),l=u[0*4+0],y=u[0*4+1],k=u[0*4+2],V=u[1*4+0],e=u[1*4+1],d=u[1*4+2],a=u[2*4+0],c=u[2*4+1],m=u[2*4+2],T=m*e-d*c,P=-m*V+d*a,p=c*V-e*a,v=1/(l*T+y*P+k*p);return i[0]=T*v,i[1]=(-m*y+k*c)*v,i[2]=(d*y-k*e)*v,i[4]=P*v,i[5]=(m*l-k*a)*v,i[6]=(-d*l+k*V)*v,i[8]=p*v,i[9]=(-c*l+y*a)*v,i[10]=(e*l-y*V)*v,i}function O(u){const b=u[0],i=u[0*4+1],l=u[0*4+2],y=u[1*4+0],k=u[1*4+1],V=u[1*4+2],e=u[2*4+0],d=u[2*4+1],a=u[2*4+2];return b*(k*a-d*V)-y*(i*a-d*l)+e*(i*V-k*l)}const et=Tt;function wt(u,b,i){const l=i??new n(12),y=u[0],k=u[1],V=u[2],e=u[4],d=u[5],a=u[6],c=u[8],m=u[9],T=u[10],P=b[0],p=b[1],v=b[2],E=b[4],z=b[5],L=b[6],U=b[8],B=b[9],tt=b[10];return l[0]=y*P+e*p+c*v,l[1]=k*P+d*p+m*v,l[2]=V*P+a*p+T*v,l[4]=y*E+e*z+c*L,l[5]=k*E+d*z+m*L,l[6]=V*E+a*z+T*L,l[8]=y*U+e*B+c*tt,l[9]=k*U+d*B+m*tt,l[10]=V*U+a*B+T*tt,l}const kt=wt;function At(u,b,i){const l=i??it();return u!==l&&(l[0]=u[0],l[1]=u[1],l[2]=u[2],l[4]=u[4],l[5]=u[5],l[6]=u[6]),l[8]=b[0],l[9]=b[1],l[10]=1,l}function It(u,b){const i=b??t.create();return i[0]=u[8],i[1]=u[9],i}function Ut(u,b,i){const l=i??t.create(),y=b*4;return l[0]=u[y+0],l[1]=u[y+1],l}function st(u,b,i,l){const y=l===u?u:Y(u,l),k=i*4;return y[k+0]=b[0],y[k+1]=b[1],y}function Gt(u,b){const i=b??t.create(),l=u[0],y=u[1],k=u[4],V=u[5];return i[0]=Math.sqrt(l*l+y*y),i[1]=Math.sqrt(k*k+V*V),i}function gt(u,b){const i=b??r.create(),l=u[0],y=u[1],k=u[2],V=u[4],e=u[5],d=u[6],a=u[8],c=u[9],m=u[10];return i[0]=Math.sqrt(l*l+y*y+k*k),i[1]=Math.sqrt(V*V+e*e+d*d),i[2]=Math.sqrt(a*a+c*c+m*m),i}function le(u,b){const i=b??new n(12);return i[0]=1,i[1]=0,i[2]=0,i[4]=0,i[5]=1,i[6]=0,i[8]=u[0],i[9]=u[1],i[10]=1,i}function Ot(u,b,i){const l=i??new n(12),y=b[0],k=b[1],V=u[0],e=u[1],d=u[2],a=u[1*4+0],c=u[1*4+1],m=u[1*4+2],T=u[2*4+0],P=u[2*4+1],p=u[2*4+2];return u!==l&&(l[0]=V,l[1]=e,l[2]=d,l[4]=a,l[5]=c,l[6]=m),l[8]=V*y+a*k+T,l[9]=e*y+c*k+P,l[10]=d*y+m*k+p,l}function _e(u,b){const i=b??new n(12),l=Math.cos(u),y=Math.sin(u);return i[0]=l,i[1]=y,i[2]=0,i[4]=-y,i[5]=l,i[6]=0,i[8]=0,i[9]=0,i[10]=1,i}function pt(u,b,i){const l=i??new n(12),y=u[0*4+0],k=u[0*4+1],V=u[0*4+2],e=u[1*4+0],d=u[1*4+1],a=u[1*4+2],c=Math.cos(b),m=Math.sin(b);return l[0]=c*y+m*e,l[1]=c*k+m*d,l[2]=c*V+m*a,l[4]=c*e-m*y,l[5]=c*d-m*k,l[6]=c*a-m*V,u!==l&&(l[8]=u[8],l[9]=u[9],l[10]=u[10]),l}function zt(u,b){const i=b??new n(12),l=Math.cos(u),y=Math.sin(u);return i[0]=1,i[1]=0,i[2]=0,i[4]=0,i[5]=l,i[6]=y,i[8]=0,i[9]=-y,i[10]=l,i}function ut(u,b,i){const l=i??new n(12),y=u[4],k=u[5],V=u[6],e=u[8],d=u[9],a=u[10],c=Math.cos(b),m=Math.sin(b);return l[4]=c*y+m*e,l[5]=c*k+m*d,l[6]=c*V+m*a,l[8]=c*e-m*y,l[9]=c*d-m*k,l[10]=c*a-m*V,u!==l&&(l[0]=u[0],l[1]=u[1],l[2]=u[2]),l}function we(u,b){const i=b??new n(12),l=Math.cos(u),y=Math.sin(u);return i[0]=l,i[1]=0,i[2]=-y,i[4]=0,i[5]=1,i[6]=0,i[8]=y,i[9]=0,i[10]=l,i}function ee(u,b,i){const l=i??new n(12),y=u[0*4+0],k=u[0*4+1],V=u[0*4+2],e=u[2*4+0],d=u[2*4+1],a=u[2*4+2],c=Math.cos(b),m=Math.sin(b);return l[0]=c*y-m*e,l[1]=c*k-m*d,l[2]=c*V-m*a,l[8]=c*e+m*y,l[9]=c*d+m*k,l[10]=c*a+m*V,u!==l&&(l[4]=u[4],l[5]=u[5],l[6]=u[6]),l}const ge=_e,Xt=pt;function ye(u,b){const i=b??new n(12);return i[0]=u[0],i[1]=0,i[2]=0,i[4]=0,i[5]=u[1],i[6]=0,i[8]=0,i[9]=0,i[10]=1,i}function qt(u,b,i){const l=i??new n(12),y=b[0],k=b[1];return l[0]=y*u[0*4+0],l[1]=y*u[0*4+1],l[2]=y*u[0*4+2],l[4]=k*u[1*4+0],l[5]=k*u[1*4+1],l[6]=k*u[1*4+2],u!==l&&(l[8]=u[8],l[9]=u[9],l[10]=u[10]),l}function be(u,b){const i=b??new n(12);return i[0]=u[0],i[1]=0,i[2]=0,i[4]=0,i[5]=u[1],i[6]=0,i[8]=0,i[9]=0,i[10]=u[2],i}function ce(u,b,i){const l=i??new n(12),y=b[0],k=b[1],V=b[2];return l[0]=y*u[0*4+0],l[1]=y*u[0*4+1],l[2]=y*u[0*4+2],l[4]=k*u[1*4+0],l[5]=k*u[1*4+1],l[6]=k*u[1*4+2],l[8]=V*u[2*4+0],l[9]=V*u[2*4+1],l[10]=V*u[2*4+2],l}function ke(u,b){const i=b??new n(12);return i[0]=u,i[1]=0,i[2]=0,i[4]=0,i[5]=u,i[6]=0,i[8]=0,i[9]=0,i[10]=1,i}function Wt(u,b,i){const l=i??new n(12);return l[0]=b*u[0*4+0],l[1]=b*u[0*4+1],l[2]=b*u[0*4+2],l[4]=b*u[1*4+0],l[5]=b*u[1*4+1],l[6]=b*u[1*4+2],u!==l&&(l[8]=u[8],l[9]=u[9],l[10]=u[10]),l}function me(u,b){const i=b??new n(12);return i[0]=u,i[1]=0,i[2]=0,i[4]=0,i[5]=u,i[6]=0,i[8]=0,i[9]=0,i[10]=u,i}function fe(u,b,i){const l=i??new n(12);return l[0]=b*u[0*4+0],l[1]=b*u[0*4+1],l[2]=b*u[0*4+2],l[4]=b*u[1*4+0],l[5]=b*u[1*4+1],l[6]=b*u[1*4+2],l[8]=b*u[2*4+0],l[9]=b*u[2*4+1],l[10]=b*u[2*4+2],l}return{clone:W,create:f,set:_,fromMat4:x,fromQuat:q,negate:R,copy:Y,equalsApproximately:Q,equals:rt,identity:it,transpose:Mt,inverse:Tt,invert:et,determinant:O,mul:kt,multiply:wt,setTranslation:At,getTranslation:It,getAxis:Ut,setAxis:st,getScaling:Gt,get3DScaling:gt,translation:le,translate:Ot,rotation:_e,rotate:pt,rotationX:zt,rotateX:ut,rotationY:we,rotateY:ee,rotationZ:ge,rotateZ:Xt,scaling:ye,scale:qt,uniformScaling:ke,uniformScale:Wt,scaling3D:be,scale3D:ce,uniformScaling3D:me,uniformScale3D:fe}}const Rs=new Map;function $u(n){let t=Rs.get(n);return t||(t=Du(n),Rs.set(n,t)),t}function qu(n){const t=Un(n);function r(e,d,a,c,m,T,P,p,v,E,z,L,U,B,tt,ot){const C=new n(16);return e!==void 0&&(C[0]=e,d!==void 0&&(C[1]=d,a!==void 0&&(C[2]=a,c!==void 0&&(C[3]=c,m!==void 0&&(C[4]=m,T!==void 0&&(C[5]=T,P!==void 0&&(C[6]=P,p!==void 0&&(C[7]=p,v!==void 0&&(C[8]=v,E!==void 0&&(C[9]=E,z!==void 0&&(C[10]=z,L!==void 0&&(C[11]=L,U!==void 0&&(C[12]=U,B!==void 0&&(C[13]=B,tt!==void 0&&(C[14]=tt,ot!==void 0&&(C[15]=ot)))))))))))))))),C}function f(e,d,a,c,m,T,P,p,v,E,z,L,U,B,tt,ot,C){const nt=C??new n(16);return nt[0]=e,nt[1]=d,nt[2]=a,nt[3]=c,nt[4]=m,nt[5]=T,nt[6]=P,nt[7]=p,nt[8]=v,nt[9]=E,nt[10]=z,nt[11]=L,nt[12]=U,nt[13]=B,nt[14]=tt,nt[15]=ot,nt}function _(e,d){const a=d??new n(16);return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=0,a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=0,a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function x(e,d){const a=d??new n(16),c=e[0],m=e[1],T=e[2],P=e[3],p=c+c,v=m+m,E=T+T,z=c*p,L=m*p,U=m*v,B=T*p,tt=T*v,ot=T*E,C=P*p,nt=P*v,ct=P*E;return a[0]=1-U-ot,a[1]=L+ct,a[2]=B-nt,a[3]=0,a[4]=L-ct,a[5]=1-z-ot,a[6]=tt+C,a[7]=0,a[8]=B+nt,a[9]=tt-C,a[10]=1-z-U,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function q(e,d){const a=d??new n(16);return a[0]=-e[0],a[1]=-e[1],a[2]=-e[2],a[3]=-e[3],a[4]=-e[4],a[5]=-e[5],a[6]=-e[6],a[7]=-e[7],a[8]=-e[8],a[9]=-e[9],a[10]=-e[10],a[11]=-e[11],a[12]=-e[12],a[13]=-e[13],a[14]=-e[14],a[15]=-e[15],a}function R(e,d){const a=d??new n(16);return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a}const Y=R;function W(e,d){return Math.abs(e[0]-d[0])<lt&&Math.abs(e[1]-d[1])<lt&&Math.abs(e[2]-d[2])<lt&&Math.abs(e[3]-d[3])<lt&&Math.abs(e[4]-d[4])<lt&&Math.abs(e[5]-d[5])<lt&&Math.abs(e[6]-d[6])<lt&&Math.abs(e[7]-d[7])<lt&&Math.abs(e[8]-d[8])<lt&&Math.abs(e[9]-d[9])<lt&&Math.abs(e[10]-d[10])<lt&&Math.abs(e[11]-d[11])<lt&&Math.abs(e[12]-d[12])<lt&&Math.abs(e[13]-d[13])<lt&&Math.abs(e[14]-d[14])<lt&&Math.abs(e[15]-d[15])<lt}function Q(e,d){return e[0]===d[0]&&e[1]===d[1]&&e[2]===d[2]&&e[3]===d[3]&&e[4]===d[4]&&e[5]===d[5]&&e[6]===d[6]&&e[7]===d[7]&&e[8]===d[8]&&e[9]===d[9]&&e[10]===d[10]&&e[11]===d[11]&&e[12]===d[12]&&e[13]===d[13]&&e[14]===d[14]&&e[15]===d[15]}function rt(e){const d=e??new n(16);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}function it(e,d){const a=d??new n(16);if(a===e){let ft;return ft=e[1],e[1]=e[4],e[4]=ft,ft=e[2],e[2]=e[8],e[8]=ft,ft=e[3],e[3]=e[12],e[12]=ft,ft=e[6],e[6]=e[9],e[9]=ft,ft=e[7],e[7]=e[13],e[13]=ft,ft=e[11],e[11]=e[14],e[14]=ft,a}const c=e[0*4+0],m=e[0*4+1],T=e[0*4+2],P=e[0*4+3],p=e[1*4+0],v=e[1*4+1],E=e[1*4+2],z=e[1*4+3],L=e[2*4+0],U=e[2*4+1],B=e[2*4+2],tt=e[2*4+3],ot=e[3*4+0],C=e[3*4+1],nt=e[3*4+2],ct=e[3*4+3];return a[0]=c,a[1]=p,a[2]=L,a[3]=ot,a[4]=m,a[5]=v,a[6]=U,a[7]=C,a[8]=T,a[9]=E,a[10]=B,a[11]=nt,a[12]=P,a[13]=z,a[14]=tt,a[15]=ct,a}function Mt(e,d){const a=d??new n(16),c=e[0*4+0],m=e[0*4+1],T=e[0*4+2],P=e[0*4+3],p=e[1*4+0],v=e[1*4+1],E=e[1*4+2],z=e[1*4+3],L=e[2*4+0],U=e[2*4+1],B=e[2*4+2],tt=e[2*4+3],ot=e[3*4+0],C=e[3*4+1],nt=e[3*4+2],ct=e[3*4+3],ft=B*ct,Nt=nt*tt,Vt=E*ct,Pt=nt*z,Bt=E*tt,Yt=B*z,Zt=T*ct,Ht=nt*P,jt=T*tt,Qt=B*P,ne=T*z,re=E*P,se=L*C,ae=ot*U,he=p*C,de=ot*v,pe=p*U,He=L*v,je=c*C,Ue=ot*m,Oe=c*U,Qe=L*m,Je=c*v,Ke=p*m,Be=ft*v+Pt*U+Bt*C-(Nt*v+Vt*U+Yt*C),Mn=Nt*m+Zt*U+Qt*C-(ft*m+Ht*U+jt*C),gn=Vt*m+Ht*v+ne*C-(Pt*m+Zt*v+re*C),An=Yt*m+jt*v+re*U-(Bt*m+Qt*v+ne*U),Jt=1/(c*Be+p*Mn+L*gn+ot*An);return a[0]=Jt*Be,a[1]=Jt*Mn,a[2]=Jt*gn,a[3]=Jt*An,a[4]=Jt*(Nt*p+Vt*L+Yt*ot-(ft*p+Pt*L+Bt*ot)),a[5]=Jt*(ft*c+Ht*L+jt*ot-(Nt*c+Zt*L+Qt*ot)),a[6]=Jt*(Pt*c+Zt*p+re*ot-(Vt*c+Ht*p+ne*ot)),a[7]=Jt*(Bt*c+Qt*p+ne*L-(Yt*c+jt*p+re*L)),a[8]=Jt*(se*z+de*tt+pe*ct-(ae*z+he*tt+He*ct)),a[9]=Jt*(ae*P+je*tt+Qe*ct-(se*P+Ue*tt+Oe*ct)),a[10]=Jt*(he*P+Ue*z+Je*ct-(de*P+je*z+Ke*ct)),a[11]=Jt*(He*P+Oe*z+Ke*tt-(pe*P+Qe*z+Je*tt)),a[12]=Jt*(he*B+He*nt+ae*E-(pe*nt+se*E+de*B)),a[13]=Jt*(Oe*nt+se*T+Ue*B-(je*B+Qe*nt+ae*T)),a[14]=Jt*(je*E+Ke*nt+de*T-(Je*nt+he*T+Ue*E)),a[15]=Jt*(Je*B+pe*T+Qe*E-(Oe*E+Ke*B+He*T)),a}function Tt(e){const d=e[0],a=e[0*4+1],c=e[0*4+2],m=e[0*4+3],T=e[1*4+0],P=e[1*4+1],p=e[1*4+2],v=e[1*4+3],E=e[2*4+0],z=e[2*4+1],L=e[2*4+2],U=e[2*4+3],B=e[3*4+0],tt=e[3*4+1],ot=e[3*4+2],C=e[3*4+3],nt=L*C,ct=ot*U,ft=p*C,Nt=ot*v,Vt=p*U,Pt=L*v,Bt=c*C,Yt=ot*m,Zt=c*U,Ht=L*m,jt=c*v,Qt=p*m,ne=nt*P+Nt*z+Vt*tt-(ct*P+ft*z+Pt*tt),re=ct*a+Bt*z+Ht*tt-(nt*a+Yt*z+Zt*tt),se=ft*a+Yt*P+jt*tt-(Nt*a+Bt*P+Qt*tt),ae=Pt*a+Zt*P+Qt*z-(Vt*a+Ht*P+jt*z);return d*ne+T*re+E*se+B*ae}const O=Mt;function et(e,d,a){const c=a??new n(16),m=e[0],T=e[1],P=e[2],p=e[3],v=e[4],E=e[5],z=e[6],L=e[7],U=e[8],B=e[9],tt=e[10],ot=e[11],C=e[12],nt=e[13],ct=e[14],ft=e[15],Nt=d[0],Vt=d[1],Pt=d[2],Bt=d[3],Yt=d[4],Zt=d[5],Ht=d[6],jt=d[7],Qt=d[8],ne=d[9],re=d[10],se=d[11],ae=d[12],he=d[13],de=d[14],pe=d[15];return c[0]=m*Nt+v*Vt+U*Pt+C*Bt,c[1]=T*Nt+E*Vt+B*Pt+nt*Bt,c[2]=P*Nt+z*Vt+tt*Pt+ct*Bt,c[3]=p*Nt+L*Vt+ot*Pt+ft*Bt,c[4]=m*Yt+v*Zt+U*Ht+C*jt,c[5]=T*Yt+E*Zt+B*Ht+nt*jt,c[6]=P*Yt+z*Zt+tt*Ht+ct*jt,c[7]=p*Yt+L*Zt+ot*Ht+ft*jt,c[8]=m*Qt+v*ne+U*re+C*se,c[9]=T*Qt+E*ne+B*re+nt*se,c[10]=P*Qt+z*ne+tt*re+ct*se,c[11]=p*Qt+L*ne+ot*re+ft*se,c[12]=m*ae+v*he+U*de+C*pe,c[13]=T*ae+E*he+B*de+nt*pe,c[14]=P*ae+z*he+tt*de+ct*pe,c[15]=p*ae+L*he+ot*de+ft*pe,c}const wt=et;function kt(e,d,a){const c=a??rt();return e!==c&&(c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c[8]=e[8],c[9]=e[9],c[10]=e[10],c[11]=e[11]),c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=1,c}function At(e,d){const a=d??t.create();return a[0]=e[12],a[1]=e[13],a[2]=e[14],a}function It(e,d,a){const c=a??t.create(),m=d*4;return c[0]=e[m+0],c[1]=e[m+1],c[2]=e[m+2],c}function Ut(e,d,a,c){const m=c===e?c:R(e,c),T=a*4;return m[T+0]=d[0],m[T+1]=d[1],m[T+2]=d[2],m}function st(e,d){const a=d??t.create(),c=e[0],m=e[1],T=e[2],P=e[4],p=e[5],v=e[6],E=e[8],z=e[9],L=e[10];return a[0]=Math.sqrt(c*c+m*m+T*T),a[1]=Math.sqrt(P*P+p*p+v*v),a[2]=Math.sqrt(E*E+z*z+L*L),a}function Gt(e,d,a,c,m){const T=m??new n(16),P=Math.tan(Math.PI*.5-.5*e);if(T[0]=P/d,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=P,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[11]=-1,T[12]=0,T[13]=0,T[15]=0,Number.isFinite(c)){const p=1/(a-c);T[10]=c*p,T[14]=c*a*p}else T[10]=-1,T[14]=-a;return T}function gt(e,d,a,c=1/0,m){const T=m??new n(16),P=1/Math.tan(e*.5);if(T[0]=P/d,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=P,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[11]=-1,T[12]=0,T[13]=0,T[15]=0,c===1/0)T[10]=0,T[14]=a;else{const p=1/(c-a);T[10]=a*p,T[14]=c*a*p}return T}function le(e,d,a,c,m,T,P){const p=P??new n(16);return p[0]=2/(d-e),p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=2/(c-a),p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1/(m-T),p[11]=0,p[12]=(d+e)/(e-d),p[13]=(c+a)/(a-c),p[14]=m/(m-T),p[15]=1,p}function Ot(e,d,a,c,m,T,P){const p=P??new n(16),v=d-e,E=c-a,z=m-T;return p[0]=2*m/v,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=2*m/E,p[6]=0,p[7]=0,p[8]=(e+d)/v,p[9]=(c+a)/E,p[10]=T/z,p[11]=-1,p[12]=0,p[13]=0,p[14]=m*T/z,p[15]=0,p}function _e(e,d,a,c,m,T=1/0,P){const p=P??new n(16),v=d-e,E=c-a;if(p[0]=2*m/v,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=2*m/E,p[6]=0,p[7]=0,p[8]=(e+d)/v,p[9]=(c+a)/E,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,T===1/0)p[10]=0,p[14]=m;else{const z=1/(T-m);p[10]=m*z,p[14]=T*m*z}return p}const pt=t.create(),zt=t.create(),ut=t.create();function we(e,d,a,c){const m=c??new n(16);return t.normalize(t.subtract(d,e,ut),ut),t.normalize(t.cross(a,ut,pt),pt),t.normalize(t.cross(ut,pt,zt),zt),m[0]=pt[0],m[1]=pt[1],m[2]=pt[2],m[3]=0,m[4]=zt[0],m[5]=zt[1],m[6]=zt[2],m[7]=0,m[8]=ut[0],m[9]=ut[1],m[10]=ut[2],m[11]=0,m[12]=e[0],m[13]=e[1],m[14]=e[2],m[15]=1,m}function ee(e,d,a,c){const m=c??new n(16);return t.normalize(t.subtract(e,d,ut),ut),t.normalize(t.cross(a,ut,pt),pt),t.normalize(t.cross(ut,pt,zt),zt),m[0]=pt[0],m[1]=pt[1],m[2]=pt[2],m[3]=0,m[4]=zt[0],m[5]=zt[1],m[6]=zt[2],m[7]=0,m[8]=ut[0],m[9]=ut[1],m[10]=ut[2],m[11]=0,m[12]=e[0],m[13]=e[1],m[14]=e[2],m[15]=1,m}function ge(e,d,a,c){const m=c??new n(16);return t.normalize(t.subtract(e,d,ut),ut),t.normalize(t.cross(a,ut,pt),pt),t.normalize(t.cross(ut,pt,zt),zt),m[0]=pt[0],m[1]=zt[0],m[2]=ut[0],m[3]=0,m[4]=pt[1],m[5]=zt[1],m[6]=ut[1],m[7]=0,m[8]=pt[2],m[9]=zt[2],m[10]=ut[2],m[11]=0,m[12]=-(pt[0]*e[0]+pt[1]*e[1]+pt[2]*e[2]),m[13]=-(zt[0]*e[0]+zt[1]*e[1]+zt[2]*e[2]),m[14]=-(ut[0]*e[0]+ut[1]*e[1]+ut[2]*e[2]),m[15]=1,m}function Xt(e,d){const a=d??new n(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=e[0],a[13]=e[1],a[14]=e[2],a[15]=1,a}function ye(e,d,a){const c=a??new n(16),m=d[0],T=d[1],P=d[2],p=e[0],v=e[1],E=e[2],z=e[3],L=e[1*4+0],U=e[1*4+1],B=e[1*4+2],tt=e[1*4+3],ot=e[2*4+0],C=e[2*4+1],nt=e[2*4+2],ct=e[2*4+3],ft=e[3*4+0],Nt=e[3*4+1],Vt=e[3*4+2],Pt=e[3*4+3];return e!==c&&(c[0]=p,c[1]=v,c[2]=E,c[3]=z,c[4]=L,c[5]=U,c[6]=B,c[7]=tt,c[8]=ot,c[9]=C,c[10]=nt,c[11]=ct),c[12]=p*m+L*T+ot*P+ft,c[13]=v*m+U*T+C*P+Nt,c[14]=E*m+B*T+nt*P+Vt,c[15]=z*m+tt*T+ct*P+Pt,c}function qt(e,d){const a=d??new n(16),c=Math.cos(e),m=Math.sin(e);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=c,a[6]=m,a[7]=0,a[8]=0,a[9]=-m,a[10]=c,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function be(e,d,a){const c=a??new n(16),m=e[4],T=e[5],P=e[6],p=e[7],v=e[8],E=e[9],z=e[10],L=e[11],U=Math.cos(d),B=Math.sin(d);return c[4]=U*m+B*v,c[5]=U*T+B*E,c[6]=U*P+B*z,c[7]=U*p+B*L,c[8]=U*v-B*m,c[9]=U*E-B*T,c[10]=U*z-B*P,c[11]=U*L-B*p,e!==c&&(c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15]),c}function ce(e,d){const a=d??new n(16),c=Math.cos(e),m=Math.sin(e);return a[0]=c,a[1]=0,a[2]=-m,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=m,a[9]=0,a[10]=c,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function ke(e,d,a){const c=a??new n(16),m=e[0*4+0],T=e[0*4+1],P=e[0*4+2],p=e[0*4+3],v=e[2*4+0],E=e[2*4+1],z=e[2*4+2],L=e[2*4+3],U=Math.cos(d),B=Math.sin(d);return c[0]=U*m-B*v,c[1]=U*T-B*E,c[2]=U*P-B*z,c[3]=U*p-B*L,c[8]=U*v+B*m,c[9]=U*E+B*T,c[10]=U*z+B*P,c[11]=U*L+B*p,e!==c&&(c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15]),c}function Wt(e,d){const a=d??new n(16),c=Math.cos(e),m=Math.sin(e);return a[0]=c,a[1]=m,a[2]=0,a[3]=0,a[4]=-m,a[5]=c,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function me(e,d,a){const c=a??new n(16),m=e[0*4+0],T=e[0*4+1],P=e[0*4+2],p=e[0*4+3],v=e[1*4+0],E=e[1*4+1],z=e[1*4+2],L=e[1*4+3],U=Math.cos(d),B=Math.sin(d);return c[0]=U*m+B*v,c[1]=U*T+B*E,c[2]=U*P+B*z,c[3]=U*p+B*L,c[4]=U*v-B*m,c[5]=U*E-B*T,c[6]=U*z-B*P,c[7]=U*L-B*p,e!==c&&(c[8]=e[8],c[9]=e[9],c[10]=e[10],c[11]=e[11],c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15]),c}function fe(e,d,a){const c=a??new n(16);let m=e[0],T=e[1],P=e[2];const p=Math.sqrt(m*m+T*T+P*P);m/=p,T/=p,P/=p;const v=m*m,E=T*T,z=P*P,L=Math.cos(d),U=Math.sin(d),B=1-L;return c[0]=v+(1-v)*L,c[1]=m*T*B+P*U,c[2]=m*P*B-T*U,c[3]=0,c[4]=m*T*B-P*U,c[5]=E+(1-E)*L,c[6]=T*P*B+m*U,c[7]=0,c[8]=m*P*B+T*U,c[9]=T*P*B-m*U,c[10]=z+(1-z)*L,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}const u=fe;function b(e,d,a,c){const m=c??new n(16);let T=d[0],P=d[1],p=d[2];const v=Math.sqrt(T*T+P*P+p*p);T/=v,P/=v,p/=v;const E=T*T,z=P*P,L=p*p,U=Math.cos(a),B=Math.sin(a),tt=1-U,ot=E+(1-E)*U,C=T*P*tt+p*B,nt=T*p*tt-P*B,ct=T*P*tt-p*B,ft=z+(1-z)*U,Nt=P*p*tt+T*B,Vt=T*p*tt+P*B,Pt=P*p*tt-T*B,Bt=L+(1-L)*U,Yt=e[0],Zt=e[1],Ht=e[2],jt=e[3],Qt=e[4],ne=e[5],re=e[6],se=e[7],ae=e[8],he=e[9],de=e[10],pe=e[11];return m[0]=ot*Yt+C*Qt+nt*ae,m[1]=ot*Zt+C*ne+nt*he,m[2]=ot*Ht+C*re+nt*de,m[3]=ot*jt+C*se+nt*pe,m[4]=ct*Yt+ft*Qt+Nt*ae,m[5]=ct*Zt+ft*ne+Nt*he,m[6]=ct*Ht+ft*re+Nt*de,m[7]=ct*jt+ft*se+Nt*pe,m[8]=Vt*Yt+Pt*Qt+Bt*ae,m[9]=Vt*Zt+Pt*ne+Bt*he,m[10]=Vt*Ht+Pt*re+Bt*de,m[11]=Vt*jt+Pt*se+Bt*pe,e!==m&&(m[12]=e[12],m[13]=e[13],m[14]=e[14],m[15]=e[15]),m}const i=b;function l(e,d){const a=d??new n(16);return a[0]=e[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function y(e,d,a){const c=a??new n(16),m=d[0],T=d[1],P=d[2];return c[0]=m*e[0*4+0],c[1]=m*e[0*4+1],c[2]=m*e[0*4+2],c[3]=m*e[0*4+3],c[4]=T*e[1*4+0],c[5]=T*e[1*4+1],c[6]=T*e[1*4+2],c[7]=T*e[1*4+3],c[8]=P*e[2*4+0],c[9]=P*e[2*4+1],c[10]=P*e[2*4+2],c[11]=P*e[2*4+3],e!==c&&(c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15]),c}function k(e,d){const a=d??new n(16);return a[0]=e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function V(e,d,a){const c=a??new n(16);return c[0]=d*e[0*4+0],c[1]=d*e[0*4+1],c[2]=d*e[0*4+2],c[3]=d*e[0*4+3],c[4]=d*e[1*4+0],c[5]=d*e[1*4+1],c[6]=d*e[1*4+2],c[7]=d*e[1*4+3],c[8]=d*e[2*4+0],c[9]=d*e[2*4+1],c[10]=d*e[2*4+2],c[11]=d*e[2*4+3],e!==c&&(c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15]),c}return{create:r,set:f,fromMat3:_,fromQuat:x,negate:q,copy:R,clone:Y,equalsApproximately:W,equals:Q,identity:rt,transpose:it,inverse:Mt,determinant:Tt,invert:O,multiply:et,mul:wt,setTranslation:kt,getTranslation:At,getAxis:It,setAxis:Ut,getScaling:st,perspective:Gt,perspectiveReverseZ:gt,ortho:le,frustum:Ot,frustumReverseZ:_e,aim:we,cameraAim:ee,lookAt:ge,translation:Xt,translate:ye,rotationX:qt,rotateX:be,rotationY:ce,rotateY:ke,rotationZ:Wt,rotateZ:me,axisRotation:fe,rotation:u,axisRotate:b,rotate:i,scaling:l,scale:y,uniformScaling:k,uniformScale:V}}const Gs=new Map;function Iu(n){let t=Gs.get(n);return t||(t=qu(n),Gs.set(n,t)),t}function Nu(n){const t=Un(n);function r(u,b,i,l){const y=new n(4);return u!==void 0&&(y[0]=u,b!==void 0&&(y[1]=b,i!==void 0&&(y[2]=i,l!==void 0&&(y[3]=l)))),y}const f=r;function _(u,b,i,l,y){const k=y??new n(4);return k[0]=u,k[1]=b,k[2]=i,k[3]=l,k}function x(u,b,i){const l=i??new n(4),y=b*.5,k=Math.sin(y);return l[0]=k*u[0],l[1]=k*u[1],l[2]=k*u[2],l[3]=Math.cos(y),l}function q(u,b){const i=b??t.create(3),l=Math.acos(u[3])*2,y=Math.sin(l*.5);return y>lt?(i[0]=u[0]/y,i[1]=u[1]/y,i[2]=u[2]/y):(i[0]=1,i[1]=0,i[2]=0),{angle:l,axis:i}}function R(u,b){const i=Ot(u,b);return Math.acos(2*i*i-1)}function Y(u,b,i){const l=i??new n(4),y=u[0],k=u[1],V=u[2],e=u[3],d=b[0],a=b[1],c=b[2],m=b[3];return l[0]=y*m+e*d+k*c-V*a,l[1]=k*m+e*a+V*d-y*c,l[2]=V*m+e*c+y*a-k*d,l[3]=e*m-y*d-k*a-V*c,l}const W=Y;function Q(u,b,i){const l=i??new n(4),y=b*.5,k=u[0],V=u[1],e=u[2],d=u[3],a=Math.sin(y),c=Math.cos(y);return l[0]=k*c+d*a,l[1]=V*c+e*a,l[2]=e*c-V*a,l[3]=d*c-k*a,l}function rt(u,b,i){const l=i??new n(4),y=b*.5,k=u[0],V=u[1],e=u[2],d=u[3],a=Math.sin(y),c=Math.cos(y);return l[0]=k*c-e*a,l[1]=V*c+d*a,l[2]=e*c+k*a,l[3]=d*c-V*a,l}function it(u,b,i){const l=i??new n(4),y=b*.5,k=u[0],V=u[1],e=u[2],d=u[3],a=Math.sin(y),c=Math.cos(y);return l[0]=k*c+V*a,l[1]=V*c-k*a,l[2]=e*c+d*a,l[3]=d*c-e*a,l}function Mt(u,b,i,l){const y=l??new n(4),k=u[0],V=u[1],e=u[2],d=u[3];let a=b[0],c=b[1],m=b[2],T=b[3],P=k*a+V*c+e*m+d*T;P<0&&(P=-P,a=-a,c=-c,m=-m,T=-T);let p,v;if(1-P>lt){const E=Math.acos(P),z=Math.sin(E);p=Math.sin((1-i)*E)/z,v=Math.sin(i*E)/z}else p=1-i,v=i;return y[0]=p*k+v*a,y[1]=p*V+v*c,y[2]=p*e+v*m,y[3]=p*d+v*T,y}function Tt(u,b){const i=b??new n(4),l=u[0],y=u[1],k=u[2],V=u[3],e=l*l+y*y+k*k+V*V,d=e?1/e:0;return i[0]=-l*d,i[1]=-y*d,i[2]=-k*d,i[3]=V*d,i}function O(u,b){const i=b??new n(4);return i[0]=-u[0],i[1]=-u[1],i[2]=-u[2],i[3]=u[3],i}function et(u,b){const i=b??new n(4),l=u[0]+u[5]+u[10];if(l>0){const y=Math.sqrt(l+1);i[3]=.5*y;const k=.5/y;i[0]=(u[6]-u[9])*k,i[1]=(u[8]-u[2])*k,i[2]=(u[1]-u[4])*k}else{let y=0;u[5]>u[0]&&(y=1),u[10]>u[y*4+y]&&(y=2);const k=(y+1)%3,V=(y+2)%3,e=Math.sqrt(u[y*4+y]-u[k*4+k]-u[V*4+V]+1);i[y]=.5*e;const d=.5/e;i[3]=(u[k*4+V]-u[V*4+k])*d,i[k]=(u[k*4+y]+u[y*4+k])*d,i[V]=(u[V*4+y]+u[y*4+V])*d}return i}function wt(u,b,i,l,y){const k=y??new n(4),V=u*.5,e=b*.5,d=i*.5,a=Math.sin(V),c=Math.cos(V),m=Math.sin(e),T=Math.cos(e),P=Math.sin(d),p=Math.cos(d);switch(l){case"xyz":k[0]=a*T*p+c*m*P,k[1]=c*m*p-a*T*P,k[2]=c*T*P+a*m*p,k[3]=c*T*p-a*m*P;break;case"xzy":k[0]=a*T*p-c*m*P,k[1]=c*m*p-a*T*P,k[2]=c*T*P+a*m*p,k[3]=c*T*p+a*m*P;break;case"yxz":k[0]=a*T*p+c*m*P,k[1]=c*m*p-a*T*P,k[2]=c*T*P-a*m*p,k[3]=c*T*p+a*m*P;break;case"yzx":k[0]=a*T*p+c*m*P,k[1]=c*m*p+a*T*P,k[2]=c*T*P-a*m*p,k[3]=c*T*p-a*m*P;break;case"zxy":k[0]=a*T*p-c*m*P,k[1]=c*m*p+a*T*P,k[2]=c*T*P+a*m*p,k[3]=c*T*p-a*m*P;break;case"zyx":k[0]=a*T*p-c*m*P,k[1]=c*m*p+a*T*P,k[2]=c*T*P-a*m*p,k[3]=c*T*p+a*m*P;break;default:throw new Error(`Unknown rotation order: ${l}`)}return k}function kt(u,b){const i=b??new n(4);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i[3]=u[3],i}const At=kt;function It(u,b,i){const l=i??new n(4);return l[0]=u[0]+b[0],l[1]=u[1]+b[1],l[2]=u[2]+b[2],l[3]=u[3]+b[3],l}function Ut(u,b,i){const l=i??new n(4);return l[0]=u[0]-b[0],l[1]=u[1]-b[1],l[2]=u[2]-b[2],l[3]=u[3]-b[3],l}const st=Ut;function Gt(u,b,i){const l=i??new n(4);return l[0]=u[0]*b,l[1]=u[1]*b,l[2]=u[2]*b,l[3]=u[3]*b,l}const gt=Gt;function le(u,b,i){const l=i??new n(4);return l[0]=u[0]/b,l[1]=u[1]/b,l[2]=u[2]/b,l[3]=u[3]/b,l}function Ot(u,b){return u[0]*b[0]+u[1]*b[1]+u[2]*b[2]+u[3]*b[3]}function _e(u,b,i,l){const y=l??new n(4);return y[0]=u[0]+i*(b[0]-u[0]),y[1]=u[1]+i*(b[1]-u[1]),y[2]=u[2]+i*(b[2]-u[2]),y[3]=u[3]+i*(b[3]-u[3]),y}function pt(u){const b=u[0],i=u[1],l=u[2],y=u[3];return Math.sqrt(b*b+i*i+l*l+y*y)}const zt=pt;function ut(u){const b=u[0],i=u[1],l=u[2],y=u[3];return b*b+i*i+l*l+y*y}const we=ut;function ee(u,b){const i=b??new n(4),l=u[0],y=u[1],k=u[2],V=u[3],e=Math.sqrt(l*l+y*y+k*k+V*V);return e>1e-5?(i[0]=l/e,i[1]=y/e,i[2]=k/e,i[3]=V/e):(i[0]=0,i[1]=0,i[2]=0,i[3]=1),i}function ge(u,b){return Math.abs(u[0]-b[0])<lt&&Math.abs(u[1]-b[1])<lt&&Math.abs(u[2]-b[2])<lt&&Math.abs(u[3]-b[3])<lt}function Xt(u,b){return u[0]===b[0]&&u[1]===b[1]&&u[2]===b[2]&&u[3]===b[3]}function ye(u){const b=u??new n(4);return b[0]=0,b[1]=0,b[2]=0,b[3]=1,b}const qt=t.create(),be=t.create(),ce=t.create();function ke(u,b,i){const l=i??new n(4),y=t.dot(u,b);return y<-.999999?(t.cross(be,u,qt),t.len(qt)<1e-6&&t.cross(ce,u,qt),t.normalize(qt,qt),x(qt,Math.PI,l),l):y>.999999?(l[0]=0,l[1]=0,l[2]=0,l[3]=1,l):(t.cross(u,b,qt),l[0]=qt[0],l[1]=qt[1],l[2]=qt[2],l[3]=1+y,ee(l,l))}const Wt=new n(4),me=new n(4);function fe(u,b,i,l,y,k){const V=k??new n(4);return Mt(u,l,y,Wt),Mt(b,i,y,me),Mt(Wt,me,2*y*(1-y),V),V}return{create:r,fromValues:f,set:_,fromAxisAngle:x,toAxisAngle:q,angle:R,multiply:Y,mul:W,rotateX:Q,rotateY:rt,rotateZ:it,slerp:Mt,inverse:Tt,conjugate:O,fromMat:et,fromEuler:wt,copy:kt,clone:At,add:It,subtract:Ut,sub:st,mulScalar:Gt,scale:gt,divScalar:le,dot:Ot,lerp:_e,length:pt,len:zt,lengthSq:ut,lenSq:we,normalize:ee,equalsApproximately:ge,equals:Xt,identity:ye,rotationTo:ke,sqlerp:fe}}const Ys=new Map;function Fu(n){let t=Ys.get(n);return t||(t=Nu(n),Ys.set(n,t)),t}function Lu(n){function t(i,l,y,k){const V=new n(4);return i!==void 0&&(V[0]=i,l!==void 0&&(V[1]=l,y!==void 0&&(V[2]=y,k!==void 0&&(V[3]=k)))),V}const r=t;function f(i,l,y,k,V){const e=V??new n(4);return e[0]=i,e[1]=l,e[2]=y,e[3]=k,e}function _(i,l){const y=l??new n(4);return y[0]=Math.ceil(i[0]),y[1]=Math.ceil(i[1]),y[2]=Math.ceil(i[2]),y[3]=Math.ceil(i[3]),y}function x(i,l){const y=l??new n(4);return y[0]=Math.floor(i[0]),y[1]=Math.floor(i[1]),y[2]=Math.floor(i[2]),y[3]=Math.floor(i[3]),y}function q(i,l){const y=l??new n(4);return y[0]=Math.round(i[0]),y[1]=Math.round(i[1]),y[2]=Math.round(i[2]),y[3]=Math.round(i[3]),y}function R(i,l=0,y=1,k){const V=k??new n(4);return V[0]=Math.min(y,Math.max(l,i[0])),V[1]=Math.min(y,Math.max(l,i[1])),V[2]=Math.min(y,Math.max(l,i[2])),V[3]=Math.min(y,Math.max(l,i[3])),V}function Y(i,l,y){const k=y??new n(4);return k[0]=i[0]+l[0],k[1]=i[1]+l[1],k[2]=i[2]+l[2],k[3]=i[3]+l[3],k}function W(i,l,y,k){const V=k??new n(4);return V[0]=i[0]+l[0]*y,V[1]=i[1]+l[1]*y,V[2]=i[2]+l[2]*y,V[3]=i[3]+l[3]*y,V}function Q(i,l,y){const k=y??new n(4);return k[0]=i[0]-l[0],k[1]=i[1]-l[1],k[2]=i[2]-l[2],k[3]=i[3]-l[3],k}const rt=Q;function it(i,l){return Math.abs(i[0]-l[0])<lt&&Math.abs(i[1]-l[1])<lt&&Math.abs(i[2]-l[2])<lt&&Math.abs(i[3]-l[3])<lt}function Mt(i,l){return i[0]===l[0]&&i[1]===l[1]&&i[2]===l[2]&&i[3]===l[3]}function Tt(i,l,y,k){const V=k??new n(4);return V[0]=i[0]+y*(l[0]-i[0]),V[1]=i[1]+y*(l[1]-i[1]),V[2]=i[2]+y*(l[2]-i[2]),V[3]=i[3]+y*(l[3]-i[3]),V}function O(i,l,y,k){const V=k??new n(4);return V[0]=i[0]+y[0]*(l[0]-i[0]),V[1]=i[1]+y[1]*(l[1]-i[1]),V[2]=i[2]+y[2]*(l[2]-i[2]),V[3]=i[3]+y[3]*(l[3]-i[3]),V}function et(i,l,y){const k=y??new n(4);return k[0]=Math.max(i[0],l[0]),k[1]=Math.max(i[1],l[1]),k[2]=Math.max(i[2],l[2]),k[3]=Math.max(i[3],l[3]),k}function wt(i,l,y){const k=y??new n(4);return k[0]=Math.min(i[0],l[0]),k[1]=Math.min(i[1],l[1]),k[2]=Math.min(i[2],l[2]),k[3]=Math.min(i[3],l[3]),k}function kt(i,l,y){const k=y??new n(4);return k[0]=i[0]*l,k[1]=i[1]*l,k[2]=i[2]*l,k[3]=i[3]*l,k}const At=kt;function It(i,l,y){const k=y??new n(4);return k[0]=i[0]/l,k[1]=i[1]/l,k[2]=i[2]/l,k[3]=i[3]/l,k}function Ut(i,l){const y=l??new n(4);return y[0]=1/i[0],y[1]=1/i[1],y[2]=1/i[2],y[3]=1/i[3],y}const st=Ut;function Gt(i,l){return i[0]*l[0]+i[1]*l[1]+i[2]*l[2]+i[3]*l[3]}function gt(i){const l=i[0],y=i[1],k=i[2],V=i[3];return Math.sqrt(l*l+y*y+k*k+V*V)}const le=gt;function Ot(i){const l=i[0],y=i[1],k=i[2],V=i[3];return l*l+y*y+k*k+V*V}const _e=Ot;function pt(i,l){const y=i[0]-l[0],k=i[1]-l[1],V=i[2]-l[2],e=i[3]-l[3];return Math.sqrt(y*y+k*k+V*V+e*e)}const zt=pt;function ut(i,l){const y=i[0]-l[0],k=i[1]-l[1],V=i[2]-l[2],e=i[3]-l[3];return y*y+k*k+V*V+e*e}const we=ut;function ee(i,l){const y=l??new n(4),k=i[0],V=i[1],e=i[2],d=i[3],a=Math.sqrt(k*k+V*V+e*e+d*d);return a>1e-5?(y[0]=k/a,y[1]=V/a,y[2]=e/a,y[3]=d/a):(y[0]=0,y[1]=0,y[2]=0,y[3]=0),y}function ge(i,l){const y=l??new n(4);return y[0]=-i[0],y[1]=-i[1],y[2]=-i[2],y[3]=-i[3],y}function Xt(i,l){const y=l??new n(4);return y[0]=i[0],y[1]=i[1],y[2]=i[2],y[3]=i[3],y}const ye=Xt;function qt(i,l,y){const k=y??new n(4);return k[0]=i[0]*l[0],k[1]=i[1]*l[1],k[2]=i[2]*l[2],k[3]=i[3]*l[3],k}const be=qt;function ce(i,l,y){const k=y??new n(4);return k[0]=i[0]/l[0],k[1]=i[1]/l[1],k[2]=i[2]/l[2],k[3]=i[3]/l[3],k}const ke=ce;function Wt(i){const l=i??new n(4);return l[0]=0,l[1]=0,l[2]=0,l[3]=0,l}function me(i,l,y){const k=y??new n(4),V=i[0],e=i[1],d=i[2],a=i[3];return k[0]=l[0]*V+l[4]*e+l[8]*d+l[12]*a,k[1]=l[1]*V+l[5]*e+l[9]*d+l[13]*a,k[2]=l[2]*V+l[6]*e+l[10]*d+l[14]*a,k[3]=l[3]*V+l[7]*e+l[11]*d+l[15]*a,k}function fe(i,l,y){const k=y??new n(4);return ee(i,k),kt(k,l,k)}function u(i,l,y){const k=y??new n(4);return gt(i)>l?fe(i,l,k):Xt(i,k)}function b(i,l,y){const k=y??new n(4);return Tt(i,l,.5,k)}return{create:t,fromValues:r,set:f,ceil:_,floor:x,round:q,clamp:R,add:Y,addScaled:W,subtract:Q,sub:rt,equalsApproximately:it,equals:Mt,lerp:Tt,lerpV:O,max:et,min:wt,mulScalar:kt,scale:At,divScalar:It,inverse:Ut,invert:st,dot:Gt,length:gt,len:le,lengthSq:Ot,lenSq:_e,distance:pt,dist:zt,distanceSq:ut,distSq:we,normalize:ee,negate:ge,copy:Xt,clone:ye,multiply:qt,mul:be,divide:ce,div:ke,zero:Wt,transformMat4:me,setLength:fe,truncate:u,midpoint:b}}const Xs=new Map;function Vu(n){let t=Xs.get(n);return t||(t=Lu(n),Xs.set(n,t)),t}function kr(n,t,r,f,_,x){return{mat3:$u(n),mat4:Iu(t),quat:Fu(r),vec2:ua(f),vec3:Un(_),vec4:Vu(x)}}const{mat3:tf,mat4:$e,quat:ef,vec2:nf,vec3:rf,vec4:sf}=kr(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array);kr(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array);kr(Tu,Array,Array,Array,Array,Array);const Pu=n=>t=>(...r)=>(...f)=>{const _=n(r,f);return t(..._)},Uu=n=>t=>(...r)=>(...f)=>t(...n(r,f));function Ou(n){return!Array.isArray(n)}function la(n){return Array.isArray(n)&&Ou(n[0])}function Bu(n){return Array.isArray(n)&&la(n[0])}const Ru=n=>t=>(...r)=>n(t(...r)),yn=n=>(...t)=>(...r)=>n(...t.map(f=>f(...r))),Pe={from(n){return n},full(n){return()=>n},zeros(){return Pe.full(0)},ones(){return Pe.full(1)},assign(n,t){return(...r)=>t(...r)??n(...r)},map:Ru,mapN:yn,mapIndices(n){return t=>(...r)=>t(...n(r))},mask(n){return t=>(...r)=>n(...r)?t(...r):void 0},curry:Pu(ou),partial:Uu(iu),getAxis(n){const t=cu(n);return r=>f=>Pe.partial(f)(...t(r))},add:yn(oa),sub:yn(ia),mul:yn(uu),div:yn(aa)},Gu={...Pe,fromEager(n){return()=>n},fromValue(n){return()=>n},toEager(n){return n}},fa={...Pe,fromEager(n){return t=>n==null?void 0:n[t]},fromValue(n){return la(n)?fa.fromEager(n):Gu.fromValue(n)},toEager(n){return t=>gr(r=>n(r),t)},iota(){return n=>n},unit(n){return t=>n==t?1:0},slices(n,t){return r=>n<=r&&r<t},reduce(n,t,r){return f=>{let _=r;for(let x of f)_=t(_,n(x));return _}}},ln={...Pe,fromEager(n){return(t,r)=>{var f;return(f=n==null?void 0:n[t])==null?void 0:f[r]}},fromValue(n){return Bu(n)?ln.fromEager(n):fa.fromValue(n)},toEager(n){return(t,r)=>gr(f=>gr(_=>n(f,_),t),r)},getRow:Pe.getAxis(0),getCol:Pe.getAxis(1),I(){return(n,t)=>n==t?1:0},t(n){return ln.assign(ln.I(),(t,r)=>t==0&&r>0?n(r-1):void 0)},s(n){return ln.assign(ln.I(),(t,r)=>t==r&&r>0?n(r-1):void 0)},ts(n,t){return(r,f)=>r==0&&f==0?1:r==0?n(f-1):r==f?t(f-1):0},st(n,t){return ln.I()}},ue={...$e,adapt(n,t){return t=t??$e.identity(),t[3*1+0*4]=n[0*1+3*4],t[1*1+0*4]=n[1*1+3*4],t[2*1+0*4]=n[2*1+3*4],t[0*1+0*4]=n[3*1+3*4],t[3*1+1*4]=n[0*1+1*4],t[1*1+1*4]=n[1*1+1*4],t[2*1+1*4]=n[2*1+1*4],t[0*1+1*4]=n[3*1+1*4],t[3*1+2*4]=n[0*1+2*4],t[1*1+2*4]=n[1*1+2*4],t[2*1+2*4]=n[2*1+2*4],t[0*1+2*4]=n[3*1+2*4],t[3*1+3*4]=n[0*1+0*4],t[1*1+3*4]=n[1*1+0*4],t[2*1+3*4]=n[2*1+0*4],t[0*1+3*4]=n[3*1+0*4],t},translation(n,t){return t=t??$e.identity(),t[1*1+0*4]=n[0],t[2*1+0*4]=n[1],t[3*1+0*4]=n[2],t},translate(n,t,r){return r=r??$e.identity(),r[1*1+0*4]=n[1*1+0*4]+t[0],r[2*1+0*4]=n[2*1+0*4]+t[1],r[3*1+0*4]=n[3*1+0*4]+t[2],r},scaling(n,t){return t=t??$e.identity(),t[1*1+1*4]=n[0],t[2*1+2*4]=n[1],t[3*1+3*4]=n[2],t},scale(n,t,r){return r=r??$e.identity(),r[1*1+1*4]=n[1*1+1*4]*t[0],r[2*1+2*4]=n[2*1+2*4]*t[1],r[3*1+3*4]=n[3*1+3*4]*t[2],r},ts(n,t,r){return r=r??ue.identity(),ue.translate(r,n,r),ue.scale(r,t,r),r},st(n,t,r){return r=r??ue.identity(),ue.scale(r,n,r),ue.translate(r,t,r),r},rotationX(n,t){const r=$e.rotationX(n);return ue.adapt(r,t)},rotationY(n,t){const r=$e.rotationY(n);return ue.adapt(r,t)},rotationZ(n,t){const r=$e.rotationZ(n);return ue.adapt(r,t)},rotateX(n,t,r){return ue.mul(n,ue.rotationX(t),r)},rotateY(n,t,r){return ue.mul(n,ue.rotationY(t),r)},rotateZ(n,t,r){return ue.mul(n,ue.rotationZ(t),r)}},af=n=>{const t=Us(xu(n[0],n[1]),2),r=Us(Mu(n[0],n[1]),2);return ue.st(r,t)},of=(n,t)=>{const r=n.__vccOpts||n;for(const[f,_]of t)r[f]=_;return r};async function Yu(n,t,r={},f={}){let _=null;const x=O=>{let et,wt,kt;return O.devicePixelContentBoxSize?(et=O.devicePixelContentBoxSize[0].inlineSize,wt=O.devicePixelContentBoxSize[0].blockSize,kt=1):(et=O.contentRect.width,wt=O.contentRect.height,kt=window.devicePixelRatio),[Math.round(et*kt),Math.round(wt*kt)]},q=(O,et)=>{const[wt,kt]=et,At=O.width!==wt||O.height!==kt;return At&&(O.width=wt,O.height=kt),At},{pause:R,resume:Y}=lu(O=>{var et;if(_){if(f.autoResize){const wt=n.value;q(wt,_.display)}(et=t.onRender)==null||et.call(t,{..._,...O})}},{immediate:!1});fu(n,O=>{var et;_&&(_.display=x(O[0]),(et=t.onResize)==null||et.call(t,{..._,entries:O}))});for(const[O,et]of Object.entries(r))hu(n,O,et);if(du(()=>{var O;Mt(),_&&((O=t.onCreate)==null||O.call(t,_),Y())}),pu(()=>{var O;_&&(R(),(O=t.onDelete)==null||O.call(t,_)),Tt()}),!navigator.gpu)return console.log("WebGPU not supported."),!1;const W=await navigator.gpu.requestAdapter();if(!W)return console.log("Invalid adapter."),!1;const{features:Q=[]}=f,rt=[];for(let O of Q)W.features.has(O)?rt.push(O):console.warn(`Requested feature not supported: "${O}".`);const it=await W.requestDevice({requiredFeatures:rt});if(!it)return console.log("Invalid device."),!1;const Mt=()=>{console.log("useWebGpu::initialize");const O=n.value;if(!O){console.log("Invalid canvas.");return}const et=O.getContext("webgpu");if(!et){console.log("Invalid context.");return}const wt=navigator.gpu.getPreferredCanvasFormat(),{alphaMode:kt}=f;et.configure({device:it,format:wt,alphaMode:kt});const{width:At,height:It}=O.getBoundingClientRect();_={adapter:W,device:it,context:et,format:wt,display:[At,It]}},Tt=()=>{console.log("useWebGpu::finalize"),_=null};return!0}const Xu=["width","height"],Wu={key:1,class:"flex items-center justify-center"},cf=_u({__name:"WebGpuCanvas",props:{renderer:{},options:{default:()=>({size:[1920,1080]})},listeners:{default:()=>({})}},async setup(n){let t,r;const f=n,_=Fs(()=>{var Y;return((Y=f.options.size)==null?void 0:Y[0])??1920}),x=Fs(()=>{var Y;return((Y=f.options.size)==null?void 0:Y[1])??1080}),q=Ls(),R=Ls(!0);return R.value=([t,r]=gu(()=>Yu(q,f.renderer,f.listeners,f.options)),t=await t,r(),t),(Y,W)=>R.value?(Vs(),Ps("canvas",{key:0,ref_key:"canvasRef",ref:q,class:"cursor-default",width:_.value,height:x.value,tabindex:"1"},null,8,Xu)):(Vs(),Ps("div",Wu,"WebGPU not supported."))}});var Zu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ha={exports:{}};/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */(function(n,t){(function(r,f){n.exports=f()})(Zu,function(){for(var r=function(s,o,h){return o===void 0&&(o=0),h===void 0&&(h=1),s<o?o:s>h?h:s},f=r,_=function(s){s._clipped=!1,s._unclipped=s.slice(0);for(var o=0;o<=3;o++)o<3?((s[o]<0||s[o]>255)&&(s._clipped=!0),s[o]=f(s[o],0,255)):o===3&&(s[o]=f(s[o],0,1));return s},x={},q=0,R=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];q<R.length;q+=1){var Y=R[q];x["[object "+Y+"]"]=Y.toLowerCase()}var W=function(s){return x[Object.prototype.toString.call(s)]||"object"},Q=W,rt=function(s,o){return o===void 0&&(o=null),s.length>=3?Array.prototype.slice.call(s):Q(s[0])=="object"&&o?o.split("").filter(function(h){return s[0][h]!==void 0}).map(function(h){return s[0][h]}):s[0]},it=W,Mt=function(s){if(s.length<2)return null;var o=s.length-1;return it(s[o])=="string"?s[o].toLowerCase():null},Tt=Math.PI,O={clip_rgb:_,limit:r,type:W,unpack:rt,last:Mt,PI:Tt,TWOPI:Tt*2,PITHIRD:Tt/3,DEG2RAD:Tt/180,RAD2DEG:180/Tt},et={format:{},autodetect:[]},wt=O.last,kt=O.clip_rgb,At=O.type,It=et,Ut=function(){for(var o=[],h=arguments.length;h--;)o[h]=arguments[h];var w=this;if(At(o[0])==="object"&&o[0].constructor&&o[0].constructor===this.constructor)return o[0];var A=wt(o),S=!1;if(!A){S=!0,It.sorted||(It.autodetect=It.autodetect.sort(function(X,j){return j.p-X.p}),It.sorted=!0);for(var M=0,I=It.autodetect;M<I.length;M+=1){var F=I[M];if(A=F.test.apply(F,o),A)break}}if(It.format[A]){var G=It.format[A].apply(null,S?o:o.slice(0,-1));w._rgb=kt(G)}else throw new Error("unknown format: "+o);w._rgb.length===3&&w._rgb.push(1)};Ut.prototype.toString=function(){return At(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var st=Ut,Gt=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Gt.Color,[null].concat(s)))};Gt.Color=st,Gt.version="2.4.2";var gt=Gt,le=O.unpack,Ot=Math.max,_e=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=le(s,"rgb"),w=h[0],A=h[1],S=h[2];w=w/255,A=A/255,S=S/255;var M=1-Ot(w,Ot(A,S)),I=M<1?1/(1-M):0,F=(1-w-M)*I,G=(1-A-M)*I,X=(1-S-M)*I;return[F,G,X,M]},pt=_e,zt=O.unpack,ut=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];s=zt(s,"cmyk");var h=s[0],w=s[1],A=s[2],S=s[3],M=s.length>4?s[4]:1;return S===1?[0,0,0,M]:[h>=1?0:255*(1-h)*(1-S),w>=1?0:255*(1-w)*(1-S),A>=1?0:255*(1-A)*(1-S),M]},we=ut,ee=gt,ge=st,Xt=et,ye=O.unpack,qt=O.type,be=pt;ge.prototype.cmyk=function(){return be(this._rgb)},ee.cmyk=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(ge,[null].concat(s,["cmyk"])))},Xt.format.cmyk=we,Xt.autodetect.push({p:2,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=ye(s,"cmyk"),qt(s)==="array"&&s.length===4)return"cmyk"}});var ce=O.unpack,ke=O.last,Wt=function(s){return Math.round(s*100)/100},me=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=ce(s,"hsla"),w=ke(s)||"lsa";return h[0]=Wt(h[0]||0),h[1]=Wt(h[1]*100)+"%",h[2]=Wt(h[2]*100)+"%",w==="hsla"||h.length>3&&h[3]<1?(h[3]=h.length>3?h[3]:1,w="hsla"):h.length=3,w+"("+h.join(",")+")"},fe=me,u=O.unpack,b=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];s=u(s,"rgba");var h=s[0],w=s[1],A=s[2];h/=255,w/=255,A/=255;var S=Math.min(h,w,A),M=Math.max(h,w,A),I=(M+S)/2,F,G;return M===S?(F=0,G=Number.NaN):F=I<.5?(M-S)/(M+S):(M-S)/(2-M-S),h==M?G=(w-A)/(M-S):w==M?G=2+(A-h)/(M-S):A==M&&(G=4+(h-w)/(M-S)),G*=60,G<0&&(G+=360),s.length>3&&s[3]!==void 0?[G,F,I,s[3]]:[G,F,I]},i=b,l=O.unpack,y=O.last,k=fe,V=i,e=Math.round,d=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=l(s,"rgba"),w=y(s)||"rgb";return w.substr(0,3)=="hsl"?k(V(h),w):(h[0]=e(h[0]),h[1]=e(h[1]),h[2]=e(h[2]),(w==="rgba"||h.length>3&&h[3]<1)&&(h[3]=h.length>3?h[3]:1,w="rgba"),w+"("+h.slice(0,w==="rgb"?3:4).join(",")+")")},a=d,c=O.unpack,m=Math.round,T=function(){for(var s,o=[],h=arguments.length;h--;)o[h]=arguments[h];o=c(o,"hsl");var w=o[0],A=o[1],S=o[2],M,I,F;if(A===0)M=I=F=S*255;else{var G=[0,0,0],X=[0,0,0],j=S<.5?S*(1+A):S+A-S*A,Z=2*S-j,K=w/360;G[0]=K+1/3,G[1]=K,G[2]=K-1/3;for(var J=0;J<3;J++)G[J]<0&&(G[J]+=1),G[J]>1&&(G[J]-=1),6*G[J]<1?X[J]=Z+(j-Z)*6*G[J]:2*G[J]<1?X[J]=j:3*G[J]<2?X[J]=Z+(j-Z)*(2/3-G[J])*6:X[J]=Z;s=[m(X[0]*255),m(X[1]*255),m(X[2]*255)],M=s[0],I=s[1],F=s[2]}return o.length>3?[M,I,F,o[3]]:[M,I,F,1]},P=T,p=P,v=et,E=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,z=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,L=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,U=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,B=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,tt=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,ot=Math.round,C=function(s){s=s.toLowerCase().trim();var o;if(v.format.named)try{return v.format.named(s)}catch{}if(o=s.match(E)){for(var h=o.slice(1,4),w=0;w<3;w++)h[w]=+h[w];return h[3]=1,h}if(o=s.match(z)){for(var A=o.slice(1,5),S=0;S<4;S++)A[S]=+A[S];return A}if(o=s.match(L)){for(var M=o.slice(1,4),I=0;I<3;I++)M[I]=ot(M[I]*2.55);return M[3]=1,M}if(o=s.match(U)){for(var F=o.slice(1,5),G=0;G<3;G++)F[G]=ot(F[G]*2.55);return F[3]=+F[3],F}if(o=s.match(B)){var X=o.slice(1,4);X[1]*=.01,X[2]*=.01;var j=p(X);return j[3]=1,j}if(o=s.match(tt)){var Z=o.slice(1,4);Z[1]*=.01,Z[2]*=.01;var K=p(Z);return K[3]=+o[4],K}};C.test=function(s){return E.test(s)||z.test(s)||L.test(s)||U.test(s)||B.test(s)||tt.test(s)};var nt=C,ct=gt,ft=st,Nt=et,Vt=O.type,Pt=a,Bt=nt;ft.prototype.css=function(s){return Pt(this._rgb,s)},ct.css=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(ft,[null].concat(s,["css"])))},Nt.format.css=Bt,Nt.autodetect.push({p:5,test:function(s){for(var o=[],h=arguments.length-1;h-- >0;)o[h]=arguments[h+1];if(!o.length&&Vt(s)==="string"&&Bt.test(s))return"css"}});var Yt=st,Zt=gt,Ht=et,jt=O.unpack;Ht.format.gl=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=jt(s,"rgba");return h[0]*=255,h[1]*=255,h[2]*=255,h},Zt.gl=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Yt,[null].concat(s,["gl"])))},Yt.prototype.gl=function(){var s=this._rgb;return[s[0]/255,s[1]/255,s[2]/255,s[3]]};var Qt=O.unpack,ne=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=Qt(s,"rgb"),w=h[0],A=h[1],S=h[2],M=Math.min(w,A,S),I=Math.max(w,A,S),F=I-M,G=F*100/255,X=M/(255-F)*100,j;return F===0?j=Number.NaN:(w===I&&(j=(A-S)/F),A===I&&(j=2+(S-w)/F),S===I&&(j=4+(w-A)/F),j*=60,j<0&&(j+=360)),[j,G,X]},re=ne,se=O.unpack,ae=Math.floor,he=function(){for(var s,o,h,w,A,S,M=[],I=arguments.length;I--;)M[I]=arguments[I];M=se(M,"hcg");var F=M[0],G=M[1],X=M[2],j,Z,K;X=X*255;var J=G*255;if(G===0)j=Z=K=X;else{F===360&&(F=0),F>360&&(F-=360),F<0&&(F+=360),F/=60;var ht=ae(F),mt=F-ht,yt=X*(1-G),Et=yt+J*(1-mt),oe=yt+J*mt,Ct=yt+J;switch(ht){case 0:s=[Ct,oe,yt],j=s[0],Z=s[1],K=s[2];break;case 1:o=[Et,Ct,yt],j=o[0],Z=o[1],K=o[2];break;case 2:h=[yt,Ct,oe],j=h[0],Z=h[1],K=h[2];break;case 3:w=[yt,Et,Ct],j=w[0],Z=w[1],K=w[2];break;case 4:A=[oe,yt,Ct],j=A[0],Z=A[1],K=A[2];break;case 5:S=[Ct,yt,Et],j=S[0],Z=S[1],K=S[2];break}}return[j,Z,K,M.length>3?M[3]:1]},de=he,pe=O.unpack,He=O.type,je=gt,Ue=st,Oe=et,Qe=re;Ue.prototype.hcg=function(){return Qe(this._rgb)},je.hcg=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Ue,[null].concat(s,["hcg"])))},Oe.format.hcg=de,Oe.autodetect.push({p:1,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=pe(s,"hcg"),He(s)==="array"&&s.length===3)return"hcg"}});var Je=O.unpack,Ke=O.last,Be=Math.round,Mn=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=Je(s,"rgba"),w=h[0],A=h[1],S=h[2],M=h[3],I=Ke(s)||"auto";M===void 0&&(M=1),I==="auto"&&(I=M<1?"rgba":"rgb"),w=Be(w),A=Be(A),S=Be(S);var F=w<<16|A<<8|S,G="000000"+F.toString(16);G=G.substr(G.length-6);var X="0"+Be(M*255).toString(16);switch(X=X.substr(X.length-2),I.toLowerCase()){case"rgba":return"#"+G+X;case"argb":return"#"+X+G;default:return"#"+G}},gn=Mn,An=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Jt=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,za=function(s){if(s.match(An)){(s.length===4||s.length===7)&&(s=s.substr(1)),s.length===3&&(s=s.split(""),s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]);var o=parseInt(s,16),h=o>>16,w=o>>8&255,A=o&255;return[h,w,A,1]}if(s.match(Jt)){(s.length===5||s.length===9)&&(s=s.substr(1)),s.length===4&&(s=s.split(""),s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]+s[3]+s[3]);var S=parseInt(s,16),M=S>>24&255,I=S>>16&255,F=S>>8&255,G=Math.round((S&255)/255*100)/100;return[M,I,F,G]}throw new Error("unknown hex color: "+s)},Er=za,Sa=gt,Tr=st,Da=O.type,zr=et,$a=gn;Tr.prototype.hex=function(s){return $a(this._rgb,s)},Sa.hex=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Tr,[null].concat(s,["hex"])))},zr.format.hex=Er,zr.autodetect.push({p:4,test:function(s){for(var o=[],h=arguments.length-1;h-- >0;)o[h]=arguments[h+1];if(!o.length&&Da(s)==="string"&&[3,4,5,6,7,8,9].indexOf(s.length)>=0)return"hex"}});var qa=O.unpack,Sr=O.TWOPI,Ia=Math.min,Na=Math.sqrt,Fa=Math.acos,La=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=qa(s,"rgb"),w=h[0],A=h[1],S=h[2];w/=255,A/=255,S/=255;var M,I=Ia(w,A,S),F=(w+A+S)/3,G=F>0?1-I/F:0;return G===0?M=NaN:(M=(w-A+(w-S))/2,M/=Na((w-A)*(w-A)+(w-S)*(A-S)),M=Fa(M),S>A&&(M=Sr-M),M/=Sr),[M*360,G,F]},Va=La,Pa=O.unpack,On=O.limit,Ce=O.TWOPI,Bn=O.PITHIRD,tn=Math.cos,Ua=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];s=Pa(s,"hsi");var h=s[0],w=s[1],A=s[2],S,M,I;return isNaN(h)&&(h=0),isNaN(w)&&(w=0),h>360&&(h-=360),h<0&&(h+=360),h/=360,h<1/3?(I=(1-w)/3,S=(1+w*tn(Ce*h)/tn(Bn-Ce*h))/3,M=1-(I+S)):h<2/3?(h-=1/3,S=(1-w)/3,M=(1+w*tn(Ce*h)/tn(Bn-Ce*h))/3,I=1-(S+M)):(h-=2/3,M=(1-w)/3,I=(1+w*tn(Ce*h)/tn(Bn-Ce*h))/3,S=1-(M+I)),S=On(A*S*3),M=On(A*M*3),I=On(A*I*3),[S*255,M*255,I*255,s.length>3?s[3]:1]},Oa=Ua,Ba=O.unpack,Ra=O.type,Ga=gt,Dr=st,$r=et,Ya=Va;Dr.prototype.hsi=function(){return Ya(this._rgb)},Ga.hsi=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Dr,[null].concat(s,["hsi"])))},$r.format.hsi=Oa,$r.autodetect.push({p:2,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=Ba(s,"hsi"),Ra(s)==="array"&&s.length===3)return"hsi"}});var Xa=O.unpack,Wa=O.type,Za=gt,qr=st,Ir=et,Ha=i;qr.prototype.hsl=function(){return Ha(this._rgb)},Za.hsl=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(qr,[null].concat(s,["hsl"])))},Ir.format.hsl=P,Ir.autodetect.push({p:2,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=Xa(s,"hsl"),Wa(s)==="array"&&s.length===3)return"hsl"}});var ja=O.unpack,Qa=Math.min,Ja=Math.max,Ka=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];s=ja(s,"rgb");var h=s[0],w=s[1],A=s[2],S=Qa(h,w,A),M=Ja(h,w,A),I=M-S,F,G,X;return X=M/255,M===0?(F=Number.NaN,G=0):(G=I/M,h===M&&(F=(w-A)/I),w===M&&(F=2+(A-h)/I),A===M&&(F=4+(h-w)/I),F*=60,F<0&&(F+=360)),[F,G,X]},Ca=Ka,to=O.unpack,eo=Math.floor,no=function(){for(var s,o,h,w,A,S,M=[],I=arguments.length;I--;)M[I]=arguments[I];M=to(M,"hsv");var F=M[0],G=M[1],X=M[2],j,Z,K;if(X*=255,G===0)j=Z=K=X;else{F===360&&(F=0),F>360&&(F-=360),F<0&&(F+=360),F/=60;var J=eo(F),ht=F-J,mt=X*(1-G),yt=X*(1-G*ht),Et=X*(1-G*(1-ht));switch(J){case 0:s=[X,Et,mt],j=s[0],Z=s[1],K=s[2];break;case 1:o=[yt,X,mt],j=o[0],Z=o[1],K=o[2];break;case 2:h=[mt,X,Et],j=h[0],Z=h[1],K=h[2];break;case 3:w=[mt,yt,X],j=w[0],Z=w[1],K=w[2];break;case 4:A=[Et,mt,X],j=A[0],Z=A[1],K=A[2];break;case 5:S=[X,mt,yt],j=S[0],Z=S[1],K=S[2];break}}return[j,Z,K,M.length>3?M[3]:1]},ro=no,so=O.unpack,ao=O.type,oo=gt,Nr=st,Fr=et,io=Ca;Nr.prototype.hsv=function(){return io(this._rgb)},oo.hsv=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Nr,[null].concat(s,["hsv"])))},Fr.format.hsv=ro,Fr.autodetect.push({p:2,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=so(s,"hsv"),ao(s)==="array"&&s.length===3)return"hsv"}});var En={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},en=En,co=O.unpack,Lr=Math.pow,uo=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=co(s,"rgb"),w=h[0],A=h[1],S=h[2],M=lo(w,A,S),I=M[0],F=M[1],G=M[2],X=116*F-16;return[X<0?0:X,500*(I-F),200*(F-G)]},Rn=function(s){return(s/=255)<=.04045?s/12.92:Lr((s+.055)/1.055,2.4)},Gn=function(s){return s>en.t3?Lr(s,1/3):s/en.t2+en.t0},lo=function(s,o,h){s=Rn(s),o=Rn(o),h=Rn(h);var w=Gn((.4124564*s+.3575761*o+.1804375*h)/en.Xn),A=Gn((.2126729*s+.7151522*o+.072175*h)/en.Yn),S=Gn((.0193339*s+.119192*o+.9503041*h)/en.Zn);return[w,A,S]},Vr=uo,nn=En,fo=O.unpack,ho=Math.pow,po=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];s=fo(s,"lab");var h=s[0],w=s[1],A=s[2],S,M,I,F,G,X;return M=(h+16)/116,S=isNaN(w)?M:M+w/500,I=isNaN(A)?M:M-A/200,M=nn.Yn*Xn(M),S=nn.Xn*Xn(S),I=nn.Zn*Xn(I),F=Yn(3.2404542*S-1.5371385*M-.4985314*I),G=Yn(-.969266*S+1.8760108*M+.041556*I),X=Yn(.0556434*S-.2040259*M+1.0572252*I),[F,G,X,s.length>3?s[3]:1]},Yn=function(s){return 255*(s<=.00304?12.92*s:1.055*ho(s,1/2.4)-.055)},Xn=function(s){return s>nn.t1?s*s*s:nn.t2*(s-nn.t0)},Pr=po,_o=O.unpack,go=O.type,mo=gt,Ur=st,Or=et,vo=Vr;Ur.prototype.lab=function(){return vo(this._rgb)},mo.lab=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Ur,[null].concat(s,["lab"])))},Or.format.lab=Pr,Or.autodetect.push({p:2,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=_o(s,"lab"),go(s)==="array"&&s.length===3)return"lab"}});var wo=O.unpack,yo=O.RAD2DEG,bo=Math.sqrt,ko=Math.atan2,xo=Math.round,Mo=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=wo(s,"lab"),w=h[0],A=h[1],S=h[2],M=bo(A*A+S*S),I=(ko(S,A)*yo+360)%360;return xo(M*1e4)===0&&(I=Number.NaN),[w,M,I]},Br=Mo,Ao=O.unpack,Eo=Vr,To=Br,zo=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=Ao(s,"rgb"),w=h[0],A=h[1],S=h[2],M=Eo(w,A,S),I=M[0],F=M[1],G=M[2];return To(I,F,G)},So=zo,Do=O.unpack,$o=O.DEG2RAD,qo=Math.sin,Io=Math.cos,No=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=Do(s,"lch"),w=h[0],A=h[1],S=h[2];return isNaN(S)&&(S=0),S=S*$o,[w,Io(S)*A,qo(S)*A]},Rr=No,Fo=O.unpack,Lo=Rr,Vo=Pr,Po=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];s=Fo(s,"lch");var h=s[0],w=s[1],A=s[2],S=Lo(h,w,A),M=S[0],I=S[1],F=S[2],G=Vo(M,I,F),X=G[0],j=G[1],Z=G[2];return[X,j,Z,s.length>3?s[3]:1]},Gr=Po,Uo=O.unpack,Oo=Gr,Bo=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=Uo(s,"hcl").reverse();return Oo.apply(void 0,h)},Ro=Bo,Go=O.unpack,Yo=O.type,Yr=gt,Tn=st,Wn=et,Xr=So;Tn.prototype.lch=function(){return Xr(this._rgb)},Tn.prototype.hcl=function(){return Xr(this._rgb).reverse()},Yr.lch=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Tn,[null].concat(s,["lch"])))},Yr.hcl=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Tn,[null].concat(s,["hcl"])))},Wn.format.lch=Gr,Wn.format.hcl=Ro,["lch","hcl"].forEach(function(s){return Wn.autodetect.push({p:2,test:function(){for(var o=[],h=arguments.length;h--;)o[h]=arguments[h];if(o=Go(o,s),Yo(o)==="array"&&o.length===3)return s}})});var Xo={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Wr=Xo,Wo=st,Zr=et,Zo=O.type,mn=Wr,Ho=Er,jo=gn;Wo.prototype.name=function(){for(var s=jo(this._rgb,"rgb"),o=0,h=Object.keys(mn);o<h.length;o+=1){var w=h[o];if(mn[w]===s)return w.toLowerCase()}return s},Zr.format.named=function(s){if(s=s.toLowerCase(),mn[s])return Ho(mn[s]);throw new Error("unknown color name: "+s)},Zr.autodetect.push({p:5,test:function(s){for(var o=[],h=arguments.length-1;h-- >0;)o[h]=arguments[h+1];if(!o.length&&Zo(s)==="string"&&mn[s.toLowerCase()])return"named"}});var Qo=O.unpack,Jo=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=Qo(s,"rgb"),w=h[0],A=h[1],S=h[2];return(w<<16)+(A<<8)+S},Ko=Jo,Co=O.type,ti=function(s){if(Co(s)=="number"&&s>=0&&s<=16777215){var o=s>>16,h=s>>8&255,w=s&255;return[o,h,w,1]}throw new Error("unknown num color: "+s)},ei=ti,ni=gt,Hr=st,jr=et,ri=O.type,si=Ko;Hr.prototype.num=function(){return si(this._rgb)},ni.num=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Hr,[null].concat(s,["num"])))},jr.format.num=ei,jr.autodetect.push({p:5,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s.length===1&&ri(s[0])==="number"&&s[0]>=0&&s[0]<=16777215)return"num"}});var ai=gt,Zn=st,Qr=et,Jr=O.unpack,Kr=O.type,Cr=Math.round;Zn.prototype.rgb=function(s){return s===void 0&&(s=!0),s===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Cr)},Zn.prototype.rgba=function(s){return s===void 0&&(s=!0),this._rgb.slice(0,4).map(function(o,h){return h<3?s===!1?o:Cr(o):o})},ai.rgb=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Zn,[null].concat(s,["rgb"])))},Qr.format.rgb=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=Jr(s,"rgba");return h[3]===void 0&&(h[3]=1),h},Qr.autodetect.push({p:3,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=Jr(s,"rgba"),Kr(s)==="array"&&(s.length===3||s.length===4&&Kr(s[3])=="number"&&s[3]>=0&&s[3]<=1))return"rgb"}});var zn=Math.log,oi=function(s){var o=s/100,h,w,A;return o<66?(h=255,w=o<6?0:-155.25485562709179-.44596950469579133*(w=o-2)+104.49216199393888*zn(w),A=o<20?0:-254.76935184120902+.8274096064007395*(A=o-10)+115.67994401066147*zn(A)):(h=351.97690566805693+.114206453784165*(h=o-55)-40.25366309332127*zn(h),w=325.4494125711974+.07943456536662342*(w=o-50)-28.0852963507957*zn(w),A=255),[h,w,A,1]},ts=oi,ii=ts,ci=O.unpack,ui=Math.round,li=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];for(var h=ci(s,"rgb"),w=h[0],A=h[2],S=1e3,M=4e4,I=.4,F;M-S>I;){F=(M+S)*.5;var G=ii(F);G[2]/G[0]>=A/w?M=F:S=F}return ui(F)},fi=li,Hn=gt,Sn=st,jn=et,hi=fi;Sn.prototype.temp=Sn.prototype.kelvin=Sn.prototype.temperature=function(){return hi(this._rgb)},Hn.temp=Hn.kelvin=Hn.temperature=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(Sn,[null].concat(s,["temp"])))},jn.format.temp=jn.format.kelvin=jn.format.temperature=ts;var di=O.unpack,Qn=Math.cbrt,pi=Math.pow,_i=Math.sign,gi=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=di(s,"rgb"),w=h[0],A=h[1],S=h[2],M=[Jn(w/255),Jn(A/255),Jn(S/255)],I=M[0],F=M[1],G=M[2],X=Qn(.4122214708*I+.5363325363*F+.0514459929*G),j=Qn(.2119034982*I+.6806995451*F+.1073969566*G),Z=Qn(.0883024619*I+.2817188376*F+.6299787005*G);return[.2104542553*X+.793617785*j-.0040720468*Z,1.9779984951*X-2.428592205*j+.4505937099*Z,.0259040371*X+.7827717662*j-.808675766*Z]},es=gi;function Jn(s){var o=Math.abs(s);return o<.04045?s/12.92:(_i(s)||1)*pi((o+.055)/1.055,2.4)}var mi=O.unpack,Dn=Math.pow,vi=Math.sign,wi=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];s=mi(s,"lab");var h=s[0],w=s[1],A=s[2],S=Dn(h+.3963377774*w+.2158037573*A,3),M=Dn(h-.1055613458*w-.0638541728*A,3),I=Dn(h-.0894841775*w-1.291485548*A,3);return[255*Kn(4.0767416621*S-3.3077115913*M+.2309699292*I),255*Kn(-1.2684380046*S+2.6097574011*M-.3413193965*I),255*Kn(-.0041960863*S-.7034186147*M+1.707614701*I),s.length>3?s[3]:1]},ns=wi;function Kn(s){var o=Math.abs(s);return o>.0031308?(vi(s)||1)*(1.055*Dn(o,1/2.4)-.055):s*12.92}var yi=O.unpack,bi=O.type,ki=gt,rs=st,ss=et,xi=es;rs.prototype.oklab=function(){return xi(this._rgb)},ki.oklab=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(rs,[null].concat(s,["oklab"])))},ss.format.oklab=ns,ss.autodetect.push({p:3,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=yi(s,"oklab"),bi(s)==="array"&&s.length===3)return"oklab"}});var Mi=O.unpack,Ai=es,Ei=Br,Ti=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=Mi(s,"rgb"),w=h[0],A=h[1],S=h[2],M=Ai(w,A,S),I=M[0],F=M[1],G=M[2];return Ei(I,F,G)},zi=Ti,Si=O.unpack,Di=Rr,$i=ns,qi=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];s=Si(s,"lch");var h=s[0],w=s[1],A=s[2],S=Di(h,w,A),M=S[0],I=S[1],F=S[2],G=$i(M,I,F),X=G[0],j=G[1],Z=G[2];return[X,j,Z,s.length>3?s[3]:1]},Ii=qi,Ni=O.unpack,Fi=O.type,Li=gt,as=st,os=et,Vi=zi;as.prototype.oklch=function(){return Vi(this._rgb)},Li.oklch=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];return new(Function.prototype.bind.apply(as,[null].concat(s,["oklch"])))},os.format.oklch=Ii,os.autodetect.push({p:3,test:function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];if(s=Ni(s,"oklch"),Fi(s)==="array"&&s.length===3)return"oklch"}});var is=st,Pi=O.type;is.prototype.alpha=function(s,o){return o===void 0&&(o=!1),s!==void 0&&Pi(s)==="number"?o?(this._rgb[3]=s,this):new is([this._rgb[0],this._rgb[1],this._rgb[2],s],"rgb"):this._rgb[3]};var Ui=st;Ui.prototype.clipped=function(){return this._rgb._clipped||!1};var Re=st,Oi=En;Re.prototype.darken=function(s){s===void 0&&(s=1);var o=this,h=o.lab();return h[0]-=Oi.Kn*s,new Re(h,"lab").alpha(o.alpha(),!0)},Re.prototype.brighten=function(s){return s===void 0&&(s=1),this.darken(-s)},Re.prototype.darker=Re.prototype.darken,Re.prototype.brighter=Re.prototype.brighten;var Bi=st;Bi.prototype.get=function(s){var o=s.split("."),h=o[0],w=o[1],A=this[h]();if(w){var S=h.indexOf(w)-(h.substr(0,2)==="ok"?2:0);if(S>-1)return A[S];throw new Error("unknown channel "+w+" in mode "+h)}else return A};var rn=st,Ri=O.type,Gi=Math.pow,Yi=1e-7,Xi=20;rn.prototype.luminance=function(s){if(s!==void 0&&Ri(s)==="number"){if(s===0)return new rn([0,0,0,this._rgb[3]],"rgb");if(s===1)return new rn([255,255,255,this._rgb[3]],"rgb");var o=this.luminance(),h="rgb",w=Xi,A=function(M,I){var F=M.interpolate(I,.5,h),G=F.luminance();return Math.abs(s-G)<Yi||!w--?F:G>s?A(M,F):A(F,I)},S=(o>s?A(new rn([0,0,0]),this):A(this,new rn([255,255,255]))).rgb();return new rn(S.concat([this._rgb[3]]))}return Wi.apply(void 0,this._rgb.slice(0,3))};var Wi=function(s,o,h){return s=Cn(s),o=Cn(o),h=Cn(h),.2126*s+.7152*o+.0722*h},Cn=function(s){return s/=255,s<=.03928?s/12.92:Gi((s+.055)/1.055,2.4)},xe={},cs=st,us=O.type,$n=xe,ls=function(s,o,h){h===void 0&&(h=.5);for(var w=[],A=arguments.length-3;A-- >0;)w[A]=arguments[A+3];var S=w[0]||"lrgb";if(!$n[S]&&!w.length&&(S=Object.keys($n)[0]),!$n[S])throw new Error("interpolation mode "+S+" is not defined");return us(s)!=="object"&&(s=new cs(s)),us(o)!=="object"&&(o=new cs(o)),$n[S](s,o,h).alpha(s.alpha()+h*(o.alpha()-s.alpha()))},fs=st,Zi=ls;fs.prototype.mix=fs.prototype.interpolate=function(s,o){o===void 0&&(o=.5);for(var h=[],w=arguments.length-2;w-- >0;)h[w]=arguments[w+2];return Zi.apply(void 0,[this,s,o].concat(h))};var hs=st;hs.prototype.premultiply=function(s){s===void 0&&(s=!1);var o=this._rgb,h=o[3];return s?(this._rgb=[o[0]*h,o[1]*h,o[2]*h,h],this):new hs([o[0]*h,o[1]*h,o[2]*h,h],"rgb")};var tr=st,Hi=En;tr.prototype.saturate=function(s){s===void 0&&(s=1);var o=this,h=o.lch();return h[1]+=Hi.Kn*s,h[1]<0&&(h[1]=0),new tr(h,"lch").alpha(o.alpha(),!0)},tr.prototype.desaturate=function(s){return s===void 0&&(s=1),this.saturate(-s)};var ds=st,ps=O.type;ds.prototype.set=function(s,o,h){h===void 0&&(h=!1);var w=s.split("."),A=w[0],S=w[1],M=this[A]();if(S){var I=A.indexOf(S)-(A.substr(0,2)==="ok"?2:0);if(I>-1){if(ps(o)=="string")switch(o.charAt(0)){case"+":M[I]+=+o;break;case"-":M[I]+=+o;break;case"*":M[I]*=+o.substr(1);break;case"/":M[I]/=+o.substr(1);break;default:M[I]=+o}else if(ps(o)==="number")M[I]=o;else throw new Error("unsupported value for Color.set");var F=new ds(M,A);return h?(this._rgb=F._rgb,this):F}throw new Error("unknown channel "+S+" in mode "+A)}else return M};var ji=st,Qi=function(s,o,h){var w=s._rgb,A=o._rgb;return new ji(w[0]+h*(A[0]-w[0]),w[1]+h*(A[1]-w[1]),w[2]+h*(A[2]-w[2]),"rgb")};xe.rgb=Qi;var Ji=st,er=Math.sqrt,sn=Math.pow,Ki=function(s,o,h){var w=s._rgb,A=w[0],S=w[1],M=w[2],I=o._rgb,F=I[0],G=I[1],X=I[2];return new Ji(er(sn(A,2)*(1-h)+sn(F,2)*h),er(sn(S,2)*(1-h)+sn(G,2)*h),er(sn(M,2)*(1-h)+sn(X,2)*h),"rgb")};xe.lrgb=Ki;var Ci=st,tc=function(s,o,h){var w=s.lab(),A=o.lab();return new Ci(w[0]+h*(A[0]-w[0]),w[1]+h*(A[1]-w[1]),w[2]+h*(A[2]-w[2]),"lab")};xe.lab=tc;var _s=st,an=function(s,o,h,w){var A,S,M,I;w==="hsl"?(M=s.hsl(),I=o.hsl()):w==="hsv"?(M=s.hsv(),I=o.hsv()):w==="hcg"?(M=s.hcg(),I=o.hcg()):w==="hsi"?(M=s.hsi(),I=o.hsi()):w==="lch"||w==="hcl"?(w="hcl",M=s.hcl(),I=o.hcl()):w==="oklch"&&(M=s.oklch().reverse(),I=o.oklch().reverse());var F,G,X,j,Z,K;(w.substr(0,1)==="h"||w==="oklch")&&(A=M,F=A[0],X=A[1],Z=A[2],S=I,G=S[0],j=S[1],K=S[2]);var J,ht,mt,yt;return!isNaN(F)&&!isNaN(G)?(G>F&&G-F>180?yt=G-(F+360):G<F&&F-G>180?yt=G+360-F:yt=G-F,ht=F+h*yt):isNaN(F)?isNaN(G)?ht=Number.NaN:(ht=G,(Z==1||Z==0)&&w!="hsv"&&(J=j)):(ht=F,(K==1||K==0)&&w!="hsv"&&(J=X)),J===void 0&&(J=X+h*(j-X)),mt=Z+h*(K-Z),w==="oklch"?new _s([mt,J,ht],w):new _s([ht,J,mt],w)},ec=an,gs=function(s,o,h){return ec(s,o,h,"lch")};xe.lch=gs,xe.hcl=gs;var nc=st,rc=function(s,o,h){var w=s.num(),A=o.num();return new nc(w+h*(A-w),"num")};xe.num=rc;var sc=an,ac=function(s,o,h){return sc(s,o,h,"hcg")};xe.hcg=ac;var oc=an,ic=function(s,o,h){return oc(s,o,h,"hsi")};xe.hsi=ic;var cc=an,uc=function(s,o,h){return cc(s,o,h,"hsl")};xe.hsl=uc;var lc=an,fc=function(s,o,h){return lc(s,o,h,"hsv")};xe.hsv=fc;var hc=st,dc=function(s,o,h){var w=s.oklab(),A=o.oklab();return new hc(w[0]+h*(A[0]-w[0]),w[1]+h*(A[1]-w[1]),w[2]+h*(A[2]-w[2]),"oklab")};xe.oklab=dc;var pc=an,_c=function(s,o,h){return pc(s,o,h,"oklch")};xe.oklch=_c;var nr=st,gc=O.clip_rgb,rr=Math.pow,sr=Math.sqrt,ar=Math.PI,ms=Math.cos,vs=Math.sin,mc=Math.atan2,vc=function(s,o,h){o===void 0&&(o="lrgb"),h===void 0&&(h=null);var w=s.length;h||(h=Array.from(new Array(w)).map(function(){return 1}));var A=w/h.reduce(function(ht,mt){return ht+mt});if(h.forEach(function(ht,mt){h[mt]*=A}),s=s.map(function(ht){return new nr(ht)}),o==="lrgb")return wc(s,h);for(var S=s.shift(),M=S.get(o),I=[],F=0,G=0,X=0;X<M.length;X++)if(M[X]=(M[X]||0)*h[0],I.push(isNaN(M[X])?0:h[0]),o.charAt(X)==="h"&&!isNaN(M[X])){var j=M[X]/180*ar;F+=ms(j)*h[0],G+=vs(j)*h[0]}var Z=S.alpha()*h[0];s.forEach(function(ht,mt){var yt=ht.get(o);Z+=ht.alpha()*h[mt+1];for(var Et=0;Et<M.length;Et++)if(!isNaN(yt[Et]))if(I[Et]+=h[mt+1],o.charAt(Et)==="h"){var oe=yt[Et]/180*ar;F+=ms(oe)*h[mt+1],G+=vs(oe)*h[mt+1]}else M[Et]+=yt[Et]*h[mt+1]});for(var K=0;K<M.length;K++)if(o.charAt(K)==="h"){for(var J=mc(G/I[K],F/I[K])/ar*180;J<0;)J+=360;for(;J>=360;)J-=360;M[K]=J}else M[K]=M[K]/I[K];return Z/=w,new nr(M,o).alpha(Z>.99999?1:Z,!0)},wc=function(s,o){for(var h=s.length,w=[0,0,0,0],A=0;A<s.length;A++){var S=s[A],M=o[A]/h,I=S._rgb;w[0]+=rr(I[0],2)*M,w[1]+=rr(I[1],2)*M,w[2]+=rr(I[2],2)*M,w[3]+=I[3]*M}return w[0]=sr(w[0]),w[1]=sr(w[1]),w[2]=sr(w[2]),w[3]>.9999999&&(w[3]=1),new nr(gc(w))},Me=gt,on=O.type,yc=Math.pow,or=function(s){var o="rgb",h=Me("#ccc"),w=0,A=[0,1],S=[],M=[0,0],I=!1,F=[],G=!1,X=0,j=1,Z=!1,K={},J=!0,ht=1,mt=function(H){if(H=H||["#fff","#000"],H&&on(H)==="string"&&Me.brewer&&Me.brewer[H.toLowerCase()]&&(H=Me.brewer[H.toLowerCase()]),on(H)==="array"){H.length===1&&(H=[H[0],H[0]]),H=H.slice(0);for(var at=0;at<H.length;at++)H[at]=Me(H[at]);S.length=0;for(var _t=0;_t<H.length;_t++)S.push(_t/(H.length-1))}return ve(),F=H},yt=function(H){if(I!=null){for(var at=I.length-1,_t=0;_t<at&&H>=I[_t];)_t++;return _t-1}return 0},Et=function(H){return H},oe=function(H){return H},Ct=function(H,at){var _t,dt;if(at==null&&(at=!1),isNaN(H)||H===null)return h;if(at)dt=H;else if(I&&I.length>2){var ie=yt(H);dt=ie/(I.length-2)}else j!==X?dt=(H-X)/(j-X):dt=1;dt=oe(dt),at||(dt=Et(dt)),ht!==1&&(dt=yc(dt,ht)),dt=M[0]+dt*(1-M[0]-M[1]),dt=Math.min(1,Math.max(0,dt));var Ft=Math.floor(dt*1e4);if(J&&K[Ft])_t=K[Ft];else{if(on(F)==="array")for(var bt=0;bt<S.length;bt++){var St=S[bt];if(dt<=St){_t=F[bt];break}if(dt>=St&&bt===S.length-1){_t=F[bt];break}if(dt>St&&dt<S[bt+1]){dt=(dt-St)/(S[bt+1]-St),_t=Me.interpolate(F[bt],F[bt+1],dt,o);break}}else on(F)==="function"&&(_t=F(dt));J&&(K[Ft]=_t)}return _t},ve=function(){return K={}};mt(s);var vt=function(H){var at=Me(Ct(H));return G&&at[G]?at[G]():at};return vt.classes=function(H){if(H!=null){if(on(H)==="array")I=H,A=[H[0],H[H.length-1]];else{var at=Me.analyze(A);H===0?I=[at.min,at.max]:I=Me.limits(at,"e",H)}return vt}return I},vt.domain=function(H){if(!arguments.length)return A;X=H[0],j=H[H.length-1],S=[];var at=F.length;if(H.length===at&&X!==j)for(var _t=0,dt=Array.from(H);_t<dt.length;_t+=1){var ie=dt[_t];S.push((ie-X)/(j-X))}else{for(var Ft=0;Ft<at;Ft++)S.push(Ft/(at-1));if(H.length>2){var bt=H.map(function(Dt,$t){return $t/(H.length-1)}),St=H.map(function(Dt){return(Dt-X)/(j-X)});St.every(function(Dt,$t){return bt[$t]===Dt})||(oe=function(Dt){if(Dt<=0||Dt>=1)return Dt;for(var $t=0;Dt>=St[$t+1];)$t++;var Ee=(Dt-St[$t])/(St[$t+1]-St[$t]),Le=bt[$t]+Ee*(bt[$t+1]-bt[$t]);return Le})}}return A=[X,j],vt},vt.mode=function(H){return arguments.length?(o=H,ve(),vt):o},vt.range=function(H,at){return mt(H),vt},vt.out=function(H){return G=H,vt},vt.spread=function(H){return arguments.length?(w=H,vt):w},vt.correctLightness=function(H){return H==null&&(H=!0),Z=H,ve(),Z?Et=function(at){for(var _t=Ct(0,!0).lab()[0],dt=Ct(1,!0).lab()[0],ie=_t>dt,Ft=Ct(at,!0).lab()[0],bt=_t+(dt-_t)*at,St=Ft-bt,Dt=0,$t=1,Ee=20;Math.abs(St)>.01&&Ee-- >0;)(function(){return ie&&(St*=-1),St<0?(Dt=at,at+=($t-at)*.5):($t=at,at+=(Dt-at)*.5),Ft=Ct(at,!0).lab()[0],St=Ft-bt})();return at}:Et=function(at){return at},vt},vt.padding=function(H){return H!=null?(on(H)==="number"&&(H=[H,H]),M=H,vt):M},vt.colors=function(H,at){arguments.length<2&&(at="hex");var _t=[];if(arguments.length===0)_t=F.slice(0);else if(H===1)_t=[vt(.5)];else if(H>1){var dt=A[0],ie=A[1]-dt;_t=bc(0,H).map(function($t){return vt(dt+$t/(H-1)*ie)})}else{s=[];var Ft=[];if(I&&I.length>2)for(var bt=1,St=I.length,Dt=1<=St;Dt?bt<St:bt>St;Dt?bt++:bt--)Ft.push((I[bt-1]+I[bt])*.5);else Ft=A;_t=Ft.map(function($t){return vt($t)})}return Me[at]&&(_t=_t.map(function($t){return $t[at]()})),_t},vt.cache=function(H){return H!=null?(J=H,vt):J},vt.gamma=function(H){return H!=null?(ht=H,vt):ht},vt.nodata=function(H){return H!=null?(h=Me(H),vt):h},vt};function bc(s,o,h){for(var w=[],A=s<o,S=o,M=s;A?M<S:M>S;A?M++:M--)w.push(M);return w}var vn=st,kc=or,xc=function(s){for(var o=[1,1],h=1;h<s;h++){for(var w=[1],A=1;A<=o.length;A++)w[A]=(o[A]||0)+o[A-1];o=w}return o},Mc=function(s){var o,h,w,A,S,M,I;if(s=s.map(function(Z){return new vn(Z)}),s.length===2)o=s.map(function(Z){return Z.lab()}),S=o[0],M=o[1],A=function(Z){var K=[0,1,2].map(function(J){return S[J]+Z*(M[J]-S[J])});return new vn(K,"lab")};else if(s.length===3)h=s.map(function(Z){return Z.lab()}),S=h[0],M=h[1],I=h[2],A=function(Z){var K=[0,1,2].map(function(J){return(1-Z)*(1-Z)*S[J]+2*(1-Z)*Z*M[J]+Z*Z*I[J]});return new vn(K,"lab")};else if(s.length===4){var F;w=s.map(function(Z){return Z.lab()}),S=w[0],M=w[1],I=w[2],F=w[3],A=function(Z){var K=[0,1,2].map(function(J){return(1-Z)*(1-Z)*(1-Z)*S[J]+3*(1-Z)*(1-Z)*Z*M[J]+3*(1-Z)*Z*Z*I[J]+Z*Z*Z*F[J]});return new vn(K,"lab")}}else if(s.length>=5){var G,X,j;G=s.map(function(Z){return Z.lab()}),j=s.length-1,X=xc(j),A=function(Z){var K=1-Z,J=[0,1,2].map(function(ht){return G.reduce(function(mt,yt,Et){return mt+X[Et]*Math.pow(K,j-Et)*Math.pow(Z,Et)*yt[ht]},0)});return new vn(J,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return A},Ac=function(s){var o=Mc(s);return o.scale=function(){return kc(o)},o},ir=gt,Ae=function(s,o,h){if(!Ae[h])throw new Error("unknown blend mode "+h);return Ae[h](s,o)},Ne=function(s){return function(o,h){var w=ir(h).rgb(),A=ir(o).rgb();return ir.rgb(s(w,A))}},Fe=function(s){return function(o,h){var w=[];return w[0]=s(o[0],h[0]),w[1]=s(o[1],h[1]),w[2]=s(o[2],h[2]),w}},Ec=function(s){return s},Tc=function(s,o){return s*o/255},zc=function(s,o){return s>o?o:s},Sc=function(s,o){return s>o?s:o},Dc=function(s,o){return 255*(1-(1-s/255)*(1-o/255))},$c=function(s,o){return o<128?2*s*o/255:255*(1-2*(1-s/255)*(1-o/255))},qc=function(s,o){return 255*(1-(1-o/255)/(s/255))},Ic=function(s,o){return s===255?255:(s=255*(o/255)/(1-s/255),s>255?255:s)};Ae.normal=Ne(Fe(Ec)),Ae.multiply=Ne(Fe(Tc)),Ae.screen=Ne(Fe(Dc)),Ae.overlay=Ne(Fe($c)),Ae.darken=Ne(Fe(zc)),Ae.lighten=Ne(Fe(Sc)),Ae.dodge=Ne(Fe(Ic)),Ae.burn=Ne(Fe(qc));for(var Nc=Ae,cr=O.type,Fc=O.clip_rgb,Lc=O.TWOPI,Vc=Math.pow,Pc=Math.sin,Uc=Math.cos,ws=gt,Oc=function(s,o,h,w,A){s===void 0&&(s=300),o===void 0&&(o=-1.5),h===void 0&&(h=1),w===void 0&&(w=1),A===void 0&&(A=[0,1]);var S=0,M;cr(A)==="array"?M=A[1]-A[0]:(M=0,A=[A,A]);var I=function(F){var G=Lc*((s+120)/360+o*F),X=Vc(A[0]+M*F,w),j=S!==0?h[0]+F*S:h,Z=j*X*(1-X)/2,K=Uc(G),J=Pc(G),ht=X+Z*(-.14861*K+1.78277*J),mt=X+Z*(-.29227*K-.90649*J),yt=X+Z*(1.97294*K);return ws(Fc([ht*255,mt*255,yt*255,1]))};return I.start=function(F){return F==null?s:(s=F,I)},I.rotations=function(F){return F==null?o:(o=F,I)},I.gamma=function(F){return F==null?w:(w=F,I)},I.hue=function(F){return F==null?h:(h=F,cr(h)==="array"?(S=h[1]-h[0],S===0&&(h=h[1])):S=0,I)},I.lightness=function(F){return F==null?A:(cr(F)==="array"?(A=F,M=F[1]-F[0]):(A=[F,F],M=0),I)},I.scale=function(){return ws.scale(I)},I.hue(h),I},Bc=st,Rc="0123456789abcdef",Gc=Math.floor,Yc=Math.random,Xc=function(){for(var s="#",o=0;o<6;o++)s+=Rc.charAt(Gc(Yc()*16));return new Bc(s,"hex")},ur=W,ys=Math.log,Wc=Math.pow,Zc=Math.floor,Hc=Math.abs,bs=function(s,o){o===void 0&&(o=null);var h={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return ur(s)==="object"&&(s=Object.values(s)),s.forEach(function(w){o&&ur(w)==="object"&&(w=w[o]),w!=null&&!isNaN(w)&&(h.values.push(w),h.sum+=w,w<h.min&&(h.min=w),w>h.max&&(h.max=w),h.count+=1)}),h.domain=[h.min,h.max],h.limits=function(w,A){return ks(h,w,A)},h},ks=function(s,o,h){o===void 0&&(o="equal"),h===void 0&&(h=7),ur(s)=="array"&&(s=bs(s));var w=s.min,A=s.max,S=s.values.sort(function(fr,hr){return fr-hr});if(h===1)return[w,A];var M=[];if(o.substr(0,1)==="c"&&(M.push(w),M.push(A)),o.substr(0,1)==="e"){M.push(w);for(var I=1;I<h;I++)M.push(w+I/h*(A-w));M.push(A)}else if(o.substr(0,1)==="l"){if(w<=0)throw new Error("Logarithmic scales are only possible for values > 0");var F=Math.LOG10E*ys(w),G=Math.LOG10E*ys(A);M.push(w);for(var X=1;X<h;X++)M.push(Wc(10,F+X/h*(G-F)));M.push(A)}else if(o.substr(0,1)==="q"){M.push(w);for(var j=1;j<h;j++){var Z=(S.length-1)*j/h,K=Zc(Z);if(K===Z)M.push(S[K]);else{var J=Z-K;M.push(S[K]*(1-J)+S[K+1]*J)}}M.push(A)}else if(o.substr(0,1)==="k"){var ht,mt=S.length,yt=new Array(mt),Et=new Array(h),oe=!0,Ct=0,ve=null;ve=[],ve.push(w);for(var vt=1;vt<h;vt++)ve.push(w+vt/h*(A-w));for(ve.push(A);oe;){for(var H=0;H<h;H++)Et[H]=0;for(var at=0;at<mt;at++)for(var _t=S[at],dt=Number.MAX_VALUE,ie=void 0,Ft=0;Ft<h;Ft++){var bt=Hc(ve[Ft]-_t);bt<dt&&(dt=bt,ie=Ft),Et[ie]++,yt[at]=ie}for(var St=new Array(h),Dt=0;Dt<h;Dt++)St[Dt]=null;for(var $t=0;$t<mt;$t++)ht=yt[$t],St[ht]===null?St[ht]=S[$t]:St[ht]+=S[$t];for(var Ee=0;Ee<h;Ee++)St[Ee]*=1/Et[Ee];oe=!1;for(var Le=0;Le<h;Le++)if(St[Le]!==ve[Le]){oe=!0;break}ve=St,Ct++,Ct>200&&(oe=!1)}for(var Ve={},cn=0;cn<h;cn++)Ve[cn]=[];for(var un=0;un<mt;un++)ht=yt[un],Ve[ht].push(S[un]);for(var De=[],Ge=0;Ge<h;Ge++)De.push(Ve[Ge][0]),De.push(Ve[Ge][Ve[Ge].length-1]);De=De.sort(function(fr,hr){return fr-hr}),M.push(De[0]);for(var wn=1;wn<De.length;wn+=2){var Ye=De[wn];!isNaN(Ye)&&M.indexOf(Ye)===-1&&M.push(Ye)}}return M},xs={analyze:bs,limits:ks},Ms=st,jc=function(s,o){s=new Ms(s),o=new Ms(o);var h=s.luminance(),w=o.luminance();return h>w?(h+.05)/(w+.05):(w+.05)/(h+.05)},As=st,Se=Math.sqrt,Rt=Math.pow,Qc=Math.min,Jc=Math.max,Es=Math.atan2,Ts=Math.abs,qn=Math.cos,zs=Math.sin,Kc=Math.exp,Ss=Math.PI,Cc=function(s,o,h,w,A){h===void 0&&(h=1),w===void 0&&(w=1),A===void 0&&(A=1);var S=function(Ye){return 360*Ye/(2*Ss)},M=function(Ye){return 2*Ss*Ye/360};s=new As(s),o=new As(o);var I=Array.from(s.lab()),F=I[0],G=I[1],X=I[2],j=Array.from(o.lab()),Z=j[0],K=j[1],J=j[2],ht=(F+Z)/2,mt=Se(Rt(G,2)+Rt(X,2)),yt=Se(Rt(K,2)+Rt(J,2)),Et=(mt+yt)/2,oe=.5*(1-Se(Rt(Et,7)/(Rt(Et,7)+Rt(25,7)))),Ct=G*(1+oe),ve=K*(1+oe),vt=Se(Rt(Ct,2)+Rt(X,2)),H=Se(Rt(ve,2)+Rt(J,2)),at=(vt+H)/2,_t=S(Es(X,Ct)),dt=S(Es(J,ve)),ie=_t>=0?_t:_t+360,Ft=dt>=0?dt:dt+360,bt=Ts(ie-Ft)>180?(ie+Ft+360)/2:(ie+Ft)/2,St=1-.17*qn(M(bt-30))+.24*qn(M(2*bt))+.32*qn(M(3*bt+6))-.2*qn(M(4*bt-63)),Dt=Ft-ie;Dt=Ts(Dt)<=180?Dt:Ft<=ie?Dt+360:Dt-360,Dt=2*Se(vt*H)*zs(M(Dt)/2);var $t=Z-F,Ee=H-vt,Le=1+.015*Rt(ht-50,2)/Se(20+Rt(ht-50,2)),Ve=1+.045*at,cn=1+.015*at*St,un=30*Kc(-Rt((bt-275)/25,2)),De=2*Se(Rt(at,7)/(Rt(at,7)+Rt(25,7))),Ge=-De*zs(2*M(un)),wn=Se(Rt($t/(h*Le),2)+Rt(Ee/(w*Ve),2)+Rt(Dt/(A*cn),2)+Ge*(Ee/(w*Ve))*(Dt/(A*cn)));return Jc(0,Qc(100,wn))},Ds=st,tu=function(s,o,h){h===void 0&&(h="lab"),s=new Ds(s),o=new Ds(o);var w=s.get(h),A=o.get(h),S=0;for(var M in w){var I=(w[M]||0)-(A[M]||0);S+=I*I}return Math.sqrt(S)},eu=st,nu=function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];try{return new(Function.prototype.bind.apply(eu,[null].concat(s))),!0}catch{return!1}},$s=gt,qs=or,ru={cool:function(){return qs([$s.hsl(180,1,.9),$s.hsl(250,.7,.4)])},hot:function(){return qs(["#000","#f00","#ff0","#fff"]).mode("rgb")}},In={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},lr=0,Is=Object.keys(In);lr<Is.length;lr+=1){var Ns=Is[lr];In[Ns.toLowerCase()]=In[Ns]}var su=In,Kt=gt;Kt.average=vc,Kt.bezier=Ac,Kt.blend=Nc,Kt.cubehelix=Oc,Kt.mix=Kt.interpolate=ls,Kt.random=Xc,Kt.scale=or,Kt.analyze=xs.analyze,Kt.contrast=jc,Kt.deltaE=Cc,Kt.distance=tu,Kt.limits=xs.limits,Kt.valid=nu,Kt.scales=ru,Kt.colors=Wr,Kt.brewer=su;var au=Kt;return au})})(ha);var ju=ha.exports;const uf=Hu(ju),xr=(n,t)=>((n+t-1)/t|0)*t;function Qu(n){return Object.keys(n)}function Ju(n,t){return new Array(n).fill(0).map((r,f)=>t(f))}const kn=n=>n&&typeof n.length=="number"&&n.buffer instanceof ArrayBuffer&&typeof n.byteLength=="number",da=n=>n,xt=da({i32:{numElements:1,align:4,size:4,type:"i32",View:Int32Array},u32:{numElements:1,align:4,size:4,type:"u32",View:Uint32Array},f32:{numElements:1,align:4,size:4,type:"f32",View:Float32Array},f16:{numElements:1,align:2,size:2,type:"u16",View:Uint16Array},vec2f:{numElements:2,align:8,size:8,type:"f32",View:Float32Array},vec2i:{numElements:2,align:8,size:8,type:"i32",View:Int32Array},vec2u:{numElements:2,align:8,size:8,type:"u32",View:Uint32Array},vec2h:{numElements:2,align:4,size:4,type:"u16",View:Uint16Array},vec3i:{numElements:3,align:16,size:12,type:"i32",View:Int32Array},vec3u:{numElements:3,align:16,size:12,type:"u32",View:Uint32Array},vec3f:{numElements:3,align:16,size:12,type:"f32",View:Float32Array},vec3h:{numElements:3,align:8,size:6,type:"u16",View:Uint16Array},vec4i:{numElements:4,align:16,size:16,type:"i32",View:Int32Array},vec4u:{numElements:4,align:16,size:16,type:"u32",View:Uint32Array},vec4f:{numElements:4,align:16,size:16,type:"f32",View:Float32Array},vec4h:{numElements:4,align:8,size:8,type:"u16",View:Uint16Array},mat2x2f:{numElements:4,align:8,size:16,type:"f32",View:Float32Array},mat2x2h:{numElements:4,align:4,size:8,type:"u16",View:Uint16Array},mat3x2f:{numElements:6,align:8,size:24,type:"f32",View:Float32Array},mat3x2h:{numElements:6,align:4,size:12,type:"u16",View:Uint16Array},mat4x2f:{numElements:8,align:8,size:32,type:"f32",View:Float32Array},mat4x2h:{numElements:8,align:4,size:16,type:"u16",View:Uint16Array},mat2x3f:{numElements:8,align:16,size:32,pad:[3,1],type:"f32",View:Float32Array},mat2x3h:{numElements:8,align:8,size:16,pad:[3,1],type:"u16",View:Uint16Array},mat3x3f:{numElements:12,align:16,size:48,pad:[3,1],type:"f32",View:Float32Array},mat3x3h:{numElements:12,align:8,size:24,pad:[3,1],type:"u16",View:Uint16Array},mat4x3f:{numElements:16,align:16,size:64,pad:[3,1],type:"f32",View:Float32Array},mat4x3h:{numElements:16,align:8,size:32,pad:[3,1],type:"u16",View:Uint16Array},mat2x4f:{numElements:8,align:16,size:32,type:"f32",View:Float32Array},mat2x4h:{numElements:8,align:8,size:16,type:"u16",View:Uint16Array},mat3x4f:{numElements:12,align:16,size:48,pad:[3,1],type:"f32",View:Float32Array},mat3x4h:{numElements:12,align:8,size:24,pad:[3,1],type:"u16",View:Uint16Array},mat4x4f:{numElements:16,align:16,size:64,type:"f32",View:Float32Array},mat4x4h:{numElements:16,align:8,size:32,type:"u16",View:Uint16Array},bool:{numElements:0,align:1,size:0,type:"bool",View:Uint32Array}}),_n=da({...xt,"atomic<i32>":xt.i32,"atomic<u32>":xt.u32,"vec2<i32>":xt.vec2i,"vec2<u32>":xt.vec2u,"vec2<f32>":xt.vec2f,"vec2<f16>":xt.vec2h,"vec3<i32>":xt.vec3i,"vec3<u32>":xt.vec3u,"vec3<f32>":xt.vec3f,"vec3<f16>":xt.vec3h,"vec4<i32>":xt.vec4i,"vec4<u32>":xt.vec4u,"vec4<f32>":xt.vec4f,"vec4<f16>":xt.vec4h,"mat2x2<f32>":xt.mat2x2f,"mat2x2<f16>":xt.mat2x2h,"mat3x2<f32>":xt.mat3x2f,"mat3x2<f16>":xt.mat3x2h,"mat4x2<f32>":xt.mat4x2f,"mat4x2<f16>":xt.mat4x2h,"mat2x3<f32>":xt.mat2x3f,"mat2x3<f16>":xt.mat2x3h,"mat3x3<f32>":xt.mat3x3f,"mat3x3<f16>":xt.mat3x3h,"mat4x3<f32>":xt.mat4x3f,"mat4x3<f16>":xt.mat4x3h,"mat2x4<f32>":xt.mat2x4f,"mat2x4<f16>":xt.mat2x4h,"mat3x4<f32>":xt.mat3x4f,"mat3x4<f16>":xt.mat3x4h,"mat4x4<f32>":xt.mat4x4f,"mat4x4<f16>":xt.mat4x4h}),Ku=Qu(_n);function Cu(n=[],t){const r=new Set;for(const f of Ku){const _=_n[f];r.has(_)||(r.add(_),_.flatten=n.includes(f)?t:!t)}}Cu();function tl(n){const t=n;if(t.elementType)return t.size;{const f=n,_=t.numElements||1;if(f.fields)return n.size*_;{const x=n,{align:q}=_n[x.type];return _>1?xr(n.size,q)*_:n.size}}}function Ws(n,t,r,f){const{size:_,type:x}=n;try{const{View:q,align:R}=_n[x],Y=f!==void 0,W=Y?xr(_,R):_,Q=W/q.BYTES_PER_ELEMENT,rt=Y?f===0?(t.byteLength-r)/W:f:1;return new q(t,r,Q*rt)}catch{throw new Error(`unknown type: ${x}`)}}function el(n){return!n.fields&&!n.elementType}function nl(n,t,r){const f=r||0,_=new ArrayBuffer(tl(n)),x=(q,R)=>{const Y=q,W=Y.elementType;if(W){if(el(W)&&_n[W.type].flatten)return Ws(W,_,R,Y.numElements);{const{size:Q}=pa(q),rt=Y.numElements===0?(_.byteLength-R)/Q:Y.numElements;return Ju(rt,it=>x(W,R+Q*it))}}else{if(typeof q=="string")throw Error("unreachable");{const Q=q.fields;if(Q){const rt={};for(const[it,{type:Mt,offset:Tt}]of Object.entries(Q))rt[it]=x(Mt,R+Tt);return rt}else return Ws(q,_,R)}}};return{views:x(n,f),arrayBuffer:_}}function mr(n,t){if(n!==void 0)if(kn(t)){const r=t;if(r.length===1&&typeof n=="number")r[0]=n;else if(Array.isArray(n[0])||kn(n[0])){const f=n[0].length,_=f===3?4:f;for(let x=0;x<n.length;++x){const q=x*_;r.set(n[x],q)}}else r.set(n)}else if(Array.isArray(t)){const r=t;n.forEach((f,_)=>{mr(f,r[_])})}else{const r=t;for(const[f,_]of Object.entries(n)){const x=r[f];x&&mr(_,x)}}}function lf(n,t,r=0){const f=n,_=f.group===void 0?n:f.typeDefinition,x=nl(_,t,r);return{...x,set(q){mr(q,x.views)}}}function vr(n){const r=n.elementType;if(r)return vr(r);const _=n.fields;if(_)return Object.values(_).reduce((R,{type:Y})=>Math.max(R,vr(Y)),0);const{type:x}=n,{align:q}=_n[x];return q}function pa(n){const r=n.elementType;if(r){const x=r.size,q=vr(r);return{unalignedSize:x,align:q,size:xr(x,q)}}const _=n.fields;if(_){const x=Object.values(_).pop();if(x.type.size===0)return pa(x.type)}return{size:0,unalignedSize:0,align:1}}class rl{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class Ie{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(t){throw new Error("Cannot evaluate node")}evaluateString(t){return this.evaluate(t).toString()}search(t){}searchBlock(t,r){if(t){r(Vn.instance);for(const f of t)f instanceof Array?this.searchBlock(f,r):f.search(r);r(Pn.instance)}}}class Vn extends Ie{}Vn.instance=new Vn;class Pn extends Ie{}Pn.instance=new Pn;class Lt extends Ie{constructor(){super()}}let wr=class extends Lt{constructor(t,r,f,_,x,q){super(),this.calls=new Set,this.name=t,this.args=r,this.returnType=f,this.body=_,this.startLine=x,this.endLine=q}get astNodeType(){return"function"}search(t){this.searchBlock(this.body,t)}};class sl extends Lt{constructor(t){super(),this.expression=t}get astNodeType(){return"staticAssert"}search(t){this.expression.search(t)}}class al extends Lt{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"while"}search(t){this.condition.search(t),this.searchBlock(this.body,t)}}class ol extends Lt{constructor(t){super(),this.body=t}get astNodeType(){return"continuing"}search(t){this.searchBlock(this.body,t)}}class il extends Lt{constructor(t,r,f,_){super(),this.init=t,this.condition=r,this.increment=f,this.body=_}get astNodeType(){return"for"}search(t){var r,f,_;(r=this.init)===null||r===void 0||r.search(t),(f=this.condition)===null||f===void 0||f.search(t),(_=this.increment)===null||_===void 0||_.search(t),this.searchBlock(this.body,t)}}class We extends Lt{constructor(t,r,f,_,x){super(),this.name=t,this.type=r,this.storage=f,this.access=_,this.value=x}get astNodeType(){return"var"}search(t){var r;t(this),(r=this.value)===null||r===void 0||r.search(t)}}class _a extends Lt{constructor(t,r,f){super(),this.name=t,this.type=r,this.value=f}get astNodeType(){return"override"}search(t){var r;(r=this.value)===null||r===void 0||r.search(t)}}class yr extends Lt{constructor(t,r,f,_,x){super(),this.name=t,this.type=r,this.storage=f,this.access=_,this.value=x}get astNodeType(){return"let"}search(t){var r;t(this),(r=this.value)===null||r===void 0||r.search(t)}}class Zs extends Lt{constructor(t,r,f,_,x){super(),this.name=t,this.type=r,this.storage=f,this.access=_,this.value=x}get astNodeType(){return"const"}evaluate(t){return this.value.evaluate(t)}search(t){var r;t(this),(r=this.value)===null||r===void 0||r.search(t)}}var pn;(function(n){n.increment="++",n.decrement="--"})(pn||(pn={}));(function(n){function t(r){const f=r;if(f=="parse")throw new Error("Invalid value for IncrementOperator");return n[f]}n.parse=t})(pn||(pn={}));class cl extends Lt{constructor(t,r){super(),this.operator=t,this.variable=r}get astNodeType(){return"increment"}search(t){this.variable.search(t)}}var xn;(function(n){n.assign="=",n.addAssign="+=",n.subtractAssin="-=",n.multiplyAssign="*=",n.divideAssign="/=",n.moduloAssign="%=",n.andAssign="&=",n.orAssign="|=",n.xorAssign="^=",n.shiftLeftAssign="<<=",n.shiftRightAssign=">>="})(xn||(xn={}));(function(n){function t(r){const f=r;if(f=="parse")throw new Error("Invalid value for AssignOperator");return f}n.parse=t})(xn||(xn={}));class ul extends Lt{constructor(t,r,f){super(),this.operator=t,this.variable=r,this.value=f}get astNodeType(){return"assign"}search(t){this.variable.search(t),this.value.search(t)}}class ga extends Lt{constructor(t,r){super(),this.name=t,this.args=r}get astNodeType(){return"call"}search(t){for(const r of this.args)r.search(t);t(this)}}class ll extends Lt{constructor(t,r){super(),this.body=t,this.continuing=r}get astNodeType(){return"loop"}}class fl extends Lt{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"body"}}class hl extends Lt{constructor(t,r,f,_){super(),this.condition=t,this.body=r,this.elseif=f,this.else=_}get astNodeType(){return"if"}search(t){this.condition.search(t),this.searchBlock(this.body,t),this.searchBlock(this.elseif,t),this.searchBlock(this.else,t)}}class dl extends Lt{constructor(t){super(),this.value=t}get astNodeType(){return"return"}search(t){var r;(r=this.value)===null||r===void 0||r.search(t)}}class pl extends Lt{constructor(t){super(),this.name=t}get astNodeType(){return"enable"}}class _l extends Lt{constructor(t){super(),this.extensions=t}get astNodeType(){return"requires"}}class gl extends Lt{constructor(t,r){super(),this.severity=t,this.rule=r}get astNodeType(){return"diagnostic"}}class ma extends Lt{constructor(t,r){super(),this.name=t,this.type=r}get astNodeType(){return"alias"}}class ml extends Lt{constructor(){super()}get astNodeType(){return"discard"}}class vl extends Lt{constructor(){super()}get astNodeType(){return"break"}}class wl extends Lt{constructor(){super()}get astNodeType(){return"continue"}}class Ze extends Lt{constructor(t){super(),this.name=t}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class Xe extends Ze{constructor(t,r,f,_){super(t),this.members=r,this.startLine=f,this.endLine=_}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(t){for(let r=0;r<this.members.length;r++)if(this.members[r].name==t)return r;return-1}}class va extends Ze{constructor(t,r,f){super(t),this.format=r,this.access=f}get astNodeType(){return"template"}}class yl extends Ze{constructor(t,r,f,_){super(t),this.storage=r,this.type=f,this.access=_}get astNodeType(){return"pointer"}}class wa extends Ze{constructor(t,r,f,_){super(t),this.attributes=r,this.format=f,this.count=_}get astNodeType(){return"array"}get isArray(){return!0}}class bn extends Ze{constructor(t,r,f){super(t),this.format=r,this.access=f}get astNodeType(){return"sampler"}}class Te extends Ie{constructor(){super()}}class Hs extends Te{constructor(t){super(),this.value=t}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class hn extends Te{constructor(t,r){super(),this.type=t,this.args=r}get astNodeType(){return"createExpr"}search(t){t(this);for(const r of this.args)r.search(t)}}class ya extends Te{constructor(t,r){super(),this.name=t,this.args=r}get astNodeType(){return"callExpr"}evaluate(t){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(t));case"acos":return Math.acos(this.args[0].evaluate(t));case"acosh":return Math.acosh(this.args[0].evaluate(t));case"asin":return Math.asin(this.args[0].evaluate(t));case"asinh":return Math.asinh(this.args[0].evaluate(t));case"atan":return Math.atan(this.args[0].evaluate(t));case"atan2":return Math.atan2(this.args[0].evaluate(t),this.args[1].evaluate(t));case"atanh":return Math.atanh(this.args[0].evaluate(t));case"ceil":return Math.ceil(this.args[0].evaluate(t));case"clamp":return Math.min(Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t)),this.args[2].evaluate(t));case"cos":return Math.cos(this.args[0].evaluate(t));case"degrees":return this.args[0].evaluate(t)*180/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(t)-this.args[1].evaluate(t),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(t));case"exp2":return Math.pow(2,this.args[0].evaluate(t));case"floor":return Math.floor(this.args[0].evaluate(t));case"fma":return this.args[0].evaluate(t)*this.args[1].evaluate(t)+this.args[2].evaluate(t);case"fract":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(t));case"log":return Math.log(this.args[0].evaluate(t));case"log2":return Math.log2(this.args[0].evaluate(t));case"max":return Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t));case"min":return Math.min(this.args[0].evaluate(t),this.args[1].evaluate(t));case"mix":return this.args[0].evaluate(t)*(1-this.args[2].evaluate(t))+this.args[1].evaluate(t)*this.args[2].evaluate(t);case"modf":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"pow":return Math.pow(this.args[0].evaluate(t),this.args[1].evaluate(t));case"radians":return this.args[0].evaluate(t)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(t));case"sign":return Math.sign(this.args[0].evaluate(t));case"sin":return Math.sin(this.args[0].evaluate(t));case"sinh":return Math.sinh(this.args[0].evaluate(t));case"saturate":return Math.min(Math.max(this.args[0].evaluate(t),0),1);case"smoothstep":return this.args[0].evaluate(t)*this.args[0].evaluate(t)*(3-2*this.args[0].evaluate(t));case"sqrt":return Math.sqrt(this.args[0].evaluate(t));case"step":return this.args[0].evaluate(t)<this.args[1].evaluate(t)?0:1;case"tan":return Math.tan(this.args[0].evaluate(t));case"tanh":return Math.tanh(this.args[0].evaluate(t));case"trunc":return Math.trunc(this.args[0].evaluate(t));default:throw new Error("Non const function: "+this.name)}}search(t){for(const r of this.args)r.search(t);t(this)}}class br extends Te{constructor(t){super(),this.name=t}get astNodeType(){return"varExpr"}search(t){t(this),this.postfix&&this.postfix.search(t)}evaluate(t){const r=t.constants.get(this.name);if(!r)throw new Error("Cannot evaluate node");return r.evaluate(t)}}class js extends Te{constructor(t,r){super(),this.name=t,this.initializer=r}get astNodeType(){return"constExpr"}evaluate(t){var r,f;if(this.initializer instanceof hn){const _=(r=this.postfix)===null||r===void 0?void 0:r.evaluateString(t),x=(f=this.initializer.type)===null||f===void 0?void 0:f.name,q=t.structs.get(x),R=q==null?void 0:q.getMemberIndex(_);if(R!=-1)return this.initializer.args[R].evaluate(t);console.log(R)}return this.initializer.evaluate(t)}search(t){this.initializer.search(t)}}class Qs extends Te{constructor(t){super(),this.value=t}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class bl extends Te{constructor(t,r){super(),this.type=t,this.value=r}get astNodeType(){return"bitcastExpr"}search(t){this.value.search(t)}}class kl extends Te{constructor(t,r){super(),this.type=t,this.args=r}get astNodeType(){return"typecastExpr"}evaluate(t){return this.args[0].evaluate(t)}search(t){this.searchBlock(this.args,t)}}class Js extends Te{constructor(t){super(),this.contents=t}get astNodeType(){return"groupExpr"}evaluate(t){return this.contents[0].evaluate(t)}search(t){this.searchBlock(this.contents,t)}}class xl extends Te{constructor(t){super(),this.index=t}search(t){this.index.search(t)}}class ba extends Te{constructor(){super()}}class Ml extends ba{constructor(t,r){super(),this.operator=t,this.right=r}get astNodeType(){return"unaryOp"}evaluate(t){switch(this.operator){case"+":return this.right.evaluate(t);case"-":return-this.right.evaluate(t);case"!":return this.right.evaluate(t)?0:1;case"~":return~this.right.evaluate(t);default:throw new Error("Unknown unary operator: "+this.operator)}}search(t){this.right.search(t)}}class ze extends ba{constructor(t,r,f){super(),this.operator=t,this.left=r,this.right=f}get astNodeType(){return"binaryOp"}evaluate(t){switch(this.operator){case"+":return this.left.evaluate(t)+this.right.evaluate(t);case"-":return this.left.evaluate(t)-this.right.evaluate(t);case"*":return this.left.evaluate(t)*this.right.evaluate(t);case"/":return this.left.evaluate(t)/this.right.evaluate(t);case"%":return this.left.evaluate(t)%this.right.evaluate(t);case"==":return this.left.evaluate(t)==this.right.evaluate(t)?1:0;case"!=":return this.left.evaluate(t)!=this.right.evaluate(t)?1:0;case"<":return this.left.evaluate(t)<this.right.evaluate(t)?1:0;case">":return this.left.evaluate(t)>this.right.evaluate(t)?1:0;case"<=":return this.left.evaluate(t)<=this.right.evaluate(t)?1:0;case">=":return this.left.evaluate(t)>=this.right.evaluate(t)?1:0;case"&&":return this.left.evaluate(t)&&this.right.evaluate(t)?1:0;case"||":return this.left.evaluate(t)||this.right.evaluate(t)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(t){this.left.search(t),this.right.search(t)}}class ka extends Ie{constructor(){super()}}class Al extends ka{constructor(t,r){super(),this.selector=t,this.body=r}get astNodeType(){return"case"}search(t){this.searchBlock(this.body,t)}}class El extends ka{constructor(t){super(),this.body=t}get astNodeType(){return"default"}search(t){this.searchBlock(this.body,t)}}class Tl extends Ie{constructor(t,r,f){super(),this.name=t,this.type=r,this.attributes=f}get astNodeType(){return"argument"}}class zl extends Ie{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"elseif"}search(t){this.condition.search(t),this.searchBlock(this.body,t)}}class Sl extends Ie{constructor(t,r,f){super(),this.name=t,this.type=r,this.attributes=f}get astNodeType(){return"member"}}class Ks extends Ie{constructor(t,r){super(),this.name=t,this.value=r}get astNodeType(){return"attribute"}}var N,D;(function(n){n[n.token=0]="token",n[n.keyword=1]="keyword",n[n.reserved=2]="reserved"})(D||(D={}));class ${constructor(t,r,f){this.name=t,this.type=r,this.rule=f}toString(){return this.name}}class g{}N=g;g.none=new $("",D.reserved,"");g.eof=new $("EOF",D.token,"");g.reserved={asm:new $("asm",D.reserved,"asm"),bf16:new $("bf16",D.reserved,"bf16"),do:new $("do",D.reserved,"do"),enum:new $("enum",D.reserved,"enum"),f16:new $("f16",D.reserved,"f16"),f64:new $("f64",D.reserved,"f64"),handle:new $("handle",D.reserved,"handle"),i8:new $("i8",D.reserved,"i8"),i16:new $("i16",D.reserved,"i16"),i64:new $("i64",D.reserved,"i64"),mat:new $("mat",D.reserved,"mat"),premerge:new $("premerge",D.reserved,"premerge"),regardless:new $("regardless",D.reserved,"regardless"),typedef:new $("typedef",D.reserved,"typedef"),u8:new $("u8",D.reserved,"u8"),u16:new $("u16",D.reserved,"u16"),u64:new $("u64",D.reserved,"u64"),unless:new $("unless",D.reserved,"unless"),using:new $("using",D.reserved,"using"),vec:new $("vec",D.reserved,"vec"),void:new $("void",D.reserved,"void")};g.keywords={array:new $("array",D.keyword,"array"),atomic:new $("atomic",D.keyword,"atomic"),bool:new $("bool",D.keyword,"bool"),f32:new $("f32",D.keyword,"f32"),i32:new $("i32",D.keyword,"i32"),mat2x2:new $("mat2x2",D.keyword,"mat2x2"),mat2x3:new $("mat2x3",D.keyword,"mat2x3"),mat2x4:new $("mat2x4",D.keyword,"mat2x4"),mat3x2:new $("mat3x2",D.keyword,"mat3x2"),mat3x3:new $("mat3x3",D.keyword,"mat3x3"),mat3x4:new $("mat3x4",D.keyword,"mat3x4"),mat4x2:new $("mat4x2",D.keyword,"mat4x2"),mat4x3:new $("mat4x3",D.keyword,"mat4x3"),mat4x4:new $("mat4x4",D.keyword,"mat4x4"),ptr:new $("ptr",D.keyword,"ptr"),sampler:new $("sampler",D.keyword,"sampler"),sampler_comparison:new $("sampler_comparison",D.keyword,"sampler_comparison"),struct:new $("struct",D.keyword,"struct"),texture_1d:new $("texture_1d",D.keyword,"texture_1d"),texture_2d:new $("texture_2d",D.keyword,"texture_2d"),texture_2d_array:new $("texture_2d_array",D.keyword,"texture_2d_array"),texture_3d:new $("texture_3d",D.keyword,"texture_3d"),texture_cube:new $("texture_cube",D.keyword,"texture_cube"),texture_cube_array:new $("texture_cube_array",D.keyword,"texture_cube_array"),texture_multisampled_2d:new $("texture_multisampled_2d",D.keyword,"texture_multisampled_2d"),texture_storage_1d:new $("texture_storage_1d",D.keyword,"texture_storage_1d"),texture_storage_2d:new $("texture_storage_2d",D.keyword,"texture_storage_2d"),texture_storage_2d_array:new $("texture_storage_2d_array",D.keyword,"texture_storage_2d_array"),texture_storage_3d:new $("texture_storage_3d",D.keyword,"texture_storage_3d"),texture_depth_2d:new $("texture_depth_2d",D.keyword,"texture_depth_2d"),texture_depth_2d_array:new $("texture_depth_2d_array",D.keyword,"texture_depth_2d_array"),texture_depth_cube:new $("texture_depth_cube",D.keyword,"texture_depth_cube"),texture_depth_cube_array:new $("texture_depth_cube_array",D.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new $("texture_depth_multisampled_2d",D.keyword,"texture_depth_multisampled_2d"),texture_external:new $("texture_external",D.keyword,"texture_external"),u32:new $("u32",D.keyword,"u32"),vec2:new $("vec2",D.keyword,"vec2"),vec3:new $("vec3",D.keyword,"vec3"),vec4:new $("vec4",D.keyword,"vec4"),bitcast:new $("bitcast",D.keyword,"bitcast"),block:new $("block",D.keyword,"block"),break:new $("break",D.keyword,"break"),case:new $("case",D.keyword,"case"),continue:new $("continue",D.keyword,"continue"),continuing:new $("continuing",D.keyword,"continuing"),default:new $("default",D.keyword,"default"),diagnostic:new $("diagnostic",D.keyword,"diagnostic"),discard:new $("discard",D.keyword,"discard"),else:new $("else",D.keyword,"else"),enable:new $("enable",D.keyword,"enable"),fallthrough:new $("fallthrough",D.keyword,"fallthrough"),false:new $("false",D.keyword,"false"),fn:new $("fn",D.keyword,"fn"),for:new $("for",D.keyword,"for"),function:new $("function",D.keyword,"function"),if:new $("if",D.keyword,"if"),let:new $("let",D.keyword,"let"),const:new $("const",D.keyword,"const"),loop:new $("loop",D.keyword,"loop"),while:new $("while",D.keyword,"while"),private:new $("private",D.keyword,"private"),read:new $("read",D.keyword,"read"),read_write:new $("read_write",D.keyword,"read_write"),return:new $("return",D.keyword,"return"),requires:new $("requires",D.keyword,"requires"),storage:new $("storage",D.keyword,"storage"),switch:new $("switch",D.keyword,"switch"),true:new $("true",D.keyword,"true"),alias:new $("alias",D.keyword,"alias"),type:new $("type",D.keyword,"type"),uniform:new $("uniform",D.keyword,"uniform"),var:new $("var",D.keyword,"var"),override:new $("override",D.keyword,"override"),workgroup:new $("workgroup",D.keyword,"workgroup"),write:new $("write",D.keyword,"write"),r8unorm:new $("r8unorm",D.keyword,"r8unorm"),r8snorm:new $("r8snorm",D.keyword,"r8snorm"),r8uint:new $("r8uint",D.keyword,"r8uint"),r8sint:new $("r8sint",D.keyword,"r8sint"),r16uint:new $("r16uint",D.keyword,"r16uint"),r16sint:new $("r16sint",D.keyword,"r16sint"),r16float:new $("r16float",D.keyword,"r16float"),rg8unorm:new $("rg8unorm",D.keyword,"rg8unorm"),rg8snorm:new $("rg8snorm",D.keyword,"rg8snorm"),rg8uint:new $("rg8uint",D.keyword,"rg8uint"),rg8sint:new $("rg8sint",D.keyword,"rg8sint"),r32uint:new $("r32uint",D.keyword,"r32uint"),r32sint:new $("r32sint",D.keyword,"r32sint"),r32float:new $("r32float",D.keyword,"r32float"),rg16uint:new $("rg16uint",D.keyword,"rg16uint"),rg16sint:new $("rg16sint",D.keyword,"rg16sint"),rg16float:new $("rg16float",D.keyword,"rg16float"),rgba8unorm:new $("rgba8unorm",D.keyword,"rgba8unorm"),rgba8unorm_srgb:new $("rgba8unorm_srgb",D.keyword,"rgba8unorm_srgb"),rgba8snorm:new $("rgba8snorm",D.keyword,"rgba8snorm"),rgba8uint:new $("rgba8uint",D.keyword,"rgba8uint"),rgba8sint:new $("rgba8sint",D.keyword,"rgba8sint"),bgra8unorm:new $("bgra8unorm",D.keyword,"bgra8unorm"),bgra8unorm_srgb:new $("bgra8unorm_srgb",D.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new $("rgb10a2unorm",D.keyword,"rgb10a2unorm"),rg11b10float:new $("rg11b10float",D.keyword,"rg11b10float"),rg32uint:new $("rg32uint",D.keyword,"rg32uint"),rg32sint:new $("rg32sint",D.keyword,"rg32sint"),rg32float:new $("rg32float",D.keyword,"rg32float"),rgba16uint:new $("rgba16uint",D.keyword,"rgba16uint"),rgba16sint:new $("rgba16sint",D.keyword,"rgba16sint"),rgba16float:new $("rgba16float",D.keyword,"rgba16float"),rgba32uint:new $("rgba32uint",D.keyword,"rgba32uint"),rgba32sint:new $("rgba32sint",D.keyword,"rgba32sint"),rgba32float:new $("rgba32float",D.keyword,"rgba32float"),static_assert:new $("static_assert",D.keyword,"static_assert")};g.tokens={decimal_float_literal:new $("decimal_float_literal",D.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new $("hex_float_literal",D.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new $("int_literal",D.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new $("uint_literal",D.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new $("ident",D.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new $("and",D.token,"&"),and_and:new $("and_and",D.token,"&&"),arrow:new $("arrow ",D.token,"->"),attr:new $("attr",D.token,"@"),attr_left:new $("attr_left",D.token,"[["),attr_right:new $("attr_right",D.token,"]]"),forward_slash:new $("forward_slash",D.token,"/"),bang:new $("bang",D.token,"!"),bracket_left:new $("bracket_left",D.token,"["),bracket_right:new $("bracket_right",D.token,"]"),brace_left:new $("brace_left",D.token,"{"),brace_right:new $("brace_right",D.token,"}"),colon:new $("colon",D.token,":"),comma:new $("comma",D.token,","),equal:new $("equal",D.token,"="),equal_equal:new $("equal_equal",D.token,"=="),not_equal:new $("not_equal",D.token,"!="),greater_than:new $("greater_than",D.token,">"),greater_than_equal:new $("greater_than_equal",D.token,">="),shift_right:new $("shift_right",D.token,">>"),less_than:new $("less_than",D.token,"<"),less_than_equal:new $("less_than_equal",D.token,"<="),shift_left:new $("shift_left",D.token,"<<"),modulo:new $("modulo",D.token,"%"),minus:new $("minus",D.token,"-"),minus_minus:new $("minus_minus",D.token,"--"),period:new $("period",D.token,"."),plus:new $("plus",D.token,"+"),plus_plus:new $("plus_plus",D.token,"++"),or:new $("or",D.token,"|"),or_or:new $("or_or",D.token,"||"),paren_left:new $("paren_left",D.token,"("),paren_right:new $("paren_right",D.token,")"),semicolon:new $("semicolon",D.token,";"),star:new $("star",D.token,"*"),tilde:new $("tilde",D.token,"~"),underscore:new $("underscore",D.token,"_"),xor:new $("xor",D.token,"^"),plus_equal:new $("plus_equal",D.token,"+="),minus_equal:new $("minus_equal",D.token,"-="),times_equal:new $("times_equal",D.token,"*="),division_equal:new $("division_equal",D.token,"/="),modulo_equal:new $("modulo_equal",D.token,"%="),and_equal:new $("and_equal",D.token,"&="),or_equal:new $("or_equal",D.token,"|="),xor_equal:new $("xor_equal",D.token,"^="),shift_right_equal:new $("shift_right_equal",D.token,">>="),shift_left_equal:new $("shift_left_equal",D.token,"<<=")};g.simpleTokens={"@":N.tokens.attr,"{":N.tokens.brace_left,"}":N.tokens.brace_right,":":N.tokens.colon,",":N.tokens.comma,"(":N.tokens.paren_left,")":N.tokens.paren_right,";":N.tokens.semicolon};g.literalTokens={"&":N.tokens.and,"&&":N.tokens.and_and,"->":N.tokens.arrow,"[[":N.tokens.attr_left,"]]":N.tokens.attr_right,"/":N.tokens.forward_slash,"!":N.tokens.bang,"[":N.tokens.bracket_left,"]":N.tokens.bracket_right,"=":N.tokens.equal,"==":N.tokens.equal_equal,"!=":N.tokens.not_equal,">":N.tokens.greater_than,">=":N.tokens.greater_than_equal,">>":N.tokens.shift_right,"<":N.tokens.less_than,"<=":N.tokens.less_than_equal,"<<":N.tokens.shift_left,"%":N.tokens.modulo,"-":N.tokens.minus,"--":N.tokens.minus_minus,".":N.tokens.period,"+":N.tokens.plus,"++":N.tokens.plus_plus,"|":N.tokens.or,"||":N.tokens.or_or,"*":N.tokens.star,"~":N.tokens.tilde,_:N.tokens.underscore,"^":N.tokens.xor,"+=":N.tokens.plus_equal,"-=":N.tokens.minus_equal,"*=":N.tokens.times_equal,"/=":N.tokens.division_equal,"%=":N.tokens.modulo_equal,"&=":N.tokens.and_equal,"|=":N.tokens.or_equal,"^=":N.tokens.xor_equal,">>=":N.tokens.shift_right_equal,"<<=":N.tokens.shift_left_equal};g.regexTokens={decimal_float_literal:N.tokens.decimal_float_literal,hex_float_literal:N.tokens.hex_float_literal,int_literal:N.tokens.int_literal,uint_literal:N.tokens.uint_literal,ident:N.tokens.ident};g.storage_class=[N.keywords.function,N.keywords.private,N.keywords.workgroup,N.keywords.uniform,N.keywords.storage];g.access_mode=[N.keywords.read,N.keywords.write,N.keywords.read_write];g.sampler_type=[N.keywords.sampler,N.keywords.sampler_comparison];g.sampled_texture_type=[N.keywords.texture_1d,N.keywords.texture_2d,N.keywords.texture_2d_array,N.keywords.texture_3d,N.keywords.texture_cube,N.keywords.texture_cube_array];g.multisampled_texture_type=[N.keywords.texture_multisampled_2d];g.storage_texture_type=[N.keywords.texture_storage_1d,N.keywords.texture_storage_2d,N.keywords.texture_storage_2d_array,N.keywords.texture_storage_3d];g.depth_texture_type=[N.keywords.texture_depth_2d,N.keywords.texture_depth_2d_array,N.keywords.texture_depth_cube,N.keywords.texture_depth_cube_array,N.keywords.texture_depth_multisampled_2d];g.texture_external_type=[N.keywords.texture_external];g.any_texture_type=[...N.sampled_texture_type,...N.multisampled_texture_type,...N.storage_texture_type,...N.depth_texture_type,...N.texture_external_type];g.texel_format=[N.keywords.r8unorm,N.keywords.r8snorm,N.keywords.r8uint,N.keywords.r8sint,N.keywords.r16uint,N.keywords.r16sint,N.keywords.r16float,N.keywords.rg8unorm,N.keywords.rg8snorm,N.keywords.rg8uint,N.keywords.rg8sint,N.keywords.r32uint,N.keywords.r32sint,N.keywords.r32float,N.keywords.rg16uint,N.keywords.rg16sint,N.keywords.rg16float,N.keywords.rgba8unorm,N.keywords.rgba8unorm_srgb,N.keywords.rgba8snorm,N.keywords.rgba8uint,N.keywords.rgba8sint,N.keywords.bgra8unorm,N.keywords.bgra8unorm_srgb,N.keywords.rgb10a2unorm,N.keywords.rg11b10float,N.keywords.rg32uint,N.keywords.rg32sint,N.keywords.rg32float,N.keywords.rgba16uint,N.keywords.rgba16sint,N.keywords.rgba16float,N.keywords.rgba32uint,N.keywords.rgba32sint,N.keywords.rgba32float];g.const_literal=[N.tokens.int_literal,N.tokens.uint_literal,N.tokens.decimal_float_literal,N.tokens.hex_float_literal,N.keywords.true,N.keywords.false];g.literal_or_ident=[N.tokens.ident,N.tokens.int_literal,N.tokens.uint_literal,N.tokens.decimal_float_literal,N.tokens.hex_float_literal];g.element_count_expression=[N.tokens.int_literal,N.tokens.uint_literal,N.tokens.ident];g.template_types=[N.keywords.vec2,N.keywords.vec3,N.keywords.vec4,N.keywords.mat2x2,N.keywords.mat2x3,N.keywords.mat2x4,N.keywords.mat3x2,N.keywords.mat3x3,N.keywords.mat3x4,N.keywords.mat4x2,N.keywords.mat4x3,N.keywords.mat4x4,N.keywords.atomic,N.keywords.bitcast,...N.any_texture_type];g.attribute_name=[N.tokens.ident,N.keywords.block,N.keywords.diagnostic];g.assignment_operators=[N.tokens.equal,N.tokens.plus_equal,N.tokens.minus_equal,N.tokens.times_equal,N.tokens.division_equal,N.tokens.modulo_equal,N.tokens.and_equal,N.tokens.or_equal,N.tokens.xor_equal,N.tokens.shift_right_equal,N.tokens.shift_left_equal];g.increment_operators=[N.tokens.plus_plus,N.tokens.minus_minus];class Cs{constructor(t,r,f){this.type=t,this.lexeme=r,this.line=f}toString(){return this.lexeme}isTemplateType(){return g.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==g.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class Dl{constructor(t){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=t??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new Cs(g.eof,"",this._line)),this._tokens}scanToken(){let t=this._advance();if(t==`
`)return this._line++,!0;if(this._isWhitespace(t))return!0;if(t=="/"){if(this._peekAhead()=="/"){for(;t!=`
`;){if(this._isAtEnd())return!0;t=this._advance()}return this._line++,!0}else if(this._peekAhead()=="*"){this._advance();let q=1;for(;q>0;){if(this._isAtEnd())return!0;if(t=this._advance(),t==`
`)this._line++;else if(t=="*"){if(this._peekAhead()=="/"&&(this._advance(),q--,q==0))return!0}else t=="/"&&this._peekAhead()=="*"&&(this._advance(),q++)}return!0}}const r=g.simpleTokens[t];if(r)return this._addToken(r),!0;let f=g.none;const _=this._isAlpha(t),x=t==="_";if(this._isAlphaNumeric(t)){let q=this._peekAhead();for(;this._isAlphaNumeric(q);)t+=this._advance(),q=this._peekAhead()}if(_){const q=g.keywords[t];if(q)return this._addToken(q),!0}if(_||x)return this._addToken(g.tokens.ident),!0;for(;;){let q=this._findType(t);const R=this._peekAhead();if(t==">"&&(R==">"||R=="=")){let Y=!1,W=this._tokens.length-1;for(let Q=0;Q<5&&W>=0;++Q,--W)if(this._tokens[W].type===g.tokens.less_than){W>0&&this._tokens[W-1].isArrayOrTemplateType()&&(Y=!0);break}if(Y)return this._addToken(q),!0}if(q===g.none){let Y=t,W=0;const Q=2;for(let rt=0;rt<Q;++rt)if(Y+=this._peekAhead(rt),q=this._findType(Y),q!==g.none){W=rt;break}if(q===g.none)return f===g.none?!1:(this._current--,this._addToken(f),!0);t=Y,this._current+=W+1}if(f=q,this._isAtEnd())break;t+=this._advance()}return f===g.none?!1:(this._addToken(f),!0)}_findType(t){for(const f in g.regexTokens){const _=g.regexTokens[f];if(this._match(t,_.rule))return _}const r=g.literalTokens[t];return r||g.none}_match(t,r){const f=r.exec(t);return f&&f.index==0&&f[0]==t}_isAtEnd(){return this._current>=this._source.length}_isAlpha(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}_isAlphaNumeric(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t=="_"||t>="0"&&t<="9"}_isWhitespace(t){return t==" "||t=="	"||t=="\r"}_advance(t=0){let r=this._source[this._current];return t=t||0,t++,this._current+=t,r}_peekAhead(t=0){return t=t||0,this._current+t>=this._source.length?"\0":this._source[this._current+t]}_addToken(t){const r=this._source.substring(this._start,this._current);this._tokens.push(new Cs(t,r,this._line))}}class $l{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new rl,this._deferArrayCountEval=[]}parse(t){this._initialize(t),this._deferArrayCountEval.length=0;const r=[];for(;!this._isAtEnd();){const f=this._global_decl_or_directive();if(!f)break;r.push(f)}if(this._deferArrayCountEval.length>0){for(const f of this._deferArrayCountEval){const _=f.arrayType,x=f.countNode;if(x instanceof br){const R=x.name,Y=this._context.constants.get(R);if(Y)try{const W=Y.evaluate(this._context);_.count=W}catch{}}}this._deferArrayCountEval.length=0}return r}_initialize(t){if(t)if(typeof t=="string"){const r=new Dl(t);this._tokens=r.scanTokens()}else this._tokens=t;else this._tokens=[];this._current=0}_error(t,r){return{token:t,message:r,toString:function(){return`${r}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==g.eof}_match(t){if(t instanceof $)return this._check(t)?(this._advance(),!0):!1;for(let r=0,f=t.length;r<f;++r){const _=t[r];if(this._check(_))return this._advance(),!0}return!1}_consume(t,r){if(this._check(t))return this._advance();throw this._error(this._peek(),r)}_check(t){if(this._isAtEnd())return!1;const r=this._peek();if(t instanceof Array){const f=r.type;return t.indexOf(f)!=-1}return r.type==t}_advance(){var t,r;return this._currentLine=(r=(t=this._peek())===null||t===void 0?void 0:t.line)!==null&&r!==void 0?r:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(g.tokens.semicolon)&&!this._isAtEnd(););if(this._match(g.keywords.alias)){const r=this._type_alias();return this._consume(g.tokens.semicolon,"Expected ';'"),r}if(this._match(g.keywords.diagnostic)){const r=this._diagnostic();return this._consume(g.tokens.semicolon,"Expected ';'"),r}if(this._match(g.keywords.requires)){const r=this._requires_directive();return this._consume(g.tokens.semicolon,"Expected ';'"),r}if(this._match(g.keywords.enable)){const r=this._enable_directive();return this._consume(g.tokens.semicolon,"Expected ';'"),r}const t=this._attribute();if(this._check(g.keywords.var)){const r=this._global_variable_decl();return r!=null&&(r.attributes=t),this._consume(g.tokens.semicolon,"Expected ';'."),r}if(this._check(g.keywords.override)){const r=this._override_variable_decl();return r!=null&&(r.attributes=t),this._consume(g.tokens.semicolon,"Expected ';'."),r}if(this._check(g.keywords.let)){const r=this._global_let_decl();return r!=null&&(r.attributes=t),this._consume(g.tokens.semicolon,"Expected ';'."),r}if(this._check(g.keywords.const)){const r=this._global_const_decl();return r!=null&&(r.attributes=t),this._consume(g.tokens.semicolon,"Expected ';'."),r}if(this._check(g.keywords.struct)){const r=this._struct_decl();return r!=null&&(r.attributes=t),r}if(this._check(g.keywords.fn)){const r=this._function_decl();return r!=null&&(r.attributes=t),r}return null}_function_decl(){if(!this._match(g.keywords.fn))return null;const t=this._currentLine,r=this._consume(g.tokens.ident,"Expected function name.").toString();this._consume(g.tokens.paren_left,"Expected '(' for function arguments.");const f=[];if(!this._check(g.tokens.paren_right))do{if(this._check(g.tokens.paren_right))break;const R=this._attribute(),Y=this._consume(g.tokens.ident,"Expected argument name.").toString();this._consume(g.tokens.colon,"Expected ':' for argument type.");const W=this._attribute(),Q=this._type_decl();Q!=null&&(Q.attributes=W,f.push(new Tl(Y,Q,R)))}while(this._match(g.tokens.comma));this._consume(g.tokens.paren_right,"Expected ')' after function arguments.");let _=null;if(this._match(g.tokens.arrow)){const R=this._attribute();_=this._type_decl(),_!=null&&(_.attributes=R)}const x=this._compound_statement(),q=this._currentLine;return new wr(r,f,_,x,t,q)}_compound_statement(){const t=[];for(this._consume(g.tokens.brace_left,"Expected '{' for block.");!this._check(g.tokens.brace_right);){const r=this._statement();r!==null&&t.push(r)}return this._consume(g.tokens.brace_right,"Expected '}' for block."),t}_statement(){for(;this._match(g.tokens.semicolon)&&!this._isAtEnd(););if(this._check(g.tokens.attr)&&this._attribute(),this._check(g.keywords.if))return this._if_statement();if(this._check(g.keywords.switch))return this._switch_statement();if(this._check(g.keywords.loop))return this._loop_statement();if(this._check(g.keywords.for))return this._for_statement();if(this._check(g.keywords.while))return this._while_statement();if(this._check(g.keywords.continuing))return this._continuing_statement();if(this._check(g.keywords.static_assert))return this._static_assert_statement();if(this._check(g.tokens.brace_left))return this._compound_statement();let t=null;return this._check(g.keywords.return)?t=this._return_statement():this._check([g.keywords.var,g.keywords.let,g.keywords.const])?t=this._variable_statement():this._match(g.keywords.discard)?t=new ml:this._match(g.keywords.break)?t=new vl:this._match(g.keywords.continue)?t=new wl:t=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),t!=null&&this._consume(g.tokens.semicolon,"Expected ';' after statement."),t}_static_assert_statement(){if(!this._match(g.keywords.static_assert))return null;const t=this._optional_paren_expression();return new sl(t)}_while_statement(){if(!this._match(g.keywords.while))return null;const t=this._optional_paren_expression();this._check(g.tokens.attr)&&this._attribute();const r=this._compound_statement();return new al(t,r)}_continuing_statement(){if(!this._match(g.keywords.continuing))return null;const t=this._compound_statement();return new ol(t)}_for_statement(){if(!this._match(g.keywords.for))return null;this._consume(g.tokens.paren_left,"Expected '('.");const t=this._check(g.tokens.semicolon)?null:this._for_init();this._consume(g.tokens.semicolon,"Expected ';'.");const r=this._check(g.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(g.tokens.semicolon,"Expected ';'.");const f=this._check(g.tokens.paren_right)?null:this._for_increment();this._consume(g.tokens.paren_right,"Expected ')'."),this._check(g.tokens.attr)&&this._attribute();const _=this._compound_statement();return new il(t,r,f,_)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(g.keywords.var)){const t=this._variable_decl();if(t===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(g.tokens.equal)&&(r=this._short_circuit_or_expression()),new We(t.name,t.type,t.storage,t.access,r)}if(this._match(g.keywords.let)){const t=this._consume(g.tokens.ident,"Expected name for let.").toString();let r=null;if(this._match(g.tokens.colon)){const _=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=_)}this._consume(g.tokens.equal,"Expected '=' for let.");const f=this._short_circuit_or_expression();return new yr(t,r,null,null,f)}if(this._match(g.keywords.const)){const t=this._consume(g.tokens.ident,"Expected name for const.").toString();let r=null;if(this._match(g.tokens.colon)){const _=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=_)}this._consume(g.tokens.equal,"Expected '=' for const.");const f=this._short_circuit_or_expression();return new Zs(t,r,null,null,f)}return null}_increment_decrement_statement(){const t=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(g.increment_operators))return this._current=t,null;const f=this._consume(g.increment_operators,"Expected increment operator");return new cl(f.type===g.tokens.plus_plus?pn.increment:pn.decrement,r)}_assignment_statement(){let t=null;if(this._check(g.tokens.brace_right))return null;let r=this._match(g.tokens.underscore);if(r||(t=this._unary_expression()),!r&&t==null)return null;const f=this._consume(g.assignment_operators,"Expected assignment operator."),_=this._short_circuit_or_expression();return new ul(xn.parse(f.lexeme),t,_)}_func_call_statement(){if(!this._check(g.tokens.ident))return null;const t=this._current,r=this._consume(g.tokens.ident,"Expected function name."),f=this._argument_expression_list();return f===null?(this._current=t,null):new ga(r.lexeme,f)}_loop_statement(){if(!this._match(g.keywords.loop))return null;this._check(g.tokens.attr)&&this._attribute(),this._consume(g.tokens.brace_left,"Expected '{' for loop.");const t=[];let r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let _ of r)t.push(_);else t.push(r);r=this._statement()}let f=null;return this._match(g.keywords.continuing)&&(f=this._compound_statement()),this._consume(g.tokens.brace_right,"Expected '}' for loop."),new ll(t,f)}_switch_statement(){if(!this._match(g.keywords.switch))return null;const t=this._optional_paren_expression();this._check(g.tokens.attr)&&this._attribute(),this._consume(g.tokens.brace_left,"Expected '{' for switch.");const r=this._switch_body();if(r==null||r.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(g.tokens.brace_right,"Expected '}' for switch."),new fl(t,r)}_switch_body(){const t=[];if(this._match(g.keywords.case)){const r=this._case_selectors();this._match(g.tokens.colon),this._check(g.tokens.attr)&&this._attribute(),this._consume(g.tokens.brace_left,"Exected '{' for switch case.");const f=this._case_body();this._consume(g.tokens.brace_right,"Exected '}' for switch case."),t.push(new Al(r,f))}if(this._match(g.keywords.default)){this._match(g.tokens.colon),this._check(g.tokens.attr)&&this._attribute(),this._consume(g.tokens.brace_left,"Exected '{' for switch default.");const r=this._case_body();this._consume(g.tokens.brace_right,"Exected '}' for switch default."),t.push(new El(r))}if(this._check([g.keywords.default,g.keywords.case])){const r=this._switch_body();t.push(r[0])}return t}_case_selectors(){const t=[this._shift_expression()];for(;this._match(g.tokens.comma);)t.push(this._shift_expression());return t}_case_body(){if(this._match(g.keywords.fallthrough))return this._consume(g.tokens.semicolon,"Expected ';'"),[];let t=this._statement();if(t==null)return[];t instanceof Array||(t=[t]);const r=this._case_body();return r.length==0?t:[...t,r[0]]}_if_statement(){if(!this._match(g.keywords.if))return null;const t=this._optional_paren_expression();this._check(g.tokens.attr)&&this._attribute();const r=this._compound_statement();let f=[];this._match_elseif()&&(this._check(g.tokens.attr)&&this._attribute(),f=this._elseif_statement(f));let _=null;return this._match(g.keywords.else)&&(this._check(g.tokens.attr)&&this._attribute(),_=this._compound_statement()),new hl(t,r,f,_)}_match_elseif(){return this._tokens[this._current].type===g.keywords.else&&this._tokens[this._current+1].type===g.keywords.if?(this._advance(),this._advance(),!0):!1}_elseif_statement(t=[]){const r=this._optional_paren_expression(),f=this._compound_statement();return t.push(new zl(r,f)),this._match_elseif()&&(this._check(g.tokens.attr)&&this._attribute(),this._elseif_statement(t)),t}_return_statement(){if(!this._match(g.keywords.return))return null;const t=this._short_circuit_or_expression();return new dl(t)}_short_circuit_or_expression(){let t=this._short_circuit_and_expr();for(;this._match(g.tokens.or_or);)t=new ze(this._previous().toString(),t,this._short_circuit_and_expr());return t}_short_circuit_and_expr(){let t=this._inclusive_or_expression();for(;this._match(g.tokens.and_and);)t=new ze(this._previous().toString(),t,this._inclusive_or_expression());return t}_inclusive_or_expression(){let t=this._exclusive_or_expression();for(;this._match(g.tokens.or);)t=new ze(this._previous().toString(),t,this._exclusive_or_expression());return t}_exclusive_or_expression(){let t=this._and_expression();for(;this._match(g.tokens.xor);)t=new ze(this._previous().toString(),t,this._and_expression());return t}_and_expression(){let t=this._equality_expression();for(;this._match(g.tokens.and);)t=new ze(this._previous().toString(),t,this._equality_expression());return t}_equality_expression(){const t=this._relational_expression();return this._match([g.tokens.equal_equal,g.tokens.not_equal])?new ze(this._previous().toString(),t,this._relational_expression()):t}_relational_expression(){let t=this._shift_expression();for(;this._match([g.tokens.less_than,g.tokens.greater_than,g.tokens.less_than_equal,g.tokens.greater_than_equal]);)t=new ze(this._previous().toString(),t,this._shift_expression());return t}_shift_expression(){let t=this._additive_expression();for(;this._match([g.tokens.shift_left,g.tokens.shift_right]);)t=new ze(this._previous().toString(),t,this._additive_expression());return t}_additive_expression(){let t=this._multiplicative_expression();for(;this._match([g.tokens.plus,g.tokens.minus]);)t=new ze(this._previous().toString(),t,this._multiplicative_expression());return t}_multiplicative_expression(){let t=this._unary_expression();for(;this._match([g.tokens.star,g.tokens.forward_slash,g.tokens.modulo]);)t=new ze(this._previous().toString(),t,this._unary_expression());return t}_unary_expression(){return this._match([g.tokens.minus,g.tokens.bang,g.tokens.tilde,g.tokens.star,g.tokens.and])?new Ml(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const t=this._primary_expression(),r=this._postfix_expression();return r&&(t.postfix=r),t}_postfix_expression(){if(this._match(g.tokens.bracket_left)){const t=this._short_circuit_or_expression();this._consume(g.tokens.bracket_right,"Expected ']'.");const r=new xl(t),f=this._postfix_expression();return f&&(r.postfix=f),r}if(this._match(g.tokens.period)){const t=this._consume(g.tokens.ident,"Expected member name."),r=this._postfix_expression(),f=new Hs(t.lexeme);return r&&(f.postfix=r),f}return null}_getStruct(t){return this._context.aliases.has(t)?this._context.aliases.get(t).type:this._context.structs.has(t)?this._context.structs.get(t):null}_primary_expression(){if(this._match(g.tokens.ident)){const f=this._previous().toString();if(this._check(g.tokens.paren_left)){const _=this._argument_expression_list(),x=this._getStruct(f);return x!=null?new hn(x,_):new ya(f,_)}if(this._context.constants.has(f)){const _=this._context.constants.get(f);return new js(f,_.value)}return new br(f)}if(this._match(g.const_literal))return new Qs(parseFloat(this._previous().toString()));if(this._check(g.tokens.paren_left))return this._paren_expression();if(this._match(g.keywords.bitcast)){this._consume(g.tokens.less_than,"Expected '<'.");const f=this._type_decl();this._consume(g.tokens.greater_than,"Expected '>'.");const _=this._paren_expression();return new bl(f,_)}const t=this._type_decl(),r=this._argument_expression_list();return new kl(t,r)}_argument_expression_list(){if(!this._match(g.tokens.paren_left))return null;const t=[];do{if(this._check(g.tokens.paren_right))break;const r=this._short_circuit_or_expression();t.push(r)}while(this._match(g.tokens.comma));return this._consume(g.tokens.paren_right,"Expected ')' for agument list"),t}_optional_paren_expression(){this._match(g.tokens.paren_left);const t=this._short_circuit_or_expression();return this._match(g.tokens.paren_right),new Js([t])}_paren_expression(){this._consume(g.tokens.paren_left,"Expected '('.");const t=this._short_circuit_or_expression();return this._consume(g.tokens.paren_right,"Expected ')'."),new Js([t])}_struct_decl(){if(!this._match(g.keywords.struct))return null;const t=this._currentLine,r=this._consume(g.tokens.ident,"Expected name for struct.").toString();this._consume(g.tokens.brace_left,"Expected '{' for struct body.");const f=[];for(;!this._check(g.tokens.brace_right);){const q=this._attribute(),R=this._consume(g.tokens.ident,"Expected variable name.").toString();this._consume(g.tokens.colon,"Expected ':' for struct member type.");const Y=this._attribute(),W=this._type_decl();W!=null&&(W.attributes=Y),this._check(g.tokens.brace_right)?this._match(g.tokens.comma):this._consume(g.tokens.comma,"Expected ',' for struct member."),f.push(new Sl(R,W,q))}this._consume(g.tokens.brace_right,"Expected '}' after struct body.");const _=this._currentLine,x=new Xe(r,f,t,_);return this._context.structs.set(r,x),x}_global_variable_decl(){const t=this._variable_decl();return t&&this._match(g.tokens.equal)&&(t.value=this._const_expression()),t}_override_variable_decl(){const t=this._override_decl();return t&&this._match(g.tokens.equal)&&(t.value=this._const_expression()),t}_global_const_decl(){if(!this._match(g.keywords.const))return null;const t=this._consume(g.tokens.ident,"Expected variable name");let r=null;if(this._match(g.tokens.colon)){const x=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=x)}let f=null;if(this._match(g.tokens.equal)){const x=this._short_circuit_or_expression();if(x instanceof hn)f=x;else if(x instanceof js&&x.initializer instanceof hn)f=x.initializer;else try{const q=x.evaluate(this._context);f=new Qs(q)}catch{f=x}}const _=new Zs(t.toString(),r,"","",f);return this._context.constants.set(_.name,_),_}_global_let_decl(){if(!this._match(g.keywords.let))return null;const t=this._consume(g.tokens.ident,"Expected variable name");let r=null;if(this._match(g.tokens.colon)){const _=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=_)}let f=null;return this._match(g.tokens.equal)&&(f=this._const_expression()),new yr(t.toString(),r,"","",f)}_const_expression(){if(this._match(g.const_literal))return new Hs(this._previous().toString());const t=this._type_decl();this._consume(g.tokens.paren_left,"Expected '('.");let r=[];for(;!this._check(g.tokens.paren_right)&&(r.push(this._const_expression()),!!this._check(g.tokens.comma));)this._advance();return this._consume(g.tokens.paren_right,"Expected ')'."),new hn(t,r)}_variable_decl(){if(!this._match(g.keywords.var))return null;let t="",r="";this._match(g.tokens.less_than)&&(t=this._consume(g.storage_class,"Expected storage_class.").toString(),this._match(g.tokens.comma)&&(r=this._consume(g.access_mode,"Expected access_mode.").toString()),this._consume(g.tokens.greater_than,"Expected '>'."));const f=this._consume(g.tokens.ident,"Expected variable name");let _=null;if(this._match(g.tokens.colon)){const x=this._attribute();_=this._type_decl(),_!=null&&(_.attributes=x)}return new We(f.toString(),_,t,r,null)}_override_decl(){if(!this._match(g.keywords.override))return null;const t=this._consume(g.tokens.ident,"Expected variable name");let r=null;if(this._match(g.tokens.colon)){const f=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=f)}return new _a(t.toString(),r,null)}_diagnostic(){this._consume(g.tokens.paren_left,"Expected '('");const t=this._consume(g.tokens.ident,"Expected severity control name.");this._consume(g.tokens.comma,"Expected ','");const r=this._consume(g.tokens.ident,"Expected diagnostic rule name.");return this._consume(g.tokens.paren_right,"Expected ')'"),new gl(t.toString(),r.toString())}_enable_directive(){const t=this._consume(g.tokens.ident,"identity expected.");return new pl(t.toString())}_requires_directive(){const t=[this._consume(g.tokens.ident,"identity expected.").toString()];for(;this._match(g.tokens.comma);){const r=this._consume(g.tokens.ident,"identity expected.");t.push(r.toString())}return new _l(t)}_type_alias(){const t=this._consume(g.tokens.ident,"identity expected.");this._consume(g.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);const f=new ma(t.toString(),r);return this._context.aliases.set(f.name,f),f}_type_decl(){if(this._check([g.tokens.ident,...g.texel_format,g.keywords.bool,g.keywords.f32,g.keywords.i32,g.keywords.u32])){const f=this._advance(),_=f.toString();return this._context.structs.has(_)?this._context.structs.get(_):this._context.aliases.has(_)?this._context.aliases.get(_).type:new Ze(f.toString())}let t=this._texture_sampler_types();if(t)return t;if(this._check(g.template_types)){let f=this._advance().toString(),_=null,x=null;return this._match(g.tokens.less_than)&&(_=this._type_decl(),x=null,this._match(g.tokens.comma)&&(x=this._consume(g.access_mode,"Expected access_mode for pointer").toString()),this._consume(g.tokens.greater_than,"Expected '>' for type.")),new va(f,_,x)}if(this._match(g.keywords.ptr)){let f=this._previous().toString();this._consume(g.tokens.less_than,"Expected '<' for pointer.");const _=this._consume(g.storage_class,"Expected storage_class for pointer");this._consume(g.tokens.comma,"Expected ',' for pointer.");const x=this._type_decl();let q=null;return this._match(g.tokens.comma)&&(q=this._consume(g.access_mode,"Expected access_mode for pointer").toString()),this._consume(g.tokens.greater_than,"Expected '>' for pointer."),new yl(f,_.toString(),x,q)}const r=this._attribute();if(this._match(g.keywords.array)){let f=null,_=-1;const x=this._previous();let q=null;if(this._match(g.tokens.less_than)){f=this._type_decl(),this._context.aliases.has(f.name)&&(f=this._context.aliases.get(f.name).type);let Y="";if(this._match(g.tokens.comma)){q=this._shift_expression();try{Y=q.evaluate(this._context).toString(),q=null}catch{Y="1"}}this._consume(g.tokens.greater_than,"Expected '>' for array."),_=Y?parseInt(Y):0}const R=new wa(x.toString(),r,f,_);return q&&this._deferArrayCountEval.push({arrayType:R,countNode:q}),R}return null}_texture_sampler_types(){if(this._match(g.sampler_type))return new bn(this._previous().toString(),null,null);if(this._match(g.depth_texture_type))return new bn(this._previous().toString(),null,null);if(this._match(g.sampled_texture_type)||this._match(g.multisampled_texture_type)){const t=this._previous();this._consume(g.tokens.less_than,"Expected '<' for sampler type.");const r=this._type_decl();return this._consume(g.tokens.greater_than,"Expected '>' for sampler type."),new bn(t.toString(),r,null)}if(this._match(g.storage_texture_type)){const t=this._previous();this._consume(g.tokens.less_than,"Expected '<' for sampler type.");const r=this._consume(g.texel_format,"Invalid texel format.").toString();this._consume(g.tokens.comma,"Expected ',' after texel format.");const f=this._consume(g.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(g.tokens.greater_than,"Expected '>' for sampler type."),new bn(t.toString(),r,f)}return null}_attribute(){let t=[];for(;this._match(g.tokens.attr);){const r=this._consume(g.attribute_name,"Expected attribute name"),f=new Ks(r.toString(),null);if(this._match(g.tokens.paren_left)){if(f.value=this._consume(g.literal_or_ident,"Expected attribute value").toString(),this._check(g.tokens.comma)){this._advance();do{const _=this._consume(g.literal_or_ident,"Expected attribute value").toString();f.value instanceof Array||(f.value=[f.value]),f.value.push(_)}while(this._match(g.tokens.comma))}this._consume(g.tokens.paren_right,"Expected ')'")}t.push(f)}for(;this._match(g.tokens.attr_left);){if(!this._check(g.tokens.attr_right))do{const r=this._consume(g.attribute_name,"Expected attribute name"),f=new Ks(r.toString(),null);if(this._match(g.tokens.paren_left)){if(f.value=[this._consume(g.literal_or_ident,"Expected attribute value").toString()],this._check(g.tokens.comma)){this._advance();do{const _=this._consume(g.literal_or_ident,"Expected attribute value").toString();f.value.push(_)}while(this._match(g.tokens.comma))}this._consume(g.tokens.paren_right,"Expected ')'")}t.push(f)}while(this._match(g.tokens.comma));this._consume(g.tokens.attr_right,"Expected ']]' after attribute declarations")}return t.length==0?null:t}}class dn{constructor(t,r){this.name=t,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class ta{constructor(t,r,f){this.name=t,this.type=r,this.attributes=f,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Nn extends dn{constructor(t,r){super(t,r),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class dr extends dn{constructor(t,r){super(t,r),this.count=0,this.stride=0}get isArray(){return!0}}class ea extends dn{constructor(t,r,f,_){super(t,f),this.format=r,this.access=_}get isTemplate(){return!0}}var te;(function(n){n[n.Uniform=0]="Uniform",n[n.Storage=1]="Storage",n[n.Texture=2]="Texture",n[n.Sampler=3]="Sampler",n[n.StorageTexture=4]="StorageTexture"})(te||(te={}));class Fn{constructor(t,r,f,_,x,q,R){this.name=t,this.type=r,this.group=f,this.binding=_,this.attributes=x,this.resourceType=q,this.access=R}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class ql{constructor(t,r){this.name=t,this.type=r}}class Ln{constructor(t,r){this.align=t,this.size=r}}class Il{constructor(t,r,f,_){this.name=t,this.type=r,this.locationType=f,this.location=_,this.interpolation=null}}class na{constructor(t,r,f,_){this.name=t,this.type=r,this.locationType=f,this.location=_}}class Nl{constructor(t,r=null){this.stage=null,this.inputs=[],this.outputs=[],this.resources=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=t,this.stage=r}}class Fl{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class Ll{constructor(t,r,f,_){this.name=t,this.type=r,this.attributes=f,this.id=_}}class Vl{constructor(t){this.resources=null,this.inUse=!1,this.info=null,this.node=t}}class qe{constructor(t){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new Fl,this.functions=[],this._types=new Map,this._functions=new Map,t&&this.update(t)}_isStorageTexture(t){return t.name=="texture_storage_1d"||t.name=="texture_storage_2d"||t.name=="texture_storage_2d_array"||t.name=="texture_storage_3d"}update(t){const f=new $l().parse(t);for(const _ of f)_ instanceof wr&&this._functions.set(_.name,new Vl(_));for(const _ of f)if(_ instanceof Xe){const x=this._getTypeInfo(_,null);x instanceof Nn&&this.structs.push(x)}for(const _ of f){if(_ instanceof ma){this.aliases.push(this._getAliasInfo(_));continue}if(_ instanceof _a){const x=_,q=this._getAttributeNum(x.attributes,"id",0),R=x.type!=null?this._getTypeInfo(x.type,x.attributes):null;this.overrides.push(new Ll(x.name,R,x.attributes,q));continue}if(this._isUniformVar(_)){const x=_,q=this._getAttributeNum(x.attributes,"group",0),R=this._getAttributeNum(x.attributes,"binding",0),Y=this._getTypeInfo(x.type,x.attributes),W=new Fn(x.name,Y,q,R,x.attributes,te.Uniform,x.access);this.uniforms.push(W);continue}if(this._isStorageVar(_)){const x=_,q=this._getAttributeNum(x.attributes,"group",0),R=this._getAttributeNum(x.attributes,"binding",0),Y=this._getTypeInfo(x.type,x.attributes),W=this._isStorageTexture(Y),Q=new Fn(x.name,Y,q,R,x.attributes,W?te.StorageTexture:te.Storage,x.access);this.storage.push(Q);continue}if(this._isTextureVar(_)){const x=_,q=this._getAttributeNum(x.attributes,"group",0),R=this._getAttributeNum(x.attributes,"binding",0),Y=this._getTypeInfo(x.type,x.attributes),W=this._isStorageTexture(Y),Q=new Fn(x.name,Y,q,R,x.attributes,W?te.StorageTexture:te.Texture,x.access);W?this.storage.push(Q):this.textures.push(Q);continue}if(this._isSamplerVar(_)){const x=_,q=this._getAttributeNum(x.attributes,"group",0),R=this._getAttributeNum(x.attributes,"binding",0),Y=this._getTypeInfo(x.type,x.attributes),W=new Fn(x.name,Y,q,R,x.attributes,te.Sampler,x.access);this.samplers.push(W);continue}if(_ instanceof wr){const x=this._getAttribute(_,"vertex"),q=this._getAttribute(_,"fragment"),R=this._getAttribute(_,"compute"),Y=x||q||R,W=new Nl(_.name,Y==null?void 0:Y.name);W.startLine=_.startLine,W.endLine=_.endLine,this.functions.push(W),this._functions.get(_.name).info=W,Y&&(this._functions.get(_.name).inUse=!0,W.inUse=!0,W.resources=this._findResources(_,!!Y),W.inputs=this._getInputs(_.args),W.outputs=this._getOutputs(_.returnType),this.entry[Y.name].push(W));continue}}for(const _ of this._functions.values())_.info&&(_.info.inUse=_.inUse,this._addCalls(_.node,_.info.calls));for(const _ of this.uniforms)this._markStructsInUse(_.type);for(const _ of this.storage)this._markStructsInUse(_.type)}_markStructsInUse(t){if(t.isStruct){t.inUse=!0;for(const r of t.members)this._markStructsInUse(r.type)}else if(t.isArray)this._markStructsInUse(t.format);else if(t.isTemplate)this._markStructsInUse(t.format);else{const r=this._getAlias(t.name);r&&this._markStructsInUse(r)}}_addCalls(t,r){var f;for(const _ of t.calls){const x=(f=this._functions.get(_.name))===null||f===void 0?void 0:f.info;x&&r.add(x)}}findResource(t,r){for(const f of this.uniforms)if(f.group==t&&f.binding==r)return f;for(const f of this.storage)if(f.group==t&&f.binding==r)return f;for(const f of this.textures)if(f.group==t&&f.binding==r)return f;for(const f of this.samplers)if(f.group==t&&f.binding==r)return f;return null}_findResource(t){for(const r of this.uniforms)if(r.name==t)return r;for(const r of this.storage)if(r.name==t)return r;for(const r of this.textures)if(r.name==t)return r;for(const r of this.samplers)if(r.name==t)return r;return null}_markStructsFromAST(t){const r=this._getTypeInfo(t,null);this._markStructsInUse(r)}_findResources(t,r){const f=[],_=this,x=[];return t.search(q=>{if(q instanceof Vn)x.push({});else if(q instanceof Pn)x.pop();else if(q instanceof We){const R=q;r&&R.type!==null&&this._markStructsFromAST(R.type),x.length>0&&(x[x.length-1][R.name]=R)}else if(q instanceof hn){const R=q;r&&R.type!==null&&this._markStructsFromAST(R.type)}else if(q instanceof yr){const R=q;r&&R.type!==null&&this._markStructsFromAST(R.type),x.length>0&&(x[x.length-1][R.name]=R)}else if(q instanceof br){const R=q;if(x.length>0&&x[x.length-1][R.name])return;const Y=_._findResource(R.name);Y&&f.push(Y)}else if(q instanceof ya){const R=q,Y=_._functions.get(R.name);Y&&(r&&(Y.inUse=!0),t.calls.add(Y.node),Y.resources===null&&(Y.resources=_._findResources(Y.node,r)),f.push(...Y.resources))}else if(q instanceof ga){const R=q,Y=_._functions.get(R.name);Y&&(r&&(Y.inUse=!0),t.calls.add(Y.node),Y.resources===null&&(Y.resources=_._findResources(Y.node,r)),f.push(...Y.resources))}}),[...new Map(f.map(q=>[q.name,q])).values()]}getBindGroups(){const t=[];function r(f,_){f>=t.length&&(t.length=f+1),t[f]===void 0&&(t[f]=[]),_>=t[f].length&&(t[f].length=_+1)}for(const f of this.uniforms){r(f.group,f.binding);const _=t[f.group];_[f.binding]=f}for(const f of this.storage){r(f.group,f.binding);const _=t[f.group];_[f.binding]=f}for(const f of this.textures){r(f.group,f.binding);const _=t[f.group];_[f.binding]=f}for(const f of this.samplers){r(f.group,f.binding);const _=t[f.group];_[f.binding]=f}return t}_getOutputs(t,r=void 0){if(r===void 0&&(r=[]),t instanceof Xe)this._getStructOutputs(t,r);else{const f=this._getOutputInfo(t);f!==null&&r.push(f)}return r}_getStructOutputs(t,r){for(const f of t.members)if(f.type instanceof Xe)this._getStructOutputs(f.type,r);else{const _=this._getAttribute(f,"location")||this._getAttribute(f,"builtin");if(_!==null){const x=this._getTypeInfo(f.type,f.type.attributes),q=this._parseInt(_.value),R=new na(f.name,x,_.name,q);r.push(R)}}}_getOutputInfo(t){const r=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(r!==null){const f=this._getTypeInfo(t,t.attributes),_=this._parseInt(r.value);return new na("",f,r.name,_)}return null}_getInputs(t,r=void 0){r===void 0&&(r=[]);for(const f of t)if(f.type instanceof Xe)this._getStructInputs(f.type,r);else{const _=this._getInputInfo(f);_!==null&&r.push(_)}return r}_getStructInputs(t,r){for(const f of t.members)if(f.type instanceof Xe)this._getStructInputs(f.type,r);else{const _=this._getInputInfo(f);_!==null&&r.push(_)}}_getInputInfo(t){const r=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(r!==null){const f=this._getAttribute(t,"interpolation"),_=this._getTypeInfo(t.type,t.attributes),x=this._parseInt(r.value),q=new Il(t.name,_,r.name,x);return f!==null&&(q.interpolation=this._parseString(f.value)),q}return null}_parseString(t){return t instanceof Array&&(t=t[0]),t}_parseInt(t){t instanceof Array&&(t=t[0]);const r=parseInt(t);return isNaN(r)?t:r}_getAlias(t){for(const r of this.aliases)if(r.name==t)return r.type;return null}_getAliasInfo(t){return new ql(t.name,this._getTypeInfo(t.type,null))}_getTypeInfo(t,r){if(this._types.has(t))return this._types.get(t);if(t instanceof wa){const _=t,x=this._getTypeInfo(_.format,_.attributes),q=new dr(_.name,r);return q.format=x,q.count=_.count,this._types.set(t,q),this._updateTypeInfo(q),q}if(t instanceof Xe){const _=t,x=new Nn(_.name,r);x.startLine=_.startLine,x.endLine=_.endLine;for(const q of _.members){const R=this._getTypeInfo(q.type,q.attributes);x.members.push(new ta(q.name,R,q.attributes))}return this._types.set(t,x),this._updateTypeInfo(x),x}if(t instanceof bn){const _=t,x=_.format instanceof Ze,q=_.format?x?this._getTypeInfo(_.format,null):new dn(_.format,null):null,R=new ea(_.name,q,r,_.access);return this._types.set(t,R),this._updateTypeInfo(R),R}if(t instanceof va){const _=t,x=_.format?this._getTypeInfo(_.format,null):null,q=new ea(_.name,x,r,_.access);return this._types.set(t,q),this._updateTypeInfo(q),q}const f=new dn(t.name,r);return this._types.set(t,f),this._updateTypeInfo(f),f}_updateTypeInfo(t){var r,f;const _=this._getTypeSize(t);if(t.size=(r=_==null?void 0:_.size)!==null&&r!==void 0?r:0,t instanceof dr){const x=this._getTypeSize(t.format);t.stride=(f=x==null?void 0:x.size)!==null&&f!==void 0?f:0,this._updateTypeInfo(t.format)}t instanceof Nn&&this._updateStructInfo(t)}_updateStructInfo(t){var r;let f=0,_=0,x=0,q=0;for(let R=0,Y=t.members.length;R<Y;++R){const W=t.members[R],Q=this._getTypeSize(W);if(!Q)continue;(r=this._getAlias(W.type.name))!==null&&r!==void 0||W.type;const rt=Q.align,it=Q.size;f=this._roundUp(rt,f+_),_=it,x=f,q=Math.max(q,rt),W.offset=f,W.size=it,this._updateTypeInfo(W.type)}t.size=this._roundUp(q,x+_),t.align=q}_getTypeSize(t){var r;if(t==null)return null;const f=this._getAttributeNum(t.attributes,"size",0),_=this._getAttributeNum(t.attributes,"align",0);if(t instanceof ta&&(t=t.type),t instanceof dn){const x=this._getAlias(t.name);x!==null&&(t=x)}{const x=qe._typeInfo[t.name];if(x!==void 0){const q=t.format==="f16"?2:1;return new Ln(Math.max(_,x.align/q),Math.max(f,x.size/q))}}{const x=qe._typeInfo[t.name.substring(0,t.name.length-1)];if(x){const q=t.name[t.name.length-1]==="h"?2:1;return new Ln(Math.max(_,x.align/q),Math.max(f,x.size/q))}}if(t instanceof dr){let x=t,q=8,R=8;const Y=this._getTypeSize(x.format);Y!==null&&(R=Y.size,q=Y.align);const W=x.count,Q=this._getAttributeNum((r=t==null?void 0:t.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(q,R));return R=W*Q,f&&(R=f),new Ln(Math.max(_,q),Math.max(f,R))}if(t instanceof Nn){let x=0,q=0,R=0,Y=0,W=0;for(const Q of t.members){const rt=this._getTypeSize(Q.type);rt!==null&&(x=Math.max(rt.align,x),R=this._roundUp(rt.align,R+Y),Y=rt.size,W=R)}return q=this._roundUp(x,W+Y),new Ln(Math.max(_,x),Math.max(f,q))}return null}_isUniformVar(t){return t instanceof We&&t.storage=="uniform"}_isStorageVar(t){return t instanceof We&&t.storage=="storage"}_isTextureVar(t){return t instanceof We&&t.type!==null&&qe._textureTypes.indexOf(t.type.name)!=-1}_isSamplerVar(t){return t instanceof We&&t.type!==null&&qe._samplerTypes.indexOf(t.type.name)!=-1}_getAttribute(t,r){const f=t;if(!f||!f.attributes)return null;const _=f.attributes;for(let x of _)if(x.name==r)return x;return null}_getAttributeNum(t,r,f){if(t===null)return f;for(let _ of t)if(_.name==r){let x=_!==null&&_.value!==null?_.value:f;return x instanceof Array&&(x=x[0]),typeof x=="number"?x:typeof x=="string"?parseInt(x):f}return f}_roundUp(t,r){return Math.ceil(r/t)*t}}qe._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}};qe._textureTypes=g.any_texture_type.map(n=>n.name);qe._samplerTypes=g.sampler_type.map(n=>n.name);function fn(n,t){return Object.fromEntries(t.map(r=>{const f=Rl(n,r,0);return[r.name,{typeDefinition:f,group:r.group,binding:r.binding,size:f.size}]}))}function xa(n,t,r){return{fields:Object.fromEntries(t.members.map(_=>[_.name,{offset:_.offset,type:Mr(n,_.type,0)}])),size:t.size,offset:r}}function Pl(n){var t;if(n.name.includes("depth"))return"depth";switch((t=n.format)==null?void 0:t.name){case"f32":return"float";case"i32":return"sint";case"u32":return"uint";default:throw new Error("unknown texture sample type")}}function ra(n){return n.name.includes("2d_array")?"2d-array":n.name.includes("cube_array")?"cube-array":n.name.includes("3d")?"3d":n.name.includes("1d")?"1d":n.name.includes("cube")?"cube":"2d"}function Ul(n){switch(n.access){case"read":return"read-only";case"write":return"write-only";case"read_write":return"read-write";default:throw new Error("unknonw storage texture access")}}function Ol(n){return n.name.endsWith("_comparison")?"comparison":"filtering"}function Bl(n,t){const{binding:r,access:f,type:_}=n;switch(n.resourceType){case te.Uniform:return{binding:r,visibility:t,buffer:{...n.size&&{minBindingSize:n.size}}};case te.Storage:return{binding:r,visibility:t,buffer:{type:f===""||f==="read"?"read-only-storage":"storage",...n.size&&{minBindingSize:n.size}}};case te.Texture:{if(_.name==="texture_external")return{binding:r,visibility:t,externalTexture:{}};const x=_.name.includes("multisampled");return{binding:r,visibility:t,texture:{sampleType:Pl(_),viewDimension:ra(_),multisampled:x}}}case te.Sampler:return{binding:r,visibility:t,sampler:{type:Ol(_)}};case te.StorageTexture:return{binding:r,visibility:t,storageTexture:{access:Ul(_),format:_.format.name,viewDimension:ra(_)}};default:throw new Error("unknown resource type")}}function pr(n,t){const r={};for(const f of n)r[f.name]={stage:t,resources:f.resources.map(_=>{const{name:x,group:q}=_;return{name:x,group:q,entry:Bl(_,t)}})};return r}function hf(n){const t=new qe(n),r=Object.fromEntries(t.structs.map(Q=>[Q.name,xa(t,Q,0)])),f=fn(t,t.uniforms),_=fn(t,t.storage.filter(Q=>Q.resourceType===te.Storage)),x=fn(t,t.storage.filter(Q=>Q.resourceType===te.StorageTexture)),q=fn(t,t.textures.filter(Q=>Q.type.name!=="texture_external")),R=fn(t,t.textures.filter(Q=>Q.type.name==="texture_external")),Y=fn(t,t.samplers),W={...pr(t.entry.vertex,GPUShaderStage.VERTEX),...pr(t.entry.fragment,GPUShaderStage.FRAGMENT),...pr(t.entry.compute,GPUShaderStage.COMPUTE)};return{externalTextures:R,samplers:Y,structs:r,storages:_,storageTextures:x,textures:q,uniforms:f,entryPoints:W}}function _r(n,t=""){if(!n)throw new Error(t)}function Rl(n,t,r){switch(t.resourceType){case te.Uniform:case te.Storage:case te.StorageTexture:return Mr(n,t.type,r);default:return{size:0,type:t.type.name}}}function Mr(n,t,r){if(t.isArray){_r(!t.isStruct,"struct array is invalid"),_r(!t.isStruct,"template array is invalid");const f=t;return{size:f.size,elementType:Mr(n,f.format,r),numElements:f.count}}else{if(t.isStruct)return _r(!t.isTemplate,"template struct is invalid"),xa(n,t,r);{const f=t,_=t.isTemplate?`${f.name}<${f.format.name}>`:t.name;return{size:t.size,type:_}}}}const Ma=new Map([[Int8Array,{formats:["sint8","snorm8"],defaultForType:1}],[Uint8Array,{formats:["uint8","unorm8"],defaultForType:1}],[Int16Array,{formats:["sint16","snorm16"],defaultForType:1}],[Uint16Array,{formats:["uint16","unorm16"],defaultForType:1}],[Int32Array,{formats:["sint32","snorm32"],defaultForType:0}],[Uint32Array,{formats:["uint32","unorm32"],defaultForType:0}],[Float32Array,{formats:["float32","float32"],defaultForType:0}]]),Gl=new Map([...Ma.entries()].map(([n,{formats:[t,r]}])=>[[t,n],[r,n]]).flat());function Ar(n){return n==="indices"}function Aa(n,t){if(kn(n))return n;let r=n;if(kn(r.data))return r.data;(Array.isArray(n)||typeof n=="number")&&(r={data:n});let f=r.type;return f||(Ar(t)?f=Uint32Array:f=Float32Array),new f(r.data)}function Yl(n){return n.length?n:n.data}const Xl=[{re:/coord|texture|uv/i,numComponents:2},{re:/color|colour/i,numComponents:4}];function Wl(n){for(const{re:t,numComponents:r}of Xl)if(t.test(n))return r;return 3}function Zl(n,t){const r=Wl(n);if(t%r>0)throw new Error(`Can not guess numComponents for attribute '${n}'. Tried ${r} but ${t} values is not evenly divisible by ${r}. You should specify it.`);return r}function Hl(n,t){return n.numComponents||Zl(t,Yl(n).length)}const jl=/(\w+)(?:x(\d))$/;function Ea(n){const t=jl.exec(n),[r,f]=t?[t[1],parseInt(t[2])]:[n,1];return{Type:Gl.get(r),numComponents:f}}function sa(n,t){const r=Object.getPrototypeOf(n).constructor;return new r(t)}function Ql(n,t={}){const r=t.interleave===void 0?!0:t.interleave,f=t.stepMode||"vertex",_=t.shaderLocation?Array.isArray(t.shaderLocation)?t.shaderLocation:[t.shaderLocation]:[0];let x=0;const q=[],R=[],Y=[];return Object.keys(n).filter(W=>!Ar(W)).forEach(W=>{const Q=n[W],rt=Aa(Q,W),it=Hl(Q,W),Mt=it/4,Tt=it/3,O=Mt%1===0?4:Tt%1===0?3:4;for(let et=0;et<it;et+=O){const wt=Math.min(O,it-et),kt=x;x+=wt*rt.BYTES_PER_ELEMENT;const{defaultForType:At,formats:It}=Ma.get(Object.getPrototypeOf(rt).constructor),Ut=Q.normalize,Gt=`${It[typeof Ut>"u"?At:Ut?1:0]}${wt>1?`x${wt}`:""}`,gt=_.shift();_.length===0&&_.push(gt+1),R.push({offset:kt,format:Gt,shaderLocation:gt}),Y.push({data:rt,offset:et,stride:it})}r||(q.push({stepMode:f,arrayStride:x,attributes:R.slice()}),x=0,R.length=0)}),R.length&&q.push({stepMode:f,arrayStride:x,attributes:R}),{bufferLayouts:q,typedArrays:Y}}function Ta(n,t){return kn(n)?{data:n,offset:0,stride:t}:n}function Jl(n,t,r,f){const _=new Map,x=q=>{const R=Object.getPrototypeOf(q).constructor,Y=_.get(R);if(Y)return Y;const W=new R(f);return _.set(R,W),W};n.forEach((q,R)=>{const{offset:Y,format:W}=q,{numComponents:Q}=Ea(W),{data:rt,offset:it,stride:Mt}=Ta(t[R],Q),Tt=x(rt);for(let O=0;O<rt.length;O+=Mt){const et=O/Mt,wt=(Y+et*r)/Tt.BYTES_PER_ELEMENT,kt=O+it,At=rt.subarray(kt,kt+Q);Tt.set(At,wt)}})}function df(n,t,r={}){const f=r.usage||0,{bufferLayouts:_,typedArrays:x}=Ql(t,r),q=[];let R=-1,Y=0;for(const{attributes:rt,arrayStride:it}of _){const Mt=rt,Tt=Mt[0],{numComponents:O}=Ea(Tt.format),{data:et,stride:wt}=Ta(x[Y],O);R<0&&(R=et.length/wt);const kt=it*R,At=n.createBuffer({usage:f|GPUBufferUsage.VERTEX,size:kt,mappedAtCreation:!0}),It=At.getMappedRange();Mt.length===1&&it===et.BYTES_PER_ELEMENT*O?sa(et,It).set(et):Jl(Mt,x.slice(Y),it,It),At.unmap(),q.push(At),Y+=Mt.length}const W={numElements:R,bufferLayouts:_,buffers:q},Q=Object.entries(t).find(([rt])=>Ar(rt));if(Q){const rt=Aa(Q[1],"indices"),it=n.createBuffer({size:rt.byteLength,usage:GPUBufferUsage.INDEX|f,mappedAtCreation:!0});sa(rt,it.getMappedRange()).set(rt),it.unmap(),W.indexBuffer=it,W.indexFormat=rt instanceof Uint16Array?"uint16":"uint32",W.numElements=rt.length}return W}export{of as _,hf as a,lf as b,cf as c,df as d,uf as e,fa as f,ln as l,ue as m,af as r};
