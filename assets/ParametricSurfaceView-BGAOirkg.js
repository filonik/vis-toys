import{w as te,r as T,c as L,i as Pe,p as ke,d as G,o as Ke,a as He,n as Z,b as O,e as N,f as R,u as De,g as $,h as pe,j as _,k as ue,l as A,m as K,t as H,F as ee,q as ie,v as ce,s as Ye,x as We,y as Qe,_ as Xe,z as Je,S as et}from"./index-Dmbptviv.js";import{c as $e,o as F,w as Fe,h as Ve,i as tt,u as nt,A as ne,a as fe,s as at,N as ve,b as V,v as ot,d as ge,_ as Re,O as rt,e as lt,f as st,g as ut,r as C,m as it,j as we,k as q,l as ct,n as dt,p as ft,x as be,I as mt,y as he,q as pt,t as vt,z as se,B as gt,P as wt,C as bt,D as ht,E as xt,F as yt,G as xe}from"./meshes-Dkxnp24-.js";function It(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Mt(){return/Android/gi.test(window.navigator.userAgent)}function St(){return It()||Mt()}function J(e,u,r){$e.isServer||te(i=>{document.addEventListener(e,u,r),i(()=>document.removeEventListener(e,u,r))})}function _t(e,u,r){$e.isServer||te(i=>{window.addEventListener(e,u,r),i(()=>window.removeEventListener(e,u,r))})}function Pt(e,u,r=L(()=>!0)){function i(a,t){if(!r.value||a.defaultPrevented)return;let d=t(a);if(d===null||!d.getRootNode().contains(d))return;let f=function I(v){return typeof v=="function"?I(v()):Array.isArray(v)||v instanceof Set?v:[v]}(e);for(let I of f){if(I===null)continue;let v=I instanceof HTMLElement?I:F(I);if(v!=null&&v.contains(d)||a.composed&&a.composedPath().includes(v))return}return!Fe(d,Ve.Loose)&&d.tabIndex!==-1&&a.preventDefault(),u(a,d)}let c=T(null);J("pointerdown",a=>{var t,d;r.value&&(c.value=((d=(t=a.composedPath)==null?void 0:t.call(a))==null?void 0:d[0])||a.target)},!0),J("mousedown",a=>{var t,d;r.value&&(c.value=((d=(t=a.composedPath)==null?void 0:t.call(a))==null?void 0:d[0])||a.target)},!0),J("click",a=>{St()||c.value&&(i(a,()=>c.value),c.value=null)},!0),J("touchend",a=>i(a,()=>a.target instanceof HTMLElement?a.target:null),!0),_t("blur",a=>i(a,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function ye(e){return[e.screenX,e.screenY]}function kt(){let e=T([-1,-1]);return{wasMoved(u){let r=ye(u);return e.value[0]===r[0]&&e.value[1]===r[1]?!1:(e.value=r,!0)},update(u){e.value=ye(u)}}}function Dt({container:e,accept:u,walk:r,enabled:i}){te(()=>{let c=e.value;if(!c||i!==void 0&&!i.value)return;let a=tt(e);if(!a)return;let t=Object.assign(f=>u(f),{acceptNode:u}),d=a.createTreeWalker(c,NodeFilter.SHOW_ELEMENT,t,!1);for(;d.nextNode();)r(d.currentNode)})}let Ee=Symbol("Context");var Y=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Y||{});function $t(){return Pe(Ee,null)}function Ft(e){ke(Ee,e)}function Vt(e){throw new Error("Unexpected object: "+e)}var U=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(U||{});function Rt(e,u){let r=u.resolveItems();if(r.length<=0)return null;let i=u.resolveActiveIndex(),c=i??-1;switch(e.focus){case 0:{for(let a=0;a<r.length;++a)if(!u.resolveDisabled(r[a],a,r))return a;return i}case 1:{c===-1&&(c=r.length);for(let a=c-1;a>=0;--a)if(!u.resolveDisabled(r[a],a,r))return a;return i}case 2:{for(let a=c+1;a<r.length;++a)if(!u.resolveDisabled(r[a],a,r))return a;return i}case 3:{for(let a=r.length-1;a>=0;--a)if(!u.resolveDisabled(r[a],a,r))return a;return i}case 4:{for(let a=0;a<r.length;++a)if(u.resolveId(r[a],a,r)===e.id)return a;return i}case 5:return null;default:Vt(e)}}let Ie=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Me(e){var u,r;let i=(u=e.innerText)!=null?u:"",c=e.cloneNode(!0);if(!(c instanceof HTMLElement))return i;let a=!1;for(let d of c.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))d.remove(),a=!0;let t=a?(r=c.innerText)!=null?r:"":i;return Ie.test(t)&&(t=t.replace(Ie,"")),t}function Et(e){let u=e.getAttribute("aria-label");if(typeof u=="string")return u.trim();let r=e.getAttribute("aria-labelledby");if(r){let i=r.split(" ").map(c=>{let a=document.getElementById(c);if(a){let t=a.getAttribute("aria-label");return typeof t=="string"?t.trim():Me(a).trim()}return null}).filter(Boolean);if(i.length>0)return i.join(", ")}return Me(e).trim()}function Ct(e){let u=T(""),r=T("");return()=>{let i=F(e);if(!i)return"";let c=i.innerText;if(u.value===c)return r.value;let a=Et(i).trim().toLowerCase();return u.value=c,r.value=a,a}}var Tt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Tt||{}),Ut=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Ut||{});function At(e){requestAnimationFrame(()=>requestAnimationFrame(e))}let Ce=Symbol("MenuContext");function ae(e){let u=Pe(Ce,null);if(u===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,ae),r}return u}let Bt=G({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(e,{slots:u,attrs:r}){let i=T(1),c=T(null),a=T(null),t=T([]),d=T(""),f=T(null),I=T(1);function v(s=b=>b){let b=f.value!==null?t.value[f.value]:null,w=rt(s(t.value.slice()),x=>F(x.dataRef.domRef)),M=b?w.indexOf(b):null;return M===-1&&(M=null),{items:w,activeItemIndex:M}}let p={menuState:i,buttonRef:c,itemsRef:a,items:t,searchQuery:d,activeItemIndex:f,activationTrigger:I,closeMenu:()=>{i.value=1,f.value=null},openMenu:()=>i.value=0,goToItem(s,b,w){let M=v(),x=Rt(s===U.Specific?{focus:U.Specific,id:b}:{focus:s},{resolveItems:()=>M.items,resolveActiveIndex:()=>M.activeItemIndex,resolveId:P=>P.id,resolveDisabled:P=>P.dataRef.disabled});d.value="",f.value=x,I.value=w??1,t.value=M.items},search(s){let b=d.value!==""?0:1;d.value+=s.toLowerCase();let w=(f.value!==null?t.value.slice(f.value+b).concat(t.value.slice(0,f.value+b)):t.value).find(x=>x.dataRef.textValue.startsWith(d.value)&&!x.dataRef.disabled),M=w?t.value.indexOf(w):-1;M===-1||M===f.value||(f.value=M,I.value=1)},clearSearch(){d.value=""},registerItem(s,b){let w=v(M=>[...M,{id:s,dataRef:b}]);t.value=w.items,f.value=w.activeItemIndex,I.value=1},unregisterItem(s){let b=v(w=>{let M=w.findIndex(x=>x.id===s);return M!==-1&&w.splice(M,1),w});t.value=b.items,f.value=b.activeItemIndex,I.value=1}};return Pt([c,a],(s,b)=>{var w;p.closeMenu(),Fe(b,Ve.Loose)||(s.preventDefault(),(w=F(c))==null||w.focus())},L(()=>i.value===0)),ke(Ce,p),Ft(L(()=>nt(i.value,{0:Y.Open,1:Y.Closed}))),()=>{let s={open:i.value===0,close:p.closeMenu};return ne({ourProps:{},theirProps:e,slot:s,slots:u,attrs:r,name:"Menu"})}}}),Ot=G({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(e,{attrs:u,slots:r,expose:i}){var c;let a=(c=e.id)!=null?c:`headlessui-menu-button-${fe()}`,t=ae("MenuButton");i({el:t.buttonRef,$el:t.buttonRef});function d(p){switch(p.key){case V.Space:case V.Enter:case V.ArrowDown:p.preventDefault(),p.stopPropagation(),t.openMenu(),Z(()=>{var s;(s=F(t.itemsRef))==null||s.focus({preventScroll:!0}),t.goToItem(U.First)});break;case V.ArrowUp:p.preventDefault(),p.stopPropagation(),t.openMenu(),Z(()=>{var s;(s=F(t.itemsRef))==null||s.focus({preventScroll:!0}),t.goToItem(U.Last)});break}}function f(p){switch(p.key){case V.Space:p.preventDefault();break}}function I(p){e.disabled||(t.menuState.value===0?(t.closeMenu(),Z(()=>{var s;return(s=F(t.buttonRef))==null?void 0:s.focus({preventScroll:!0})})):(p.preventDefault(),t.openMenu(),At(()=>{var s;return(s=F(t.itemsRef))==null?void 0:s.focus({preventScroll:!0})})))}let v=at(L(()=>({as:e.as,type:u.type})),t.buttonRef);return()=>{var p;let s={open:t.menuState.value===0},{...b}=e,w={ref:t.buttonRef,id:a,type:v.value,"aria-haspopup":"menu","aria-controls":(p=F(t.itemsRef))==null?void 0:p.id,"aria-expanded":t.menuState.value===0,onKeydown:d,onKeyup:f,onClick:I};return ne({ourProps:w,theirProps:b,slot:s,attrs:u,slots:r,name:"MenuButton"})}}}),Lt=G({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(e,{attrs:u,slots:r,expose:i}){var c;let a=(c=e.id)!=null?c:`headlessui-menu-items-${fe()}`,t=ae("MenuItems"),d=T(null);i({el:t.itemsRef,$el:t.itemsRef}),Dt({container:L(()=>F(t.itemsRef)),enabled:L(()=>t.menuState.value===0),accept(s){return s.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:s.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(s){s.setAttribute("role","none")}});function f(s){var b;switch(d.value&&clearTimeout(d.value),s.key){case V.Space:if(t.searchQuery.value!=="")return s.preventDefault(),s.stopPropagation(),t.search(s.key);case V.Enter:if(s.preventDefault(),s.stopPropagation(),t.activeItemIndex.value!==null){let w=t.items.value[t.activeItemIndex.value];(b=F(w.dataRef.domRef))==null||b.click()}t.closeMenu(),Re(F(t.buttonRef));break;case V.ArrowDown:return s.preventDefault(),s.stopPropagation(),t.goToItem(U.Next);case V.ArrowUp:return s.preventDefault(),s.stopPropagation(),t.goToItem(U.Previous);case V.Home:case V.PageUp:return s.preventDefault(),s.stopPropagation(),t.goToItem(U.First);case V.End:case V.PageDown:return s.preventDefault(),s.stopPropagation(),t.goToItem(U.Last);case V.Escape:s.preventDefault(),s.stopPropagation(),t.closeMenu(),Z(()=>{var w;return(w=F(t.buttonRef))==null?void 0:w.focus({preventScroll:!0})});break;case V.Tab:s.preventDefault(),s.stopPropagation(),t.closeMenu(),Z(()=>ot(F(t.buttonRef),s.shiftKey?ge.Previous:ge.Next));break;default:s.key.length===1&&(t.search(s.key),d.value=setTimeout(()=>t.clearSearch(),350));break}}function I(s){switch(s.key){case V.Space:s.preventDefault();break}}let v=$t(),p=L(()=>v!==null?(v.value&Y.Open)===Y.Open:t.menuState.value===0);return()=>{var s,b;let w={open:t.menuState.value===0},{...M}=e,x={"aria-activedescendant":t.activeItemIndex.value===null||(s=t.items.value[t.activeItemIndex.value])==null?void 0:s.id,"aria-labelledby":(b=F(t.buttonRef))==null?void 0:b.id,id:a,onKeydown:f,onKeyup:I,role:"menu",tabIndex:0,ref:t.itemsRef};return ne({ourProps:x,theirProps:M,slot:w,attrs:u,slots:r,features:ve.RenderStrategy|ve.Static,visible:p.value,name:"MenuItems"})}}}),Nt=G({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(e,{slots:u,attrs:r,expose:i}){var c;let a=(c=e.id)!=null?c:`headlessui-menu-item-${fe()}`,t=ae("MenuItem"),d=T(null);i({el:d,$el:d});let f=L(()=>t.activeItemIndex.value!==null?t.items.value[t.activeItemIndex.value].id===a:!1),I=Ct(d),v=L(()=>({disabled:e.disabled,get textValue(){return I()},domRef:d}));Ke(()=>t.registerItem(a,v)),He(()=>t.unregisterItem(a)),te(()=>{t.menuState.value===0&&f.value&&t.activationTrigger.value!==0&&Z(()=>{var P,D;return(D=(P=F(d))==null?void 0:P.scrollIntoView)==null?void 0:D.call(P,{block:"nearest"})})});function p(P){if(e.disabled)return P.preventDefault();t.closeMenu(),Re(F(t.buttonRef))}function s(){if(e.disabled)return t.goToItem(U.Nothing);t.goToItem(U.Specific,a)}let b=kt();function w(P){b.update(P)}function M(P){b.wasMoved(P)&&(e.disabled||f.value||t.goToItem(U.Specific,a,0))}function x(P){b.wasMoved(P)&&(e.disabled||f.value&&t.goToItem(U.Nothing))}return()=>{let{disabled:P,...D}=e,E={active:f.value,disabled:P,close:t.closeMenu};return ne({ourProps:{id:a,ref:d,role:"menuitem",tabIndex:P===!0?void 0:-1,"aria-disabled":P===!0?!0:void 0,onClick:p,onFocus:s,onPointerenter:w,onMouseenter:w,onPointermove:M,onMousemove:M,onPointerleave:x,onMouseleave:x},theirProps:{...r,...D},slot:E,attrs:r,slots:u,name:"MenuItem"})}}});const Gt=e=>u=>u.map(e),zt=e=>e.length,qt=e=>Math.min(...e),Zt=e=>qt(e.map(zt)),jt=e=>(...u)=>Array.from({length:Zt(u)},(r,i)=>e(...u.map(c=>c[i]))),Kt=jt,Te=Kt,Ht=Te(st),Yt=Te(ut),Wt=e=>(u,r)=>Gt(i=>e(i,r))(u),Se=Wt(lt);function Qt(e,u){return O(),N("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[R("path",{d:"M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z"}),R("path",{d:"M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z"}),R("path",{d:"M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z"})])}function Xt(e,u){return O(),N("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[R("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),R("path",{"fill-rule":"evenodd",d:"M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z","clip-rule":"evenodd"})])}const Jt=G({__name:"ToggleVisibleButton",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:u}){const c=De(e,"modelValue",u),a=()=>{c.value=!c.value};return(t,d)=>(O(),N("button",{class:"rounded-lg p-2",type:"button",onClick:d[0]||(d[0]=f=>a())},[$(_(Qt),{class:pe(["w-5 h-5",[_(c)?"hidden":"visible"]])},null,8,["class"]),$(_(Xt),{class:pe(["w-5 h-5",[_(c)?"visible":"hidden"]])},null,8,["class"])]))}}),en=["onUpdate:modelValue"],tn=["onUpdate:modelValue"],nn=G({__name:"ExtentInput",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:u}){const c=De(e,"modelValue",u),a=(f,I)=>{c.value=[c.value[0].map((v,p)=>I==p?f[0]:v),c.value[1].map((v,p)=>I==p?f[1]:v)]},t=L(()=>C(0,c.value[0].length)),d=[{name:"-1, +1",value:[-1,1]},{name:"-π, +π",value:[-Math.PI,+Math.PI]},{name:"-π/2, +π/2",value:[-Math.PI/2,+Math.PI/2]}];return(f,I)=>(O(!0),N(ee,null,ue(t.value,v=>(O(),N("div",{class:"flex flex-row items-center gap-2",key:v},[$(_(Bt),{as:"div",class:"relative inline-block text-left"},{default:A(()=>[$(_(Ot),{class:"w-8 text-xs text-right font-mono"},{default:A(()=>[K("x["+H(v)+"]:",1)]),_:2},1024),$(_(Lt),{class:"absolute left-0 mt-2 w-32 origin-top-left divide-y divide-border bg-background-mute shadow-lg ring-1 ring-border-hover focus:outline-none z-50"},{default:A(()=>[(O(),N(ee,null,ue(d,p=>$(_(Nt),{as:"div",class:"menu-item text-center",onClick:s=>a(p.value,v)},{default:A(()=>[K(H(p.name),1)]),_:2},1032,["onClick"])),64))]),_:2},1024)]),_:2},1024),ie(R("input",{class:"w-16",type:"number",step:"0.1","onUpdate:modelValue":p=>_(c)[0][v]=p},null,8,en),[[ce,_(c)[0][v]]]),ie(R("input",{class:"w-16",type:"number",step:"0.1","onUpdate:modelValue":p=>_(c)[1][v]=p},null,8,tn),[[ce,_(c)[1][v]]])]))),128))}}),an=(e,u)=>{const r=e.__vccOpts||e;for(const[i,c]of u)r[i]=c;return r},on=an(nn,[["__scopeId","data-v-e5099bb9"]]),rn=()=>`
const PI = radians(180.0);
const TAU = radians(360.0);

fn cosk(k: f32, x: f32) -> f32 {
  if (k > 0.0) {
    let rk = sqrt(k);
    return cos(rk*x);
  }
  if (k < 0.0) {
    let rk = sqrt(-k);
    return cosh(rk*x);
  }
  return 1.0;
}

fn sink(k: f32, x: f32) -> f32 {
  if (k > 0.0) {
    let rk = sqrt(k);
    return sin(rk*x)/rk;
  }
  if (k < 0.0) {
    let rk = sqrt(-k);
    return sinh(rk*x)/rk;
  }
  return x;
}

alias vec1f = array<f32, 1>;
`,ln=e=>{const u=/@plot\s+fn\s+(?<name>\w+)\s*\(\w+:\s*(?<domain>\w+)\)\s*->\s*(?<codomain>\w+)/g,r=[];let i;do i=u.exec(e),i&&i.groups&&r.push({name:i.groups.name,domain:{name:i.groups.domain},codomain:{name:i.groups.codomain}});while(i);return{functions:r}},de=e=>{switch(e.name){case"vec1f":return 1;case"vec2f":return 2;case"vec3f":return 3;case"vec4f":return 4}return 0},_e=e=>[de(e.domain),de(e.codomain)],sn={class:"flex flex-row items-center h-12 p-1 border-b-2 border-border"},un=R("h1",{class:"px-2"},"Parametric Surface",-1),cn=R("span",{class:"flex-grow"},null,-1),dn={class:"flex flex-row items-center justify-center overflow-hidden"},fn={class:"flex flex-col p-2"},mn={class:"flex flex-row items-center text-heading text-lg gap-2 my-2"},pn=["onUpdate:modelValue"],vn={class:"flex-grow"},gn={class:"text-text text-base"},wn=`@plot
fn f(x: vec2f) -> vec3f {
  return vec3f(x, sin(x[0])*cos(x[1]));
}`,bn=`
struct GlobalData {
  projection: mat4x4f,
  view: mat4x4f,
  time: f32,
}
`,hn=`
struct SurfaceData {
  model: mat4x4f,
  color: vec4f,
}
`,Mn=G({__name:"ParametricSurfaceView",setup(e){const u=T({source:wn,options:{functions:[]}}),r=Ye(u),i=`
${bn}
${hn}

@group(0) @binding(0) var<uniform> uGlobal: GlobalData;
@group(0) @binding(1) var<uniform> uSurface: SurfaceData;
`,c=(n,[l,o])=>{const g=y=>{switch(y){case 1:return"vec1f(position.y)";case 2:return"position.yz";case 3:return"position.yzw";default:return"0.0"}};return`fn surface(position: vec4f) -> vec4f {
  return ${(y=>h=>{switch(y){case 1:return`vec4(1.0, ${h}[0], 0.0, 0.0)`;case 2:return`vec4(1.0, ${h}, 0.0)`;case 3:return`vec4(1.0, ${h})`;default:return"vec4(1.0, 0.0, 0.0, 0.0)"}})(o)(`${n}(${g(l)})`)};
}`},a=(n,l)=>`
${rn()}

struct VertexIn {
  @location(0) position: vec4f,
  @location(1) color: vec4f,
}

struct FragmentIn {
  @builtin(position) position: vec4f,
  @location(0) color: vec4f,
}

struct VaryingData {
  position: vec4f,
  color: vec4f,
}

${i}

${n}

${l}

fn fromVertexIn(in: VertexIn) -> VaryingData {
  return VaryingData(
    uGlobal.view * surface(uSurface.model * in.position),
    uSurface.color * in.color,
  );
}

fn toFragmentIn(in: VaryingData) -> FragmentIn {
  return FragmentIn(
    uGlobal.projection * in.position.yzwx,
    in.color,
  );
}

@vertex
fn vertexMain(in: VertexIn) -> FragmentIn {
  return toFragmentIn(fromVertexIn(in));
}

@fragment
fn fragmentMain(in: FragmentIn) -> @location(0) vec4f {
  return in.color;
}
`,t=T(null),d=it(i),f=we(d.uniforms.uGlobal);f.set({projection:q.perspective(Math.PI/4,1920/1080,.1,1e3),view:q.translation([0,0,-3])});const I={},v={alphaMode:"premultiplied",size:[1920,1080],autoResize:!1},p=n=>{const l={state:null,valid:!1,onCreate(o){console.log("Resource::onCreate"),!l.state&&(l.state=n.create(o))},onUpdate(o){var g,m;l.valid||((g=l.onDelete)==null||g.call(l,o),(m=l.onCreate)==null||m.call(l,o),l.valid=!0)},onDelete(o){console.log("Resource::onDelete"),l.state&&(n.delete(o,l.state),l.state=null)}};return l},s=n=>ht(n.map(l=>xt(-1,1,l))),b=n=>{const l=n.length,o=yt(n);switch(l){case 1:return C(0,n[0]-1).map(m=>[(m+0)*o[0],(m+1)*o[0]]);case 2:{const g=C(0,n[0]).flatMap(y=>C(0,n[1]-1).map(h=>[y*o[0]+(h+0)*o[1],y*o[0]+(h+1)*o[1]])),m=C(0,n[1]).flatMap(y=>C(0,n[0]-1).map(h=>[(h+0)*o[0]+y*o[1],(h+1)*o[0]+y*o[1]]));return xe(g,m)}case 3:{const g=C(0,n[0]).flatMap(h=>C(0,n[1]).flatMap(k=>C(0,n[2]-1).map(S=>[h*o[0]+k*o[1]+(S+0)*o[2],h*o[0]+k*o[1]+(S+1)*o[2]]))),m=C(0,n[0]).flatMap(h=>C(0,n[2]).flatMap(k=>C(0,n[1]-1).map(S=>[h*o[0]+(S+0)*o[1]+k*o[2],h*o[0]+(S+1)*o[1]+k*o[2]]))),y=C(0,n[1]).flatMap(h=>C(0,n[2]).flatMap(k=>C(0,n[0]-1).map(S=>[(S+0)*o[0]+h*o[1]+k*o[2],(S+1)*o[0]+h*o[1]+k*o[2]])));return xe(g,m,y)}}return[]},w=n=>{const l=s(n).map(m=>[1,m[0]??0,m[1]??0,m[2]??0]),o=se([1,1,1,1],l.length),g=b(n);return{position:{data:l.flat(1),type:Float32Array,numComponents:4},color:{data:o.flat(1),type:Float32Array,numComponents:4},indices:{data:g.flat(1),type:Uint32Array}}},M=n=>[[],[Math.pow(n,3*2)],[Math.pow(n,3),Math.pow(n,3)],[Math.pow(n,2),Math.pow(n,2),Math.pow(n,2)]],x=p({create({device:n}){return M(3).map(w).map(o=>({vertices:gt(n,o,{shaderLocation:0,stepMode:"vertex",interleave:!0}),topology:1}))},delete({device:n},l){}}),P=n=>{const l=Se(Ht(n[0],n[1]),2),o=Se(Yt(n[0],n[1]),2);return q.st(o,l)},D=p({create({device:n,format:l}){return{uniforms:n.createBuffer({size:f.arrayBuffer.byteLength,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})}},delete({device:n},l){}}),E=p({create({device:n,format:l}){if(!D.state||!x.state||!t.value)return null;const{source:o,info:g}=t.value;return g.functions.map((m,y)=>{const[h,k]=_e(m),S=n.createShaderModule({code:a(o,c(m.name,[h,k]))}),{uniforms:B}=D.state,{vertices:W}=x.state[h],j=n.createRenderPipeline({layout:"auto",vertex:{module:S,entryPoint:"vertexMain",buffers:W.bufferLayouts},fragment:{module:S,entryPoint:"fragmentMain",targets:[{format:l}]},primitive:{topology:wt[1]}});I[y]=we(d.uniforms.uSurface);const Q=n.createBuffer({size:I[y].arrayBuffer.byteLength,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),z=n.createBindGroup({layout:j.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:B}},{binding:1,resource:{buffer:Q}}]});return{pipeline:j,bindGroup:z,uniforms:Q}})},delete({device:n},l){}}),Ue={onCreate(n){var l,o,g;console.log("ParametricSurfaceView::onCreate"),(l=D.onUpdate)==null||l.call(D,n),D.state&&((o=x.onUpdate)==null||o.call(x,n),x.state&&((g=E.onUpdate)==null||g.call(E,n),E.state))},onRender(n){var B,W,j;const{device:l,context:o,timestamp:g}=n;if((B=D.onUpdate)==null||B.call(D,n),!D.state||((W=x.onUpdate)==null||W.call(x,n),!x.state)||((j=E.onUpdate)==null||j.call(E,n),!E.state))return;const m=l.createCommandEncoder(),y=m.beginRenderPass({colorAttachments:[{clearValue:Float32Array.of(0,0,0,0),loadOp:"clear",storeOp:"store",view:o.getCurrentTexture().createView()}]});if(!t.value)return null;const{info:h}=t.value,{uniforms:k}=D.state;f.set({time:g/1e3}),l.queue.writeBuffer(k,0,f.arrayBuffer),h.functions.forEach((Q,z)=>{const[ze,xn]=_e(Q),le=r.options.functions[z];if(!le.visible)return;const{vertices:X}=x.state[ze],{pipeline:qe,bindGroup:Ze,uniforms:je}=E.state[z];I[z].set({model:P(le.extent),color:bt(le.color).gl()}),l.queue.writeBuffer(je,0,I[z].arrayBuffer),y.setPipeline(qe),y.setBindGroup(0,Ze),y.setVertexBuffer(0,X.buffers[0]),y.setIndexBuffer(X.indexBuffer,X.indexFormat),y.drawIndexed(X.numElements)}),y.end();const S=m.finish();l.queue.submit([S])},onDelete(n){var l,o,g;console.log("ParametricSurfaceView::Delete"),(l=E.onDelete)==null||l.call(E,n),(o=x.onDelete)==null||o.call(x,n),(g=D.onDelete)==null||g.call(D,n)}},oe={down:!1},Ae={pointerdown:n=>{oe.down=!0,n.target.setPointerCapture(n.pointerId)},pointermove:n=>{if(!oe.down)return;const l=n.target,o=[l.width,l.height],g=Math.min(...o),m=[+n.movementX*4/g,+n.movementY*4/g,0];q.rotateZ(f.views.view,m[0],f.views.view),q.rotateY(f.views.view,m[1],f.views.view)},pointerup:n=>{oe.down=!1},wheel:n=>{const l=n.deltaY/100;q.translate(f.views.view,[0,0,l],f.views.view)}},Be=n=>({source:n.replaceAll("@plot","/*@plot*/"),info:ln(n)}),Oe=n=>{const l=de(n.domain);return[se(-1,l),se(1,l)]},Le=({info:n})=>({functions:n.functions.map(l=>({name:l.name,color:"#ffffff",extent:Oe(l),visible:!0}))}),Ne=(n,l)=>({functions:n.functions.map((o,g)=>{const m=l.functions[g];return{color:(m==null?void 0:m.color)??o.color,extent:[o.extent[0].map((y,h)=>{var k,S;return((S=(k=m==null?void 0:m.extent)==null?void 0:k[0])==null?void 0:S[h])??y}),o.extent[1].map((y,h)=>{var k,S;return((S=(k=m==null?void 0:m.extent)==null?void 0:k[1])==null?void 0:S[h])??y})],visible:(m==null?void 0:m.visible)??o.visible}})}),me=n=>{const l=Be(n.source);t.value=l,n.options=Ne(Le(l),n.options),E.valid=!1},Ge=n=>{switch(n.key){case"Enter":return n.shiftKey;case"s":case"S":return n.ctrlKey||n.metaKey;default:return!1}};We(document,"keydown",n=>{Ge(n)&&(n.stopPropagation(),n.preventDefault(),me(r))}),Qe(u,me,{immediate:!0});const re=n=>{var l,o,g;return(g=(o=(l=t.value)==null?void 0:l.info)==null?void 0:o.functions)==null?void 0:g[n]};return(n,l)=>(O(),N(ee,null,[R("header",sn,[un,cn,$(ct,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=o=>u.value=o)},null,8,["modelValue"]),$(dt)]),$(_(vt),{as:"main",class:"flex-grow flex flex-col overflow-hidden","default-index":2},{default:A(()=>[$(_(ft),{class:"flex flex-row md:hidden"},{default:A(()=>[$(_(be),{class:"tab"},{default:A(()=>[K("Input")]),_:1}),$(_(be),{class:"tab"},{default:A(()=>[K("Output")]),_:1})]),_:1}),$(_(mt),{class:"h-full md:grid md:grid-cols-2 border-y-2 border-border"},{default:A(()=>[$(_(he),{class:"h-full ui-not-selected:hidden md:ui-not-selected:grid grid grid-rows-1 overflow-hidden",static:!0},{default:A(()=>[$(Xe,{modelValue:_(r).source,"onUpdate:modelValue":l[1]||(l[1]=o=>_(r).source=o)},null,8,["modelValue"])]),_:1}),$(_(he),{class:"h-full ui-not-selected:hidden md:ui-not-selected:grid grid grid-rows-2 overflow-hidden",static:!0},{default:A(()=>[(O(),Je(et,null,{default:A(()=>[R("div",dn,[$(pt,{renderer:Ue,listeners:Ae,options:v})])]),_:1})),R("div",fn,[(O(!0),N(ee,null,ue(_(r).options.functions,(o,g)=>{var m,y,h,k,S;return O(),N("div",{key:g},[R("h2",mn,[ie(R("input",{class:"w-8 h-8",name:"fill",type:"color","onUpdate:modelValue":B=>o.color=B},null,8,pn),[[ce,o.color]]),R("span",vn,[K(H((m=re(g))==null?void 0:m.name)+": ",1),R("span",gn,H((h=(y=re(g))==null?void 0:y.domain)==null?void 0:h.name)+" → "+H((S=(k=re(g))==null?void 0:k.codomain)==null?void 0:S.name),1)]),$(Jt,{modelValue:o.visible,"onUpdate:modelValue":B=>o.visible=B},null,8,["modelValue","onUpdate:modelValue"])]),$(on,{modelValue:o.extent,"onUpdate:modelValue":B=>o.extent=B},null,8,["modelValue","onUpdate:modelValue"])])}),128))])]),_:1})]),_:1})]),_:1})],64))}});export{Mn as default};
