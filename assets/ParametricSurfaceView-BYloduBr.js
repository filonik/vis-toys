import{w as ae,r as E,c as B,i as De,p as Pe,d as N,o as je,a as He,n as K,b as T,e as A,f as M,u as ke,g as S,h as me,j as I,k as ne,l as C,m as j,t as q,F as H,q as Y,v as W,s as Ye,x as We,y as Qe,z as Xe,_ as Je,A as et,S as tt,B as nt,C as at}from"./index-DzwOsM8U.js";import{c as Ve,o as D,w as Fe,h as $e,i as ot,u as rt,A as oe,a as de,s as st,N as ve,b as V,v as lt,d as ge,_ as Ee,O as ut,e as it,f as ct,g as dt,r as k,j as Re,m as L,k as ie,l as ft,n as pt,p as mt,q as he,t as vt,x as be,y as gt,z as ht,B as bt,C as we,I as wt,D as xe,E as xt,F as yt,G as It,P as _t,H as Mt}from"./meshes-BBMU-88b.js";function St(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Dt(){return/Android/gi.test(window.navigator.userAgent)}function Pt(){return St()||Dt()}function te(e,r,n){Ve.isServer||ae(o=>{document.addEventListener(e,r,n),o(()=>document.removeEventListener(e,r,n))})}function kt(e,r,n){Ve.isServer||ae(o=>{window.addEventListener(e,r,n),o(()=>window.removeEventListener(e,r,n))})}function Vt(e,r,n=B(()=>!0)){function o(a,t){if(!n.value||a.defaultPrevented)return;let i=t(a);if(i===null||!i.getRootNode().contains(i))return;let p=function b(m){return typeof m=="function"?b(m()):Array.isArray(m)||m instanceof Set?m:[m]}(e);for(let b of p){if(b===null)continue;let m=b instanceof HTMLElement?b:D(b);if(m!=null&&m.contains(i)||a.composed&&a.composedPath().includes(m))return}return!Fe(i,$e.Loose)&&i.tabIndex!==-1&&a.preventDefault(),r(a,i)}let l=E(null);te("pointerdown",a=>{var t,i;n.value&&(l.value=((i=(t=a.composedPath)==null?void 0:t.call(a))==null?void 0:i[0])||a.target)},!0),te("mousedown",a=>{var t,i;n.value&&(l.value=((i=(t=a.composedPath)==null?void 0:t.call(a))==null?void 0:i[0])||a.target)},!0),te("click",a=>{Pt()||l.value&&(o(a,()=>l.value),l.value=null)},!0),te("touchend",a=>o(a,()=>a.target instanceof HTMLElement?a.target:null),!0),kt("blur",a=>o(a,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function ye(e){return[e.screenX,e.screenY]}function Ft(){let e=E([-1,-1]);return{wasMoved(r){let n=ye(r);return e.value[0]===n[0]&&e.value[1]===n[1]?!1:(e.value=n,!0)},update(r){e.value=ye(r)}}}function $t({container:e,accept:r,walk:n,enabled:o}){ae(()=>{let l=e.value;if(!l||o!==void 0&&!o.value)return;let a=ot(e);if(!a)return;let t=Object.assign(p=>r(p),{acceptNode:r}),i=a.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,t,!1);for(;i.nextNode();)n(i.currentNode)})}let Ue=Symbol("Context");var Q=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Q||{});function Et(){return De(Ue,null)}function Rt(e){Pe(Ue,e)}function Ut(e){throw new Error("Unexpected object: "+e)}var U=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(U||{});function Ct(e,r){let n=r.resolveItems();if(n.length<=0)return null;let o=r.resolveActiveIndex(),l=o??-1;switch(e.focus){case 0:{for(let a=0;a<n.length;++a)if(!r.resolveDisabled(n[a],a,n))return a;return o}case 1:{l===-1&&(l=n.length);for(let a=l-1;a>=0;--a)if(!r.resolveDisabled(n[a],a,n))return a;return o}case 2:{for(let a=l+1;a<n.length;++a)if(!r.resolveDisabled(n[a],a,n))return a;return o}case 3:{for(let a=n.length-1;a>=0;--a)if(!r.resolveDisabled(n[a],a,n))return a;return o}case 4:{for(let a=0;a<n.length;++a)if(r.resolveId(n[a],a,n)===e.id)return a;return o}case 5:return null;default:Ut(e)}}let Ie=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function _e(e){var r,n;let o=(r=e.innerText)!=null?r:"",l=e.cloneNode(!0);if(!(l instanceof HTMLElement))return o;let a=!1;for(let i of l.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))i.remove(),a=!0;let t=a?(n=l.innerText)!=null?n:"":o;return Ie.test(t)&&(t=t.replace(Ie,"")),t}function Tt(e){let r=e.getAttribute("aria-label");if(typeof r=="string")return r.trim();let n=e.getAttribute("aria-labelledby");if(n){let o=n.split(" ").map(l=>{let a=document.getElementById(l);if(a){let t=a.getAttribute("aria-label");return typeof t=="string"?t.trim():_e(a).trim()}return null}).filter(Boolean);if(o.length>0)return o.join(", ")}return _e(e).trim()}function At(e){let r=E(""),n=E("");return()=>{let o=D(e);if(!o)return"";let l=o.innerText;if(r.value===l)return n.value;let a=Tt(o).trim().toLowerCase();return r.value=l,n.value=a,a}}var Bt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Bt||{}),Ot=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Ot||{});function Lt(e){requestAnimationFrame(()=>requestAnimationFrame(e))}let Ce=Symbol("MenuContext");function re(e){let r=De(Ce,null);if(r===null){let n=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,re),n}return r}let Nt=N({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(e,{slots:r,attrs:n}){let o=E(1),l=E(null),a=E(null),t=E([]),i=E(""),p=E(null),b=E(1);function m(u=w=>w){let w=p.value!==null?t.value[p.value]:null,f=ut(u(t.value.slice()),y=>D(y.dataRef.domRef)),_=w?f.indexOf(w):null;return _===-1&&(_=null),{items:f,activeItemIndex:_}}let v={menuState:o,buttonRef:l,itemsRef:a,items:t,searchQuery:i,activeItemIndex:p,activationTrigger:b,closeMenu:()=>{o.value=1,p.value=null},openMenu:()=>o.value=0,goToItem(u,w,f){let _=m(),y=Ct(u===U.Specific?{focus:U.Specific,id:w}:{focus:u},{resolveItems:()=>_.items,resolveActiveIndex:()=>_.activeItemIndex,resolveId:g=>g.id,resolveDisabled:g=>g.dataRef.disabled});i.value="",p.value=y,b.value=f??1,t.value=_.items},search(u){let w=i.value!==""?0:1;i.value+=u.toLowerCase();let f=(p.value!==null?t.value.slice(p.value+w).concat(t.value.slice(0,p.value+w)):t.value).find(y=>y.dataRef.textValue.startsWith(i.value)&&!y.dataRef.disabled),_=f?t.value.indexOf(f):-1;_===-1||_===p.value||(p.value=_,b.value=1)},clearSearch(){i.value=""},registerItem(u,w){let f=m(_=>[..._,{id:u,dataRef:w}]);t.value=f.items,p.value=f.activeItemIndex,b.value=1},unregisterItem(u){let w=m(f=>{let _=f.findIndex(y=>y.id===u);return _!==-1&&f.splice(_,1),f});t.value=w.items,p.value=w.activeItemIndex,b.value=1}};return Vt([l,a],(u,w)=>{var f;v.closeMenu(),Fe(w,$e.Loose)||(u.preventDefault(),(f=D(l))==null||f.focus())},B(()=>o.value===0)),Pe(Ce,v),Rt(B(()=>rt(o.value,{0:Q.Open,1:Q.Closed}))),()=>{let u={open:o.value===0,close:v.closeMenu};return oe({ourProps:{},theirProps:e,slot:u,slots:r,attrs:n,name:"Menu"})}}}),Gt=N({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(e,{attrs:r,slots:n,expose:o}){var l;let a=(l=e.id)!=null?l:`headlessui-menu-button-${de()}`,t=re("MenuButton");o({el:t.buttonRef,$el:t.buttonRef});function i(v){switch(v.key){case V.Space:case V.Enter:case V.ArrowDown:v.preventDefault(),v.stopPropagation(),t.openMenu(),K(()=>{var u;(u=D(t.itemsRef))==null||u.focus({preventScroll:!0}),t.goToItem(U.First)});break;case V.ArrowUp:v.preventDefault(),v.stopPropagation(),t.openMenu(),K(()=>{var u;(u=D(t.itemsRef))==null||u.focus({preventScroll:!0}),t.goToItem(U.Last)});break}}function p(v){switch(v.key){case V.Space:v.preventDefault();break}}function b(v){e.disabled||(t.menuState.value===0?(t.closeMenu(),K(()=>{var u;return(u=D(t.buttonRef))==null?void 0:u.focus({preventScroll:!0})})):(v.preventDefault(),t.openMenu(),Lt(()=>{var u;return(u=D(t.itemsRef))==null?void 0:u.focus({preventScroll:!0})})))}let m=st(B(()=>({as:e.as,type:r.type})),t.buttonRef);return()=>{var v;let u={open:t.menuState.value===0},{...w}=e,f={ref:t.buttonRef,id:a,type:m.value,"aria-haspopup":"menu","aria-controls":(v=D(t.itemsRef))==null?void 0:v.id,"aria-expanded":t.menuState.value===0,onKeydown:i,onKeyup:p,onClick:b};return oe({ourProps:f,theirProps:w,slot:u,attrs:r,slots:n,name:"MenuButton"})}}}),zt=N({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(e,{attrs:r,slots:n,expose:o}){var l;let a=(l=e.id)!=null?l:`headlessui-menu-items-${de()}`,t=re("MenuItems"),i=E(null);o({el:t.itemsRef,$el:t.itemsRef}),$t({container:B(()=>D(t.itemsRef)),enabled:B(()=>t.menuState.value===0),accept(u){return u.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:u.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(u){u.setAttribute("role","none")}});function p(u){var w;switch(i.value&&clearTimeout(i.value),u.key){case V.Space:if(t.searchQuery.value!=="")return u.preventDefault(),u.stopPropagation(),t.search(u.key);case V.Enter:if(u.preventDefault(),u.stopPropagation(),t.activeItemIndex.value!==null){let f=t.items.value[t.activeItemIndex.value];(w=D(f.dataRef.domRef))==null||w.click()}t.closeMenu(),Ee(D(t.buttonRef));break;case V.ArrowDown:return u.preventDefault(),u.stopPropagation(),t.goToItem(U.Next);case V.ArrowUp:return u.preventDefault(),u.stopPropagation(),t.goToItem(U.Previous);case V.Home:case V.PageUp:return u.preventDefault(),u.stopPropagation(),t.goToItem(U.First);case V.End:case V.PageDown:return u.preventDefault(),u.stopPropagation(),t.goToItem(U.Last);case V.Escape:u.preventDefault(),u.stopPropagation(),t.closeMenu(),K(()=>{var f;return(f=D(t.buttonRef))==null?void 0:f.focus({preventScroll:!0})});break;case V.Tab:u.preventDefault(),u.stopPropagation(),t.closeMenu(),K(()=>lt(D(t.buttonRef),u.shiftKey?ge.Previous:ge.Next));break;default:u.key.length===1&&(t.search(u.key),i.value=setTimeout(()=>t.clearSearch(),350));break}}function b(u){switch(u.key){case V.Space:u.preventDefault();break}}let m=Et(),v=B(()=>m!==null?(m.value&Q.Open)===Q.Open:t.menuState.value===0);return()=>{var u,w;let f={open:t.menuState.value===0},{..._}=e,y={"aria-activedescendant":t.activeItemIndex.value===null||(u=t.items.value[t.activeItemIndex.value])==null?void 0:u.id,"aria-labelledby":(w=D(t.buttonRef))==null?void 0:w.id,id:a,onKeydown:p,onKeyup:b,role:"menu",tabIndex:0,ref:t.itemsRef};return oe({ourProps:y,theirProps:_,slot:f,attrs:r,slots:n,features:ve.RenderStrategy|ve.Static,visible:v.value,name:"MenuItems"})}}}),qt=N({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(e,{slots:r,attrs:n,expose:o}){var l;let a=(l=e.id)!=null?l:`headlessui-menu-item-${de()}`,t=re("MenuItem"),i=E(null);o({el:i,$el:i});let p=B(()=>t.activeItemIndex.value!==null?t.items.value[t.activeItemIndex.value].id===a:!1),b=At(i),m=B(()=>({disabled:e.disabled,get textValue(){return b()},domRef:i}));je(()=>t.registerItem(a,m)),He(()=>t.unregisterItem(a)),ae(()=>{t.menuState.value===0&&p.value&&t.activationTrigger.value!==0&&K(()=>{var g,G;return(G=(g=D(i))==null?void 0:g.scrollIntoView)==null?void 0:G.call(g,{block:"nearest"})})});function v(g){if(e.disabled)return g.preventDefault();t.closeMenu(),Ee(D(t.buttonRef))}function u(){if(e.disabled)return t.goToItem(U.Nothing);t.goToItem(U.Specific,a)}let w=Ft();function f(g){w.update(g)}function _(g){w.wasMoved(g)&&(e.disabled||p.value||t.goToItem(U.Specific,a,0))}function y(g){w.wasMoved(g)&&(e.disabled||p.value&&t.goToItem(U.Nothing))}return()=>{let{disabled:g,...G}=e,se={active:p.value,disabled:g,close:t.closeMenu};return oe({ourProps:{id:a,ref:i,role:"menuitem",tabIndex:g===!0?void 0:-1,"aria-disabled":g===!0?!0:void 0,onClick:v,onFocus:u,onPointerenter:f,onMouseenter:f,onPointermove:_,onMousemove:_,onPointerleave:y,onMouseleave:y},theirProps:{...n,...G},slot:se,attrs:n,slots:r,name:"MenuItem"})}}});const Kt=e=>r=>r.map(e),Zt=e=>e.length,jt=e=>Math.min(...e),Ht=e=>jt(e.map(Zt)),Yt=e=>(...r)=>Array.from({length:Ht(r)},(n,o)=>e(...r.map(l=>l[o]))),Wt=Yt,Te=Wt,Qt=Te(ct),Xt=Te(dt),Jt=e=>(r,n)=>Kt(o=>e(o,n))(r),Me=Jt(it);function en(e,r){return T(),A("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[M("path",{d:"M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z"}),M("path",{d:"M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z"}),M("path",{d:"M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z"})])}function tn(e,r){return T(),A("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[M("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),M("path",{"fill-rule":"evenodd",d:"M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z","clip-rule":"evenodd"})])}const nn=N({__name:"ToggleVisibleButton",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:r}){const l=ke(e,"modelValue",r),a=()=>{l.value=!l.value};return(t,i)=>(T(),A("button",{class:"rounded-lg p-2",type:"button",onClick:i[0]||(i[0]=p=>a())},[S(I(en),{class:me(["w-5 h-5",[I(l)?"hidden":"visible"]])},null,8,["class"]),S(I(tn),{class:me(["w-5 h-5",[I(l)?"visible":"hidden"]])},null,8,["class"])]))}}),an=["onUpdate:modelValue"],on=["onUpdate:modelValue"],rn=N({__name:"ExtentInput",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:r}){const l=ke(e,"modelValue",r),a=(p,b)=>{l.value=[l.value[0].map((m,v)=>b==v?p[0]:m),l.value[1].map((m,v)=>b==v?p[1]:m)]},t=B(()=>k(0,l.value[0].length)),i=[{name:"-1, +1",value:[-1,1]},{name:"-π, +π",value:[-Math.PI,+Math.PI]},{name:"-π/2, +π/2",value:[-Math.PI/2,+Math.PI/2]}];return(p,b)=>(T(!0),A(H,null,ne(t.value,m=>(T(),A("div",{class:"flex flex-row items-center gap-2",key:m},[S(I(Nt),{as:"div",class:"relative inline-block text-left"},{default:C(()=>[S(I(Gt),{class:"w-16 text-xs text-right font-mono"},{default:C(()=>[j("x["+q(m)+"]:",1)]),_:2},1024),S(I(zt),{class:"absolute left-0 mt-2 w-32 origin-top-left divide-y divide-border bg-background-mute shadow-lg ring-1 ring-border-hover focus:outline-none z-50"},{default:C(()=>[(T(),A(H,null,ne(i,v=>S(I(qt),{as:"div",class:"menu-item text-center",onClick:u=>a(v.value,m)},{default:C(()=>[j(q(v.name),1)]),_:2},1032,["onClick"])),64))]),_:2},1024)]),_:2},1024),Y(M("input",{class:"w-16",type:"number",step:"0.1","onUpdate:modelValue":v=>I(l)[0][m]=v},null,8,an),[[W,I(l)[0][m]]]),Y(M("input",{class:"w-16",type:"number",step:"0.1","onUpdate:modelValue":v=>I(l)[1][m]=v},null,8,on),[[W,I(l)[1][m]]])]))),128))}}),sn=Re(rn,[["__scopeId","data-v-52a8a7be"]]),ln=(e,r)=>n=>Math.max(e,Math.min(n,r)),un=ln(-100,-.1);function cn(e,r){const n=Ye({isDown:!1,position:e??[-1,0,0],origin:[0,0,0]}),o={pointerdown:t=>{n.isDown=!0,t.target.setPointerCapture(t.pointerId)},pointermove:t=>{if(!n.isDown)return;const i=t.target,p=[i.width,i.height],b=Math.min(...p),m=[+t.movementX*4/b,+t.movementY*4/b,0];if(t.altKey||t.metaKey){const v=-n.position[0]/4.8;n.origin[0]+=m[0]*v,n.origin[1]-=m[1]*v}else n.position[1]+=m[0],n.position[2]+=m[1]},pointerup:t=>{n.isDown=!1},wheel:t=>{const i=t.deltaY/100;n.position[0]=un(n.position[0]+i)}},l=t=>(L.identity(t),L.translate(t,[0,0,n.position[0]],t),L.rotateY(t,n.position[2],t),L.rotateZ(t,n.position[1],t),L.translate(t,n.origin,t),t),a=B(()=>l(L.create()));return{listeners:o,transform:a,transformInplace:l}}const dn=()=>`
const PI = radians(180.0);
const TAU = radians(360.0);

fn cosk(k: f32, x: f32) -> f32 {
  if (k > 0.0) {
    let rk = sqrt(k);
    return cos(rk*x);
  }
  if (k < 0.0) {
    let rk = sqrt(-k);
    return cosh(rk*x);
  }
  return 1.0;
}

fn sink(k: f32, x: f32) -> f32 {
  if (k > 0.0) {
    let rk = sqrt(k);
    return sin(rk*x)/rk;
  }
  if (k < 0.0) {
    let rk = sqrt(-k);
    return sinh(rk*x)/rk;
  }
  return x;
}

alias vec1f = array<f32, 1>;
`,fn=e=>ft(e.map(r=>pt(-1,1,r))),pn=e=>{const r=e.length,n=mt(e);switch(r){case 1:return k(0,e[0]-1).map(l=>[(l+0)*n[0],(l+1)*n[0]]);case 2:{const o=k(0,e[0]).flatMap(a=>k(0,e[1]-1).map(t=>[a*n[0]+(t+0)*n[1],a*n[0]+(t+1)*n[1]])),l=k(0,e[1]).flatMap(a=>k(0,e[0]-1).map(t=>[(t+0)*n[0]+a*n[1],(t+1)*n[0]+a*n[1]]));return he(o,l)}case 3:{const o=k(0,e[0]).flatMap(t=>k(0,e[1]).flatMap(i=>k(0,e[2]-1).map(p=>[t*n[0]+i*n[1]+(p+0)*n[2],t*n[0]+i*n[1]+(p+1)*n[2]]))),l=k(0,e[0]).flatMap(t=>k(0,e[2]).flatMap(i=>k(0,e[1]-1).map(p=>[t*n[0]+(p+0)*n[1]+i*n[2],t*n[0]+(p+1)*n[1]+i*n[2]]))),a=k(0,e[1]).flatMap(t=>k(0,e[2]).flatMap(i=>k(0,e[0]-1).map(p=>[(p+0)*n[0]+t*n[1]+i*n[2],(p+1)*n[0]+t*n[1]+i*n[2]])));return he(o,l,a)}}return[]},mn=e=>{const r=fn(e).map(l=>[1,l[0]??0,l[1]??0,l[2]??0]),n=ie([1,1,1,1],r.length),o=pn(e);return{position:{data:r.flat(1),type:Float32Array,numComponents:4},color:{data:n.flat(1),type:Float32Array,numComponents:4},indices:{data:o.flat(1),type:Uint32Array}}},vn=e=>{const r=/@plot\s+fn\s+(?<name>\w+)\s*\(\w+:\s*(?<domain>\w+)\)\s*->\s*(?<codomain>\w+)/g,n=[];let o;do o=r.exec(e),o&&o.groups&&n.push({name:o.groups.name,domain:{name:o.groups.domain},codomain:{name:o.groups.codomain}});while(o);return{functions:n}},ce=e=>{switch(e.name){case"vec1f":return 1;case"vec2f":return 2;case"vec3f":return 3;case"vec4f":return 4}return 0},Se=e=>[ce(e.domain),ce(e.codomain)],gn=`@plot
fn f(x: vec2f) -> vec3f {
  return vec3f(x[0], x[1], sin(x[0])*cos(x[1]));
}`,fe=e=>(nt("data-v-944d3a7a"),e=e(),at(),e),hn={class:"flex flex-row items-center h-12 p-1 border-b-2 border-border"},bn=fe(()=>M("h1",{class:"px-2"},"Parametric Surface",-1)),wn=fe(()=>M("span",{class:"flex-grow"},null,-1)),xn={class:"flex flex-row items-center justify-center overflow-hidden show-focus-within"},yn={class:"flex flex-col p-2"},In=fe(()=>M("summary",{class:"flex flex-row items-center gap-2 my-1"},[M("h2",null,"Global")],-1)),_n={class:"w-16 text-xs text-right font-mono"},Mn=["onUpdate:modelValue"],Sn=["onUpdate:modelValue"],Dn={class:"flex flex-row items-center gap-2 my-1"},Pn=["onUpdate:modelValue"],kn={class:"flex-grow"},Vn={class:"text-text text-base"},Fn=`
struct GlobalData {
  projection: mat4x4f,
  view: mat4x4f,
  args: vec4f,
  time: f32,
}
`,$n=`
struct SurfaceData {
  model: mat4x4f,
  color: vec4f,
}
`,En=N({__name:"ParametricSurfaceView",setup(e){const n=E({source:gn,options:{args:[0,0,0,0],functions:[]}}),o=We(n),l=`
${Fn}
${$n}

@group(0) @binding(0) var<uniform> uGlobal: GlobalData;
@group(0) @binding(1) var<uniform> uSurface: SurfaceData;
`,a=(s,[c,d])=>{const h=x=>{switch(x){case 1:return"vec1f(position.y)";case 2:return"position.yz";case 3:return"position.yzw";default:return"0.0"}};return`fn surface(position: vec4f) -> vec4f {
  return ${(x=>$=>{switch(x){case 1:return`vec4(1.0, ${$}[0], 0.0, 0.0)`;case 2:return`vec4(1.0, ${$}, 0.0)`;case 3:return`vec4(1.0, ${$})`;default:return"vec4(1.0, 0.0, 0.0, 0.0)"}})(d)(`${s}(${h(c)})`)};
}`},t=(s,c)=>`
${dn()}

struct VertexIn {
  @location(0) position: vec4f,
  @location(1) color: vec4f,
}

struct FragmentIn {
  @builtin(position) position: vec4f,
  @location(0) color: vec4f,
}

struct VaryingData {
  position: vec4f,
  color: vec4f,
}

${l}

${s}

${c}

fn fromVertexIn(in: VertexIn) -> VaryingData {
  return VaryingData(
    uGlobal.view * surface(uSurface.model * in.position),
    uSurface.color * in.color,
  );
}

fn toFragmentIn(in: VaryingData) -> FragmentIn {
  return FragmentIn(
    uGlobal.projection * in.position.yzwx,
    in.color,
  );
}

@vertex
fn vertexMain(in: VertexIn) -> FragmentIn {
  return toFragmentIn(fromVertexIn(in));
}

@fragment
fn fragmentMain(in: FragmentIn) -> @location(0) vec4f {
  return in.color;
}
`,i=E(null),p=vt(l),b=be(p.uniforms.uGlobal);b.set({projection:L.perspective(Math.PI/4,1920/1080,.1,1e3),view:L.translation([0,0,-3]),args:[0,0,0,0]});const m={},v={alphaMode:"premultiplied",size:[1920,1080],autoResize:!1},u=s=>{const c={state:null,valid:!1,onCreate(d){console.log("Resource::onCreate"),!c.state&&(c.state=s.create(d))},onUpdate(d){var h,F;c.valid||((h=c.onDelete)==null||h.call(c,d),(F=c.onCreate)==null||F.call(c,d),c.valid=!0)},onDelete(d){console.log("Resource::onDelete"),c.state&&(s.delete(d,c.state),c.state=null)}};return c},w=s=>[[],[Math.pow(s,3*2)],[Math.pow(s,3),Math.pow(s,3)],[Math.pow(s,2),Math.pow(s,2),Math.pow(s,2)]],f=u({create({device:s}){return w(3).map(mn).map(d=>({vertices:It(s,d,{shaderLocation:0,stepMode:"vertex",interleave:!0}),topology:1}))},delete({device:s},c){}}),_=s=>{const c=Me(Qt(s[0],s[1]),2),d=Me(Xt(s[0],s[1]),2);return L.st(d,c)},y=u({create({device:s,format:c}){return{uniforms:s.createBuffer({size:b.arrayBuffer.byteLength,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})}},delete({device:s},c){}}),g=u({create({device:s,format:c}){if(!y.state||!f.state||!i.value)return null;const{source:d,info:h}=i.value;return h.functions.map((F,x)=>{const[$,O]=Se(F),R=s.createShaderModule({code:t(d,a(F.name,[$,O]))}),{uniforms:P}=y.state,{vertices:X}=f.state[$],Z=s.createRenderPipeline({layout:"auto",vertex:{module:R,entryPoint:"vertexMain",buffers:X.bufferLayouts},fragment:{module:R,entryPoint:"fragmentMain",targets:[{format:c}]},primitive:{topology:_t[1]}});m[x]=be(p.uniforms.uSurface);const J=s.createBuffer({size:m[x].arrayBuffer.byteLength,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),z=s.createBindGroup({layout:Z.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:P}},{binding:1,resource:{buffer:J}}]});return{pipeline:Z,bindGroup:z,uniforms:J}})},delete({device:s},c){}}),{listeners:G,transformInplace:se}=cn([-4,0,0]),Ae={onCreate(s){var c,d,h;console.log("ParametricSurfaceView::onCreate"),(c=y.onUpdate)==null||c.call(y,s),y.state&&((d=f.onUpdate)==null||d.call(f,s),f.state&&((h=g.onUpdate)==null||h.call(g,s),g.state))},onRender(s){var P,X,Z;const{device:c,context:d,timestamp:h}=s;if((P=y.onUpdate)==null||P.call(y,s),!y.state||((X=f.onUpdate)==null||X.call(f,s),!f.state)||((Z=g.onUpdate)==null||Z.call(g,s),!g.state))return;const F=c.createCommandEncoder(),x=F.beginRenderPass({colorAttachments:[{clearValue:Float32Array.of(0,0,0,0),loadOp:"clear",storeOp:"store",view:d.getCurrentTexture().createView()}]});if(!i.value)return null;const{info:$}=i.value,{uniforms:O}=y.state;b.set({args:o.options.args,time:h/1e3}),se(b.views.view),c.queue.writeBuffer(O,0,b.arrayBuffer),$.functions.forEach((J,z)=>{const[ze,Rn]=Se(J),ue=o.options.functions[z];if(!ue.visible)return;const{vertices:ee}=f.state[ze],{pipeline:qe,bindGroup:Ke,uniforms:Ze}=g.state[z];m[z].set({model:_(ue.extent),color:Mt(ue.color).gl()}),c.queue.writeBuffer(Ze,0,m[z].arrayBuffer),x.setPipeline(qe),x.setBindGroup(0,Ke),x.setVertexBuffer(0,ee.buffers[0]),x.setIndexBuffer(ee.indexBuffer,ee.indexFormat),x.drawIndexed(ee.numElements)}),x.end();const R=F.finish();c.queue.submit([R])},onDelete(s){var c,d,h;console.log("ParametricSurfaceView::Delete"),(c=g.onDelete)==null||c.call(g,s),(d=f.onDelete)==null||d.call(f,s),(h=y.onDelete)==null||h.call(y,s)}},Be=s=>({source:s.replaceAll("@plot","/*@plot*/"),info:vn(s)}),Oe=s=>{const c=ce(s.domain);return[ie(-1,c),ie(1,c)]},Le=({info:s})=>({functions:s.functions.map(c=>({name:c.name,color:"#ffffff",extent:Oe(c),visible:!0}))}),Ne=(s,c)=>{var d;return{args:s.args??c.args,functions:((d=s.functions)==null?void 0:d.map((h,F)=>{const x=c.functions[F];return{color:(x==null?void 0:x.color)??h.color,extent:[h.extent[0].map(($,O)=>{var R,P;return((P=(R=x==null?void 0:x.extent)==null?void 0:R[0])==null?void 0:P[O])??$}),h.extent[1].map(($,O)=>{var R,P;return((P=(R=x==null?void 0:x.extent)==null?void 0:R[1])==null?void 0:P[O])??$})],visible:(x==null?void 0:x.visible)??h.visible}}))??c.functions}},pe=s=>{const c=Be(s.source);i.value=c,s.options=Ne(Le(c),s.options),g.valid=!1},Ge=s=>{switch(s.key){case"Enter":return s.shiftKey;case"s":case"S":return s.ctrlKey||s.metaKey;default:return!1}};Qe(document,"keydown",s=>{Ge(s)&&(s.stopPropagation(),s.preventDefault(),pe(o))}),Xe(n,pe,{immediate:!0});const le=s=>{var c,d,h;return(h=(d=(c=i.value)==null?void 0:c.info)==null?void 0:d.functions)==null?void 0:h[s]};return(s,c)=>(T(),A(H,null,[M("header",hn,[bn,wn,S(gt,{modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=d=>n.value=d)},null,8,["modelValue"]),S(ht)]),S(I(yt),{as:"main",class:"flex-grow flex flex-col overflow-hidden","default-index":2},{default:C(()=>[S(I(bt),{class:"flex flex-row md:hidden"},{default:C(()=>[S(I(we),{class:"tab"},{default:C(()=>[j("Input")]),_:1}),S(I(we),{class:"tab"},{default:C(()=>[j("Output")]),_:1})]),_:1}),S(I(wt),{class:"h-full md:grid md:grid-cols-2 border-y-2 border-border"},{default:C(()=>[S(I(xe),{class:"h-full ui-not-selected:hidden md:ui-not-selected:grid grid grid-rows-1 overflow-hidden",static:!0},{default:C(()=>[S(Je,{modelValue:I(o).source,"onUpdate:modelValue":c[1]||(c[1]=d=>I(o).source=d)},null,8,["modelValue"])]),_:1}),S(I(xe),{class:"h-full ui-not-selected:hidden md:ui-not-selected:grid grid grid-rows-2 overflow-hidden",static:!0},{default:C(()=>[(T(),et(tt,null,{default:C(()=>[M("div",xn,[S(xt,{renderer:Ae,listeners:I(G),options:v},null,8,["listeners"])])]),_:1})),M("div",yn,[M("details",null,[In,(T(!0),A(H,null,ne(k(0,4),d=>(T(),A("div",{class:"flex flex-row items-center gap-2",key:d},[M("label",_n,"args["+q(d)+"]:",1),Y(M("input",{class:"w-16",type:"number",step:"0.1","onUpdate:modelValue":h=>I(o).options.args[d]=h},null,8,Mn),[[W,I(o).options.args[d]]]),Y(M("input",{class:"flex-grow",type:"range",min:"-1",max:"1",step:"0.01","onUpdate:modelValue":h=>I(o).options.args[d]=h},null,8,Sn),[[W,I(o).options.args[d]]])]))),128))]),(T(!0),A(H,null,ne(I(o).options.functions,(d,h)=>{var F,x,$,O,R;return T(),A("details",{key:h},[M("summary",Dn,[Y(M("input",{class:"w-8 h-8",name:"fill",type:"color","onUpdate:modelValue":P=>d.color=P},null,8,Pn),[[W,d.color]]),M("h2",kn,[j(q((F=le(h))==null?void 0:F.name)+": ",1),M("span",Vn,q(($=(x=le(h))==null?void 0:x.domain)==null?void 0:$.name)+" → "+q((R=(O=le(h))==null?void 0:O.codomain)==null?void 0:R.name),1)]),S(nn,{modelValue:d.visible,"onUpdate:modelValue":P=>d.visible=P},null,8,["modelValue","onUpdate:modelValue"])]),S(sn,{modelValue:d.extent,"onUpdate:modelValue":P=>d.extent=P},null,8,["modelValue","onUpdate:modelValue"])])}),128))])]),_:1})]),_:1})]),_:1})],64))}}),Tn=Re(En,[["__scopeId","data-v-944d3a7a"]]);export{Tn as default};
